\hypertarget{fem__solver__lib_8h_source}{}\doxysection{fem\+\_\+solver\+\_\+lib.\+h}
\label{fem__solver__lib_8h_source}\index{Solvers/fem\_solver\_lib.h@{Solvers/fem\_solver\_lib.h}}
\mbox{\hyperlink{fem__solver__lib_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CORENC\_SOLVERS\_fem\_solver\_lib\_H\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CORENC\_SOLVERS\_fem\_solver\_lib\_H\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}../CoreNCFEM/Grids/TriangularMesh.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}../CoreNCFEM/Methods/FEMethod.h"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}../Problems/DiffusionScalar.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}../CoreNCA/MatrixSkyline.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}../CoreNCFEM/Methods/FEAnalysis.h"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <chrono>}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{comment}{/*\#include <eigen3/Eigen/SparseCore>}}
\DoxyCodeLine{12 \textcolor{comment}{//\#include <eigen3/Eigen/Sparse>}}
\DoxyCodeLine{13 \textcolor{comment}{//\#include <eigen3/Eigen/SparseLU>}}
\DoxyCodeLine{14 \textcolor{comment}{//\#include <eigen3/Eigen/SparseCholesky>}}
\DoxyCodeLine{15 \textcolor{comment}{\#include <eigen3/Eigen/Cholesky>}}
\DoxyCodeLine{16 \textcolor{comment}{//\#include <eigen3/Eigen/Dense>}}
\DoxyCodeLine{17 \textcolor{comment}{\#include <eigen3/Eigen/UmfPackSupport>}}
\DoxyCodeLine{18 \textcolor{comment}{//\#include <eigen3/Eigen/SparseCore>}}
\DoxyCodeLine{19 \textcolor{comment}{\#include <eigen3/unsupported/Eigen/SparseExtra>}}
\DoxyCodeLine{20 \textcolor{comment}{\#include <eigen3/Eigen/SparseLU>*/}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <eigen3/Eigen/SparseCore>}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <cstdlib>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <eigen3/Eigen/Cholesky>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <eigen3/Eigen/Jacobi>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <eigen3/Eigen/Householder>}}
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include <eigen3/Eigen/IterativeLinearSolvers>}}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <eigen3/unsupported/Eigen/IterativeSolvers>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <eigen3/Eigen/LU>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <eigen3/unsupported/Eigen/SparseExtra>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <eigen3/Eigen/SparseLU>}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include <eigen3/Eigen/UmfPackSupport>}}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 }
\DoxyCodeLine{38 \textcolor{comment}{// FINITE ELEMENT METHOD SOLVER ONLY IN SPACE}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecorenc}{corenc}}}
\DoxyCodeLine{41 \{}
\DoxyCodeLine{42     \textcolor{keyword}{namespace }solvers}
\DoxyCodeLine{43     \{}
\DoxyCodeLine{44         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{45         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib}{fem\_solver\_lib}}}
\DoxyCodeLine{46         \{}
\DoxyCodeLine{47             \textcolor{keyword}{using }\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method}} = \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{method::FEMethod<\_Problem, \_Mesh, Algebra::MatrixSkyline>}};}
\DoxyCodeLine{48             \textcolor{keyword}{using }\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method2}} = \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{method::FEMethod<\_Problem, \_Mesh, Algebra::Matrix>}};}
\DoxyCodeLine{49         \textcolor{keyword}{public}:}
\DoxyCodeLine{50             \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a37ea8290fb0d92cb4108b5b14f4244ba}{fem\_solver\_lib}}() :m\_method2\{ nullptr \}, m\_method\{nullptr\}\{\}}
\DoxyCodeLine{51             \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a3eb11a3762da14df9587510700d21395}{\string~fem\_solver\_lib}}()}
\DoxyCodeLine{52             \{}
\DoxyCodeLine{53                 \textcolor{keywordflow}{if}(m\_method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{54                     \textcolor{keyword}{delete} m\_method2;}
\DoxyCodeLine{55                 \textcolor{keywordflow}{if}(m\_method != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{56                     \textcolor{keyword}{delete} m\_method;}
\DoxyCodeLine{57             \}}
\DoxyCodeLine{58             \textcolor{comment}{// terms, method, mesh, solver, result}}
\DoxyCodeLine{59             \textcolor{keyword}{const} \textcolor{keywordtype}{int}               \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a82eab36c6bf2db2168825926c5516e3e}{elliptic\_solver}}(\_Problem*, \_Mesh*, \_Result*);}
\DoxyCodeLine{60             \textcolor{keyword}{const} \textcolor{keywordtype}{int}               \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a353c97fe9b34d464e5eb77d247ace873}{elliptic\_solver\_gauss}}(\_Problem*, \_Mesh*, \_Result*);}
\DoxyCodeLine{61             \textcolor{keyword}{const} \textcolor{keywordtype}{double}            \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{get\_value}}(\textcolor{keyword}{const} \_Mesh\&, \textcolor{keyword}{const} \_Result\&, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p) \textcolor{keyword}{const};}
\DoxyCodeLine{62             \textcolor{keyword}{const} \textcolor{keywordtype}{double}            \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{get\_value}}(\textcolor{keyword}{const} \_Method2*, \textcolor{keyword}{const} \_Mesh\&, \textcolor{keyword}{const} \_Result\&, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p) \textcolor{keyword}{const};}
\DoxyCodeLine{63             \textcolor{keyword}{const} \textcolor{keywordtype}{double}            \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_ad2d78fef75a7a22e4fdf930a244c1965}{get\_value}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method}}*, \textcolor{keyword}{const} \_Mesh\&, \textcolor{keyword}{const} \_Result\&, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p) \textcolor{keyword}{const};}
\DoxyCodeLine{64             \textcolor{keyword}{const} \textcolor{keywordtype}{double}            \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{get\_value}}(\textcolor{keyword}{const} \_Mesh\&, \textcolor{keyword}{const} \_Result\&, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} i) \textcolor{keyword}{const};}
\DoxyCodeLine{65             \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}        \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_acbcf1941f0988dfc4a0d09ce773fb8b8}{get\_gradvalue}}(\textcolor{keyword}{const} \_Mesh\&, \textcolor{keyword}{const} \_Result\&, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p) \textcolor{keyword}{const};}
\DoxyCodeLine{66             \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}        \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_acbcf1941f0988dfc4a0d09ce773fb8b8}{get\_gradvalue}}(\textcolor{keyword}{const} \_Mesh\&, \textcolor{keyword}{const} \_Result\&, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} i) \textcolor{keyword}{const};}
\DoxyCodeLine{67         \textcolor{keyword}{private}:}
\DoxyCodeLine{68             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method}}*             m\_method;}
\DoxyCodeLine{69             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method}}*             m\_method2;}
\DoxyCodeLine{70             \textcolor{comment}{//\_Method2*             m\_method2;}}
\DoxyCodeLine{71         \};}
\DoxyCodeLine{72 }
\DoxyCodeLine{73         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{74         \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a82eab36c6bf2db2168825926c5516e3e}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::elliptic\_solver}}(\_Problem* problem, \_Mesh* mesh, \_Result* result)}
\DoxyCodeLine{75         \{}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 }
\DoxyCodeLine{78             std::vector<double> res;}
\DoxyCodeLine{79             std::vector<double> res2;}
\DoxyCodeLine{80             \textcolor{comment}{//std::shared\_ptr<Algebra::MatrixSkyline> matrix\{ new Algebra::MatrixSkyline() \};}}
\DoxyCodeLine{81             \mbox{\hyperlink{classAlgebra_1_1MatrixSkyline}{Algebra::MatrixSkyline}}* matrix\{ \textcolor{keyword}{new} \mbox{\hyperlink{classAlgebra_1_1MatrixSkyline}{Algebra::MatrixSkyline}}() \};}
\DoxyCodeLine{82 }
\DoxyCodeLine{83 }
\DoxyCodeLine{84 }
\DoxyCodeLine{85             std::vector<double> rhs;}
\DoxyCodeLine{86             \textcolor{keywordflow}{if} (m\_method != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{87                 \textcolor{keyword}{delete} m\_method;}
\DoxyCodeLine{88 }
\DoxyCodeLine{89             m\_method = \textcolor{keyword}{new} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method}}\{ problem, mesh, matrix, \&rhs \};}
\DoxyCodeLine{90 }
\DoxyCodeLine{91             m\_method-\/>\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a1e80cc9b6ad9fe43f2be200f86b736de}{Discretization}}();}
\DoxyCodeLine{92 }
\DoxyCodeLine{93             \textcolor{keywordtype}{int} n = matrix-\/>GetSize();}
\DoxyCodeLine{94             Eigen::SparseMatrix<double> eA(n, n);}
\DoxyCodeLine{95             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{96             \{}
\DoxyCodeLine{97                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < n; ++j)}
\DoxyCodeLine{98                 \{}
\DoxyCodeLine{99                     \textcolor{keyword}{auto} elem = matrix-\/>GetElement(i, j);}
\DoxyCodeLine{100                     \textcolor{keywordflow}{if} (fabs(elem) > 1e-\/12)}
\DoxyCodeLine{101                         eA.insert(i, j) = elem;}
\DoxyCodeLine{102                 \}}
\DoxyCodeLine{103             \}}
\DoxyCodeLine{104             eA.makeCompressed();}
\DoxyCodeLine{105 }
\DoxyCodeLine{106             \textcolor{comment}{//Algebra::ESolver esl\{ Algebra::Solvers::BiCGStab \};}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 }
\DoxyCodeLine{109             \textcolor{comment}{//std::cout << "{}Size:\(\backslash\)t"{} << matrix-\/>GetSize() << std::endl;}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111             \textcolor{comment}{//std::cout << matrix-\/>GetSize() << std::endl;}}
\DoxyCodeLine{112             \textcolor{comment}{//*result = esl.Solve(*matrix, rhs, *result, res, 100000, 1e-\/13);}}
\DoxyCodeLine{113             Eigen::MatrixMarketIterator<double> it(\textcolor{stringliteral}{"{}matr"{}});}
\DoxyCodeLine{114             Eigen::VectorXd xx(n);}
\DoxyCodeLine{115             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{116                 xx[i] = rhs[i];}
\DoxyCodeLine{117             std::chrono::steady\_clock::time\_point beg\{ std::chrono::steady\_clock::now() \};}
\DoxyCodeLine{118 }
\DoxyCodeLine{119             \textcolor{comment}{//Eigen::SparseLU<Eigen::SparseMatrix<double>> chol;//(eA);}}
\DoxyCodeLine{120             \textcolor{comment}{//Eigen::BiCGSTAB<Eigen::SparseMatrix<double>> chol;//(eA);}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122             Eigen::UmfPackLU<Eigen::SparseMatrix<double>> chol;\textcolor{comment}{//(eA);}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124             \textcolor{comment}{//chol.analyzePattern(eA);}}
\DoxyCodeLine{125             chol.compute(eA);}
\DoxyCodeLine{126             \textcolor{comment}{//chol.factorize(eA);}}
\DoxyCodeLine{127             \textcolor{keywordflow}{if} (chol.info() != Eigen::Success)}
\DoxyCodeLine{128                 std::cout << \textcolor{stringliteral}{"{}oops"{}} << std::endl;}
\DoxyCodeLine{129             Eigen::Matrix<double, Eigen::Dynamic, 1> bb;}
\DoxyCodeLine{130             \textcolor{comment}{//auto bb = chol.solve(xx);}}
\DoxyCodeLine{131             bb = chol.solve(xx);}
\DoxyCodeLine{132             \textcolor{keywordflow}{if} (chol.info() != Eigen::Success)}
\DoxyCodeLine{133                 std::cout << \textcolor{stringliteral}{"{}oops xx"{}} << std::endl;}
\DoxyCodeLine{134 }
\DoxyCodeLine{135             \textcolor{comment}{//Eigen::saveMarket(eA, "{}matrix.mtx"{});}}
\DoxyCodeLine{136             \textcolor{comment}{//Eigen::saveMarketVector(xx, "{}vector.mtx"{});}}
\DoxyCodeLine{137             \textcolor{comment}{//Eigen::saveMarketVector(bb, "{}MatrixName\_x.mtx"{});}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 }
\DoxyCodeLine{140             std::chrono::steady\_clock::time\_point end\{ std::chrono::steady\_clock::now() \};}
\DoxyCodeLine{141             \textcolor{keyword}{auto} dur = std::chrono::duration\_cast<std::chrono::milliseconds>(end -\/ beg).count();}
\DoxyCodeLine{142             std::cout << dur << std::endl;}
\DoxyCodeLine{143 }
\DoxyCodeLine{144             result-\/>resize(n);}
\DoxyCodeLine{145             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{146                 (*result)[i] = bb[i];}
\DoxyCodeLine{147 }
\DoxyCodeLine{148             \textcolor{comment}{//std::cout << matrix-\/>GetSize() << std::endl;}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150             \textcolor{comment}{//esl.Pardiso(*matrix, rhs, *result);}}
\DoxyCodeLine{151             \textcolor{comment}{//res.resize(matrix2-\/>GetSize());}}
\DoxyCodeLine{152             \textcolor{comment}{//for (int i = 0; i < matrix2-\/>GetSize(); ++i)}}
\DoxyCodeLine{153             \textcolor{comment}{//\{}}
\DoxyCodeLine{154                 \textcolor{comment}{//for (int j = 0; j < matrix2-\/>GetSize(); ++j)}}
\DoxyCodeLine{155                 \textcolor{comment}{//\{}}
\DoxyCodeLine{156                     \textcolor{comment}{//res[i] += result-\/>operator[](j) * (matrix2-\/>GetElement(i, j));}}
\DoxyCodeLine{157                 \textcolor{comment}{//\}}}
\DoxyCodeLine{158             \textcolor{comment}{//\}}}
\DoxyCodeLine{159             \textcolor{keyword}{delete} matrix;}
\DoxyCodeLine{160 }
\DoxyCodeLine{161             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{162         \}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{165         \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a353c97fe9b34d464e5eb77d247ace873}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::elliptic\_solver\_gauss}}(\_Problem* problem, \_Mesh* mesh, \_Result* result)}
\DoxyCodeLine{166         \{}
\DoxyCodeLine{167             std::vector<double> res;}
\DoxyCodeLine{168             std::vector<double> res2;}
\DoxyCodeLine{169             \textcolor{comment}{//std::shared\_ptr<Algebra::MatrixSkyline> matrix\{ new Algebra::MatrixSkyline() \};}}
\DoxyCodeLine{170             \textcolor{comment}{//Algebra::MatrixSkyline* matrix\{ new Algebra::MatrixSkyline() \};}}
\DoxyCodeLine{171             \mbox{\hyperlink{classAlgebra_1_1Matrix}{Algebra::Matrix}}* matrix2\{ \textcolor{keyword}{new} \mbox{\hyperlink{classAlgebra_1_1Matrix}{Algebra::Matrix}}() \};}
\DoxyCodeLine{172             std::vector<double> rhs;}
\DoxyCodeLine{173             \textcolor{comment}{//if (m\_method != nullptr)}}
\DoxyCodeLine{174             \textcolor{comment}{//    delete m\_method;}}
\DoxyCodeLine{175             \textcolor{keywordflow}{if} (m\_method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{176                 \textcolor{keyword}{delete} m\_method2;}
\DoxyCodeLine{177 }
\DoxyCodeLine{178             \textcolor{comment}{//m\_method = new \_Method\{ problem, mesh, matrix, \&rhs \};}}
\DoxyCodeLine{179             m\_method2 = \textcolor{keyword}{new} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method2}}\{ problem, mesh, matrix2, \&rhs \};}
\DoxyCodeLine{180             \textcolor{comment}{//m\_method-\/>Discretization();}}
\DoxyCodeLine{181             m\_method2-\/>\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a1e80cc9b6ad9fe43f2be200f86b736de}{Discretization}}();}
\DoxyCodeLine{182             \textcolor{comment}{//Algebra::ESolver esl\{ Algebra::Solvers::BiCGStab \};}}
\DoxyCodeLine{183             \textcolor{comment}{//std::cout << "{}Size:\(\backslash\)t"{} << matrix-\/>GetSize() << std::endl;}}
\DoxyCodeLine{184             \mbox{\hyperlink{classAlgebra_1_1ESolver}{Algebra::ESolver}} esl\{ \mbox{\hyperlink{namespaceAlgebra_af3ba1642071f1a948ca328a97b8c95afaedc41fb7bf8bdac012523d1bcd949a4f}{Algebra::Solvers::Gauss}} \};}
\DoxyCodeLine{185             \textcolor{comment}{//std::cout << matrix-\/>GetSize() << std::endl;}}
\DoxyCodeLine{186             \textcolor{comment}{//*result = esl.Solve(*matrix, rhs, *result, res, 100000, 1e-\/13);}}
\DoxyCodeLine{187             \textcolor{comment}{//std::cout << matrix-\/>GetSize() << std::endl;}}
\DoxyCodeLine{188             esl.Gauss(*matrix2, rhs, *result);}
\DoxyCodeLine{189             \textcolor{comment}{//esl.Pardiso(*matrix, rhs, *result);}}
\DoxyCodeLine{190             \textcolor{comment}{//res.resize(matrix2-\/>GetSize());}}
\DoxyCodeLine{191             \textcolor{comment}{//for (int i = 0; i < matrix2-\/>GetSize(); ++i)}}
\DoxyCodeLine{192             \textcolor{comment}{//\{}}
\DoxyCodeLine{193                 \textcolor{comment}{//for (int j = 0; j < matrix2-\/>GetSize(); ++j)}}
\DoxyCodeLine{194                 \textcolor{comment}{//\{}}
\DoxyCodeLine{195                     \textcolor{comment}{//res[i] += result-\/>operator[](j) * (matrix2-\/>GetElement(i, j));}}
\DoxyCodeLine{196                 \textcolor{comment}{//\}}}
\DoxyCodeLine{197             \textcolor{comment}{//\}}}
\DoxyCodeLine{198             \textcolor{comment}{//delete matrix;}}
\DoxyCodeLine{199             \textcolor{keyword}{delete} matrix2;}
\DoxyCodeLine{200             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{201         \}}
\DoxyCodeLine{202         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{203         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::get\_value}}(\textcolor{keyword}{const} \_Mesh\& mesh, \textcolor{keyword}{const} \_Result\& res, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)\textcolor{keyword}{ const}}
\DoxyCodeLine{204 \textcolor{keyword}{        }\{}
\DoxyCodeLine{205             \textcolor{keywordflow}{if} (m\_method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{206                 \textcolor{keywordflow}{return} m\_method2-\/>GetSolution(mesh, res, p);}
\DoxyCodeLine{207             \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{208         \}}
\DoxyCodeLine{209         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{210         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::get\_value}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{\_Method2}}* method2, \textcolor{keyword}{const} \_Mesh\& mesh, \textcolor{keyword}{const} \_Result\& res, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)\textcolor{keyword}{ const}}
\DoxyCodeLine{211 \textcolor{keyword}{        }\{}
\DoxyCodeLine{212             \textcolor{keywordflow}{if} (method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{213                 \textcolor{keywordflow}{return} method2-\/>\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{GetSolution}}(mesh, res, p);}
\DoxyCodeLine{214             \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{215         \}}
\DoxyCodeLine{216         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{217         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::get\_value}}(\textcolor{keyword}{const} \_Method* method2, \textcolor{keyword}{const} \_Mesh\& mesh, \textcolor{keyword}{const} \_Result\& res, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)\textcolor{keyword}{ const}}
\DoxyCodeLine{218 \textcolor{keyword}{        }\{}
\DoxyCodeLine{219             \textcolor{keywordflow}{if} (method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{220                 \textcolor{keywordflow}{return} method2-\/>GetSolution(mesh, res, p);}
\DoxyCodeLine{221             \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{222         \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{225         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_a7409e19ebc1be22fa772f8f549598584}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::get\_value}}(\textcolor{keyword}{const} \_Mesh\& mesh, \textcolor{keyword}{const} \_Result\& res, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} i)\textcolor{keyword}{ const}}
\DoxyCodeLine{226 \textcolor{keyword}{        }\{}
\DoxyCodeLine{227             \textcolor{keywordflow}{if} (m\_method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{228                 \textcolor{keywordflow}{return} m\_method2-\/>GetSolution(mesh, res, p, i);}
\DoxyCodeLine{229             \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{230         \}}
\DoxyCodeLine{231 }
\DoxyCodeLine{232         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{233         \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_acbcf1941f0988dfc4a0d09ce773fb8b8}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::get\_gradvalue}}(\textcolor{keyword}{const} \_Mesh\& mesh, \textcolor{keyword}{const} \_Result\& res, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)\textcolor{keyword}{ const}}
\DoxyCodeLine{234 \textcolor{keyword}{        }\{}
\DoxyCodeLine{235             \textcolor{keywordflow}{if} (m\_method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{236                 \textcolor{keywordflow}{return} m\_method2-\/>GetGradSolution(mesh, res, p);}
\DoxyCodeLine{237             \textcolor{keywordflow}{return} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(0, 0, 0);}
\DoxyCodeLine{238         \}}
\DoxyCodeLine{239 }
\DoxyCodeLine{240         \textcolor{keyword}{template}<\textcolor{keyword}{class} \_Problem, \textcolor{keyword}{class} \_Mesh, \textcolor{keyword}{class} \_Result>}
\DoxyCodeLine{241         \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1solvers_1_1fem__solver__lib_acbcf1941f0988dfc4a0d09ce773fb8b8}{fem\_solver\_lib<\_Problem, \_Mesh, \_Result>::get\_gradvalue}}(\textcolor{keyword}{const} \_Mesh\& mesh, \textcolor{keyword}{const} \_Result\& res, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} i)\textcolor{keyword}{ const}}
\DoxyCodeLine{242 \textcolor{keyword}{        }\{}
\DoxyCodeLine{243             \textcolor{keywordflow}{if} (m\_method2 != \textcolor{keyword}{nullptr})}
\DoxyCodeLine{244                 \textcolor{keywordflow}{return} m\_method2-\/>GetGradSolution(mesh, res, p, i);}
\DoxyCodeLine{245             \textcolor{keywordflow}{return} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(0, 0, 0);}
\DoxyCodeLine{246         \}}
\DoxyCodeLine{247     \}}
\DoxyCodeLine{248 \}}
\DoxyCodeLine{249 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !CORENC\_SOLVERS\_fem\_solver\_lib\_H\_}}

\end{DoxyCode}
