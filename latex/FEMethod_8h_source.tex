\hypertarget{FEMethod_8h_source}{}\doxysection{FEMethod.\+h}
\label{FEMethod_8h_source}\index{CoreNCFEM/Methods/FEMethod.h@{CoreNCFEM/Methods/FEMethod.h}}
\mbox{\hyperlink{FEMethod_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// FEMethod.h describes an abstract interface and functions for a general finite element method}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#ifndef CORENC\_METHODS\_FEMethod\_h}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#define CORENC\_METHODS\_FEMethod\_h}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}../Point.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}../Parameter.h"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{CSMethod_8h}{CSMethod.h}}"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{18 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecorenc}{corenc}}}
\DoxyCodeLine{19 \{}
\DoxyCodeLine{20     \textcolor{keyword}{namespace }Mesh}
\DoxyCodeLine{21     \{}
\DoxyCodeLine{22         \textcolor{keyword}{class }Point;}
\DoxyCodeLine{23     \}}
\DoxyCodeLine{24     \textcolor{keyword}{namespace }method}
\DoxyCodeLine{25     \{}
\DoxyCodeLine{26         \textcolor{keyword}{enum class} \mbox{\hyperlink{namespacecorenc_1_1method_a47b3659c38ded06fcd80aabbf897e5f0}{BoundaryType}}}
\DoxyCodeLine{27         \{}
\DoxyCodeLine{28             \mbox{\hyperlink{namespacecorenc_1_1method_a47b3659c38ded06fcd80aabbf897e5f0a186495f7da296bf880df3a22a492b378}{MAIN}},}
\DoxyCodeLine{29             \mbox{\hyperlink{namespacecorenc_1_1method_a47b3659c38ded06fcd80aabbf897e5f0a2200becb80f0019c4a2ccecec350d0db}{SECOND}},}
\DoxyCodeLine{30             \mbox{\hyperlink{namespacecorenc_1_1method_a47b3659c38ded06fcd80aabbf897e5f0ac39efd068faa8bf1b4e348d7cd43c229}{THIRD}},}
\DoxyCodeLine{31             \mbox{\hyperlink{namespacecorenc_1_1method_a47b3659c38ded06fcd80aabbf897e5f0a88c189a42c87aa49d667fc8ab76bc323}{FREE}}}
\DoxyCodeLine{32         \};}
\DoxyCodeLine{33         \textcolor{comment}{// class Type = Type of the solution, for ex vector or double, or even more specific}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35         }
\DoxyCodeLine{36         \textcolor{keyword}{template}<\textcolor{keyword}{class} Type>}
\DoxyCodeLine{37         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod}{CFEMethod}}}
\DoxyCodeLine{38         \{}
\DoxyCodeLine{39         \textcolor{keyword}{public}:}
\DoxyCodeLine{40             \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_ac6c871f6903b26c94a2ee3daf7a2e954}{CFEMethod}}() \{\};}
\DoxyCodeLine{41             \textcolor{keyword}{virtual} \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_ae689be27296a608b91b2dddbe2d435e6}{\string~CFEMethod}}() \{\};}
\DoxyCodeLine{42             \textcolor{keyword}{virtual} \textcolor{keyword}{const} \textcolor{keywordtype}{int}                           \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_a5b3d51ee501fdf4c12768c4d33b08ab2}{Assemble}}() = 0;}
\DoxyCodeLine{43             \textcolor{keyword}{virtual} \textcolor{keyword}{const} Type                          \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_afa256ad2bece2f50640ece4ced85c5c5}{GetSolution}}(\textcolor{keyword}{const} std::vector<double>\& point) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{44             \textcolor{keyword}{virtual} \textcolor{keyword}{const} std::vector<Type>             \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_a287defad8716ef6a10c1ee769818976b}{GetSolution}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{45             \textcolor{keyword}{virtual} \textcolor{keyword}{const} Type                          \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_ab93cef5f5805d3f20d5bc5e2821c3af9}{GetMaxSolution}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{46             \textcolor{keyword}{virtual} \textcolor{keyword}{const} Type                          \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethod_a520f7c8b3eea93652fa1b05ca4f42004}{GetMinSolution}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{47         \};}
\DoxyCodeLine{48 }
\DoxyCodeLine{49         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{50         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{FEMethod}}}
\DoxyCodeLine{51         \{}
\DoxyCodeLine{52         \textcolor{keyword}{public}:}
\DoxyCodeLine{53             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6b8afd4bc1fee3b9c1e717f56d65609b}{FEMethod}}() :}
\DoxyCodeLine{54                 m\_problem\{nullptr\},}
\DoxyCodeLine{55                 m\_Grid\{nullptr\},}
\DoxyCodeLine{56                 m\_GlobalMatrix\{nullptr\},}
\DoxyCodeLine{57                 m\_RightMatrix\{nullptr\},}
\DoxyCodeLine{58                 m\_rhsvector\{nullptr\}}
\DoxyCodeLine{59             \{\}}
\DoxyCodeLine{60             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_aafdc74dcab0e3f2f36b16b54ba07ec9c}{FEMethod}}(}
\DoxyCodeLine{61                 Problem* p,}
\DoxyCodeLine{62                 Grid* g,}
\DoxyCodeLine{63                 Matrix* m,}
\DoxyCodeLine{64                 std::vector<double>* rhs):}
\DoxyCodeLine{65                 m\_problem\{ p \},}
\DoxyCodeLine{66                 m\_Grid\{ g-\/>Clone() \},}
\DoxyCodeLine{67                 m\_GlobalMatrix\{ m \},}
\DoxyCodeLine{68                 m\_N\{ g-\/>GetNumberOfElements() \},}
\DoxyCodeLine{69                 m\_Ns\{ g-\/>GetNumberOfBoundaries() \},}
\DoxyCodeLine{70                 m\_rhsvector\{ rhs \}\{}
\DoxyCodeLine{71                 \textcolor{comment}{//GeneratePortrait();}}
\DoxyCodeLine{72             \}}
\DoxyCodeLine{73             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a064048daad6c4a943d533d3b839ee916}{FEMethod}}(}
\DoxyCodeLine{74                 Problem* p,}
\DoxyCodeLine{75                 Grid* g,}
\DoxyCodeLine{76                 Matrix* m,}
\DoxyCodeLine{77                 Matrix* rm,}
\DoxyCodeLine{78                 std::vector<double>* rhs):}
\DoxyCodeLine{79                 m\_problem\{ p \},}
\DoxyCodeLine{80                 m\_Grid\{ g-\/>Clone() \},}
\DoxyCodeLine{81                 m\_GlobalMatrix\{ m \},}
\DoxyCodeLine{82                 m\_RightMatrix\{ rm \},}
\DoxyCodeLine{83                 m\_N\{ g-\/>GetNumberOfElements() \},}
\DoxyCodeLine{84                 m\_Ns\{ g-\/>GetNumberOfBoundaries() \},}
\DoxyCodeLine{85                 m\_rhsvector\{ rhs \}\{}
\DoxyCodeLine{86                 \textcolor{comment}{//GeneratePortrait();}}
\DoxyCodeLine{87             \}}
\DoxyCodeLine{88             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a47c2e8c43b921d2c7c60ebfe27f11796}{FEMethod}}(\textcolor{keyword}{const} std::shared\_ptr<Grid>\& grid) :m\_Grid\{ grid-\/>Clone() \} \{\}}
\DoxyCodeLine{89             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a3a08659098d121f03f3e1a892825d399}{FEMethod}}(Grid* grid) :m\_Grid\{ grid-\/>Clone() \} \{\}}
\DoxyCodeLine{90             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a34fc3fe9449e38961eb69bd8710829c3}{FEMethod}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{FEMethod}}\& meth) :}
\DoxyCodeLine{91                 m\_Grid\{ meth.m\_Grid-\/>Clone() \},}
\DoxyCodeLine{92                 \textcolor{comment}{//m\_GlobalMatrix\{ meth.m\_GlobalMatrix-\/>Clone() \},}}
\DoxyCodeLine{93                 \textcolor{comment}{//m\_rhsvector\{ meth.m\_rhsvector \},}}
\DoxyCodeLine{94                 \textcolor{comment}{//m\_problem\{ meth.m\_problem \},}}
\DoxyCodeLine{95                 m\_time\{ meth.m\_time \},}
\DoxyCodeLine{96                 \textcolor{comment}{//m\_solution\{ meth.m\_solution \},}}
\DoxyCodeLine{97                 m\_size\{ meth.m\_size \},}
\DoxyCodeLine{98                 m\_N\{ meth.m\_N \},}
\DoxyCodeLine{99                 m\_Ns\{ meth.m\_Ns \},}
\DoxyCodeLine{100                 m\_nums\{ meth.m\_nums \}}
\DoxyCodeLine{101             \{\};}
\DoxyCodeLine{102             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{FEMethod}}\&                   \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_ae7d304768c93f58d5e75ece5434531c7}{operator=}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{FEMethod}}\& fem)}
\DoxyCodeLine{103             \{}
\DoxyCodeLine{104                 m\_Grid = fem.m\_Grid-\/>Clone();}
\DoxyCodeLine{105                 m\_time = fem.m\_time;}
\DoxyCodeLine{106                 m\_size = fem.m\_size;}
\DoxyCodeLine{107                 m\_N = fem.m\_N;}
\DoxyCodeLine{108                 m\_Ns = fem.m\_Ns;}
\DoxyCodeLine{109                 m\_nums = fem.m\_nums;}
\DoxyCodeLine{110                 \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{111             \}}
\DoxyCodeLine{112             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a1e80cc9b6ad9fe43f2be200f86b736de}{Discretization}}();}
\DoxyCodeLine{113             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&) \textcolor{keyword}{const};}
\DoxyCodeLine{114             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\& vec) \textcolor{keyword}{const};}
\DoxyCodeLine{115             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\& vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num) \textcolor{keyword}{const};}
\DoxyCodeLine{116             \textcolor{comment}{//const Mesh::Point         GetGradValue(const Mesh::Point\&, const std::vector<double>\& vec) const;}}
\DoxyCodeLine{117             \textcolor{comment}{//const Mesh::Point         GetLambdaGrad(const Mesh::Point\&, const std::vector<double>\& vec) const;}}
\DoxyCodeLine{118             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a5c286a9d43be47e959101b0350d74128}{GetEffective}}(\textcolor{keyword}{const} std::vector<double>\& vec) \textcolor{keyword}{const};}
\DoxyCodeLine{119             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a93d04fcb12ab526ab01d593781586b58}{ProjectSolution}}(std::vector<double>\&, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&, \textcolor{keyword}{const} \textcolor{keywordtype}{int})> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{GetValue}}, std::vector<double>\& sol);}
\DoxyCodeLine{120             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a93d04fcb12ab526ab01d593781586b58}{ProjectSolution}}(std::vector<double>\&, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&)> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{GetValue}}, std::vector<double>\& sol, \textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{121             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a2490006ce185d9a8604b76ed7f40532e}{LoadSolution}}(\textcolor{keyword}{const} std::vector<double>\& vec);}
\DoxyCodeLine{122             \textcolor{keyword}{const} std::vector<double>   \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a039760e61a3ea14edf113e90f3d1ae01}{SetSolution}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} sol, \textcolor{keyword}{const} \textcolor{keywordtype}{int} liq, \textcolor{keyword}{const} \textcolor{keywordtype}{double}, \textcolor{keyword}{const} \textcolor{keywordtype}{double}, \textcolor{keyword}{const} \textcolor{keywordtype}{double});}
\DoxyCodeLine{123             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{GetSolution}}(std::vector<double>\& vec);}
\DoxyCodeLine{124             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a00e0463e735af23fe0ad017ec5df58bd}{Rediscretization}}(\textcolor{keyword}{const} std::shared\_ptr<Grid>\&);}
\DoxyCodeLine{125             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a00e0463e735af23fe0ad017ec5df58bd}{Rediscretization}}();}
\DoxyCodeLine{126             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a06846a483dff83abb01fce01e411f983}{SetTimeStep}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& step) \{ m\_step = step; m\_time = step; \}}
\DoxyCodeLine{127             Matrix*                     \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a239946bbc34935ade8dcd50a0c5ab6b7}{GetGlobalMatrix}}() \textcolor{keyword}{const};}
\DoxyCodeLine{128             Grid*                       \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9f05ccbcc7a014deef0f96fd7c80df3e}{GetMesh}}() \{ \textcolor{keywordflow}{return} m\_Grid; \}}
\DoxyCodeLine{129             \textcolor{keyword}{const} std::vector<double>   \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6df01711cfd3a84323aa47ade3d77684}{GetRightVector}}() \textcolor{keyword}{const};}
\DoxyCodeLine{130             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a30ba41d521e56edc0b6dc8807ca5f68a}{OutDatFormat}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& min, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& max, \textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec) \textcolor{keyword}{const};}
\DoxyCodeLine{131             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_afaa26602de8a51328cfbe5ad358c6099}{OutMeshFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec);}
\DoxyCodeLine{132             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9a03d52d7faafa836c659295c680e7dd}{OutMeshTimeFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec);}
\DoxyCodeLine{133             \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double}         \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p);}
\DoxyCodeLine{134             \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double}         \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nfem);}
\DoxyCodeLine{135             \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9500dc1e392800ff9580e371e50b3475}{GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p);}
\DoxyCodeLine{136             \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9500dc1e392800ff9580e371e50b3475}{GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} n);}
\DoxyCodeLine{137             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_afc0d409b21125a73ccd9eb78f6eb3b9e}{\string~FEMethod}}();}
\DoxyCodeLine{138         \textcolor{keyword}{private}:}
\DoxyCodeLine{139             \textcolor{keywordtype}{void}                        GeneratePortrait();}
\DoxyCodeLine{140             \textcolor{keywordtype}{void}                        AssemblGlobal();}
\DoxyCodeLine{141             \textcolor{keywordtype}{void}                        MainConditions();}
\DoxyCodeLine{142             \textcolor{keywordtype}{void}                        SecondConditions();}
\DoxyCodeLine{143             \textcolor{keywordtype}{void}                        ThirdConditions();}
\DoxyCodeLine{144             \textcolor{keywordtype}{void}                        StefanConditions();}
\DoxyCodeLine{145             \textcolor{keywordtype}{void}                        ApplySources();}
\DoxyCodeLine{146             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleLocalMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{147             Grid*                       m\_Grid = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{148             Matrix*                     m\_GlobalMatrix = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{149             Matrix*                 m\_RightMatrix = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{150             Problem*                    m\_problem = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{151             std::vector<double>         m\_solution;}
\DoxyCodeLine{152             std::vector<double>*        m\_rhsvector;}
\DoxyCodeLine{153             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                m\_size;}
\DoxyCodeLine{154             \textcolor{keywordtype}{double}                      m\_step\{ 0.1 \};}
\DoxyCodeLine{155             \textcolor{keywordtype}{double}                      m\_time\{ 0.1 \};}
\DoxyCodeLine{156             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                m\_N;}
\DoxyCodeLine{157             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                m\_Ns;}
\DoxyCodeLine{158             std::vector<unsigned int>   m\_nums;}
\DoxyCodeLine{159 }
\DoxyCodeLine{160         \};}
\DoxyCodeLine{161 }
\DoxyCodeLine{162         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{163         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a1e80cc9b6ad9fe43f2be200f86b736de}{FEMethod<Problem, Grid, Matrix>::Discretization}}()}
\DoxyCodeLine{164         \{}
\DoxyCodeLine{165             GeneratePortrait();}
\DoxyCodeLine{166             AssemblGlobal();}
\DoxyCodeLine{167             \textcolor{comment}{//ApplySources();}}
\DoxyCodeLine{168             \textcolor{comment}{//SecondConditions();}}
\DoxyCodeLine{169             \textcolor{comment}{//ThirdConditions();}}
\DoxyCodeLine{170             MainConditions();}
\DoxyCodeLine{171             \textcolor{comment}{//StefanConditions();}}
\DoxyCodeLine{172         \}}
\DoxyCodeLine{173         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{174         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{FEMethod<Problem, Grid, Matrix>::GeneratePortrait}}()}
\DoxyCodeLine{175         \{}
\DoxyCodeLine{176             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& el = m\_Grid-\/>GetElement(0);}
\DoxyCodeLine{177             \textcolor{keywordtype}{int} order = m\_Grid-\/>GetElement(0)-\/>GetDoFs();}
\DoxyCodeLine{178             std::vector<std::set<unsigned int>> temp;}
\DoxyCodeLine{179             m\_Ns = m\_Grid-\/>GetNumberOfNodes();}
\DoxyCodeLine{180             m\_N = m\_Grid-\/>GetNumberOfElements();}
\DoxyCodeLine{181             temp.resize(m\_Grid-\/>GetNumberOfNodes());}
\DoxyCodeLine{182             \textcolor{keywordtype}{unsigned} i, j, k;}
\DoxyCodeLine{183             \textcolor{keywordflow}{for} (k = 0; k < m\_N; ++k)}
\DoxyCodeLine{184             \{}
\DoxyCodeLine{185                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(k) \};}
\DoxyCodeLine{186                 \textcolor{keywordflow}{for} (i = 0; i < order; ++i)}
\DoxyCodeLine{187                     \textcolor{keywordflow}{for} (j = 0; j < order; ++j)}
\DoxyCodeLine{188                         \textcolor{keywordflow}{if} (elem-\/>GetNode(j) > elem-\/>GetNode(i))}
\DoxyCodeLine{189                             temp[elem-\/>GetNode(j)].insert(elem-\/>GetNode(i));}
\DoxyCodeLine{190             \}}
\DoxyCodeLine{191             \textcolor{keywordflow}{if}(m\_problem-\/>findTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}))}
\DoxyCodeLine{192                 m\_RightMatrix-\/>Create(temp.size(), temp);}
\DoxyCodeLine{193             }
\DoxyCodeLine{194             \textcolor{comment}{//m\_GlobalMatrix = std::shared\_ptr<Matrix>(new Matrix(m\_Grid-\/>GetNumberOfNodes(), temp));}}
\DoxyCodeLine{195             \textcolor{comment}{//m\_rhsvector.resize(m\_Grid-\/>GetNumberOfNodes());}}
\DoxyCodeLine{196             \textcolor{comment}{//std::cout << temp.size() << std::endl;}}
\DoxyCodeLine{197             m\_GlobalMatrix-\/>Create(temp.size(), temp);}
\DoxyCodeLine{198             m\_rhsvector-\/>resize(temp.size());}
\DoxyCodeLine{199             \textcolor{comment}{//m\_solution.resize(m\_Grid-\/>GetNumberOfNodes());}}
\DoxyCodeLine{200             \textcolor{comment}{//for (int l = 0; l < m\_Grid-\/>GetNumberOfNodes(); ++l)}}
\DoxyCodeLine{201             \textcolor{comment}{//  m\_solution[l] = 20;}}
\DoxyCodeLine{202         \}}
\DoxyCodeLine{203         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{204         \textcolor{keywordtype}{void} FEMethod<Problem, Grid, Matrix>::AssemblGlobal()}
\DoxyCodeLine{205         \{}
\DoxyCodeLine{206             \textcolor{keywordtype}{int} l;}
\DoxyCodeLine{207             \textcolor{comment}{//std::vector<std::future<int>> futures;}}
\DoxyCodeLine{208             \textcolor{keywordflow}{for} (l = 0; l < m\_N; ++l)}
\DoxyCodeLine{209                 \textcolor{comment}{//futures.push\_back(async(\&DGMethod<Problem, Grid, Matrix>::AssembleLocalMatrix, this, l));}}
\DoxyCodeLine{210                 AssembleLocalMatrix(l);}
\DoxyCodeLine{211             \textcolor{comment}{//for (auto \&it : futures)}}
\DoxyCodeLine{212             \textcolor{comment}{//it.get();}}
\DoxyCodeLine{213         \}}
\DoxyCodeLine{214         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{215         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethod<Problem, Grid, Matrix>::AssembleLocalMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l)}
\DoxyCodeLine{216         \{}
\DoxyCodeLine{217             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{218             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{219             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{220             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{221             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{222             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{223             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{224             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{225                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{226             \textcolor{keywordflow}{for} (k = 0; k < terms; ++k)}
\DoxyCodeLine{227             \{}
\DoxyCodeLine{228                 \textcolor{keywordflow}{switch} (m\_problem-\/>getTerm(k))}
\DoxyCodeLine{229                 \{}
\DoxyCodeLine{230                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da511236cf0a2ae58312752c309767be64}{Terms::IUV}}:}
\DoxyCodeLine{231                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{232                     \{}
\DoxyCodeLine{233                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{234                         \{}
\DoxyCodeLine{235                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{236                             \{}
\DoxyCodeLine{237                                 \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da511236cf0a2ae58312752c309767be64}{Terms::IUV}}, l, elem-\/>GetType(), p) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{238                             \};}
\DoxyCodeLine{239                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{240                             m\_GlobalMatrix-\/>AddElement(elem-\/>GetNode(i), elem-\/>GetNode(j), mij);}
\DoxyCodeLine{241                         \}}
\DoxyCodeLine{242                     \}}
\DoxyCodeLine{243                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{244                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}:}
\DoxyCodeLine{245                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{246                     \{}
\DoxyCodeLine{247                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{248                         \{}
\DoxyCodeLine{249                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{250                             \{}
\DoxyCodeLine{251                                 \textcolor{comment}{//auto m = elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}}
\DoxyCodeLine{252                                 \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p) * elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{253                             \};}
\DoxyCodeLine{254                             \textcolor{comment}{//mij = m\_Grid-\/>getParameter(Parameters::DIFFUSION, l, j) * elem-\/>Integrate(M, points);}}
\DoxyCodeLine{255                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{256                             m\_GlobalMatrix-\/>AddElement(elem-\/>GetNode(i), elem-\/>GetNode(j), mij);}
\DoxyCodeLine{257                         \}}
\DoxyCodeLine{258                     \}}
\DoxyCodeLine{259                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{260                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}:}
\DoxyCodeLine{261                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{262                     \{}
\DoxyCodeLine{263                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{264                         \{}
\DoxyCodeLine{265                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{266                             \{}
\DoxyCodeLine{267                                 \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{268                             \};}
\DoxyCodeLine{269                             \textcolor{keyword}{auto} \_mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{270                             m\_GlobalMatrix-\/>AddElement(elem-\/>GetNode(i), elem-\/>GetNode(j), \_mij);}
\DoxyCodeLine{271                         \}}
\DoxyCodeLine{272                     \}}
\DoxyCodeLine{273                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{274                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dab9a50fb352778c6273b307887dd2ba28}{Terms::IUDV}}:}
\DoxyCodeLine{275                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{276                     \{}
\DoxyCodeLine{277                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{278                         \{}
\DoxyCodeLine{279                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{280                             \{}
\DoxyCodeLine{281                                 \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{282                             \};}
\DoxyCodeLine{283                             \textcolor{comment}{//mij = m\_CoarseGrid-\/>getParameter(Parameters::ADVECTION, l, j) * m\_flux(m\_CoarseGrid-\/>getSolution(l, j)) * elem-\/>Integrate(M, points).x;}}
\DoxyCodeLine{284                             mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{285                             m\_GlobalMatrix-\/>AddElement(elem-\/>GetNode(i), elem-\/>GetNode(j), mij);}
\DoxyCodeLine{286                         \}}
\DoxyCodeLine{287                     \}}
\DoxyCodeLine{288                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{289                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da601d1ecfe8543b457d918d636d84cc9d}{Terms::EUV}}:}
\DoxyCodeLine{290                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{291                     \{}
\DoxyCodeLine{292                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{293                         \{}
\DoxyCodeLine{294                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{295                             \{}
\DoxyCodeLine{296                                 \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{297                             \};}
\DoxyCodeLine{298                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{299                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02facb6c2c4b3c8f95f9b58ad13f0a97245d}{Parameters::MASS}}, l, j) * m\_Grid-\/>getSolution(l, j) * mij;}
\DoxyCodeLine{300                             \textcolor{comment}{//m\_rhsvector-\/>operator[](m\_nums[l] + i) += m\_CoarseGrid-\/>getParameter(Parameters::MASS, l, points[j]) * elem-\/>GetValue(j) * mij;}}
\DoxyCodeLine{301                         \}}
\DoxyCodeLine{302                     \}}
\DoxyCodeLine{303                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{304                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dac74248d6b3ec20c4b6969c4e520b09ca}{Terms::EDUDV}}:}
\DoxyCodeLine{305                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{306                     \{}
\DoxyCodeLine{307                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{308                         \{}
\DoxyCodeLine{309                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{310                             \{}
\DoxyCodeLine{311                                 \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{312                             \};}
\DoxyCodeLine{313                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{314                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02fac9f4e4b1345e4e958a307bf67ae358a7}{Parameters::DIFFUSION}}, l, j) * m\_Grid-\/>getSolution(l, j) * mij;}
\DoxyCodeLine{315                         \}}
\DoxyCodeLine{316                     \}}
\DoxyCodeLine{317                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{318                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7daa7a21a5469737f2aa8b257cce9aa27e3}{Terms::EDUV}}:}
\DoxyCodeLine{319                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{320                     \{}
\DoxyCodeLine{321                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{322                         \{}
\DoxyCodeLine{323                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{324                             \{}
\DoxyCodeLine{325                                 \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{326                             \};}
\DoxyCodeLine{327                             mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{328                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02fa21d5412bbfc0a49ed5cb827c133bb3fb}{Parameters::ADVECTION}}, l, j) * mij;}
\DoxyCodeLine{329                         \}}
\DoxyCodeLine{330                     \}}
\DoxyCodeLine{331                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{332                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da38f852dce31a67414f478b5626a4d118}{Terms::EUDV}}:}
\DoxyCodeLine{333                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{334                     \{}
\DoxyCodeLine{335                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{336                         \{}
\DoxyCodeLine{337                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{338                             \{}
\DoxyCodeLine{339                                 \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{340                             \};}
\DoxyCodeLine{341                             mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{342                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02fa21d5412bbfc0a49ed5cb827c133bb3fb}{Parameters::ADVECTION}}, l, j) * mij;\textcolor{comment}{// *mij;}}
\DoxyCodeLine{343                         \}}
\DoxyCodeLine{344                     \}}
\DoxyCodeLine{345                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{346                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da4a56e919ee256e21151e6df79babae35}{Terms::EFV}}:}
\DoxyCodeLine{347                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{348                     \{}
\DoxyCodeLine{349                         \textcolor{comment}{/*for (j = 0; j < dofs; ++j)}}
\DoxyCodeLine{350 \textcolor{comment}{                        \{}}
\DoxyCodeLine{351 \textcolor{comment}{                            auto M = [\&](const Mesh::Point\& p)}}
\DoxyCodeLine{352 \textcolor{comment}{                            \{}}
\DoxyCodeLine{353 \textcolor{comment}{                                return m\_problem-\/>get\_parameter(Terms::EFV, elem-\/>GetType(), l, j, p) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}}
\DoxyCodeLine{354 \textcolor{comment}{                            \};}}
\DoxyCodeLine{355 \textcolor{comment}{                            mij = elem-\/>Integrate(M, points);}}
\DoxyCodeLine{356 \textcolor{comment}{                            m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += mij;}}
\DoxyCodeLine{357 \textcolor{comment}{                        \}*/}}
\DoxyCodeLine{358                         \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{359                         \{}
\DoxyCodeLine{360                             \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da4a56e919ee256e21151e6df79babae35}{Terms::EFV}}, elem-\/>GetType(), l, i, p) * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{361                         \};}
\DoxyCodeLine{362                         mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{363                         m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += mij;}
\DoxyCodeLine{364                     \}}
\DoxyCodeLine{365                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{366                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}:}
\DoxyCodeLine{367                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{368                     \{}
\DoxyCodeLine{369                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{370                         \{}
\DoxyCodeLine{371                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{372                             \{}
\DoxyCodeLine{373                                 \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{374                             \};}
\DoxyCodeLine{375                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{376                             m\_RightMatrix-\/>AddElement(elem-\/>GetNode(i), elem-\/>GetNode(j), mij);}
\DoxyCodeLine{377                         \}}
\DoxyCodeLine{378                     \}}
\DoxyCodeLine{379                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{380                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da9aa23ab26cb4db3b1e10a668eff580f2}{Terms::SUPG}}:}
\DoxyCodeLine{381                 \{}
\DoxyCodeLine{382                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{383                     \{}
\DoxyCodeLine{384                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{385                         \{}
\DoxyCodeLine{386                             \textcolor{comment}{/*auto inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}}
\DoxyCodeLine{387 \textcolor{comment}{                            auto jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}}
\DoxyCodeLine{388 \textcolor{comment}{                            if (inode == -\/1 || jnode == -\/1)}}
\DoxyCodeLine{389 \textcolor{comment}{                                continue;*/}}
\DoxyCodeLine{390                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{391                             \{}
\DoxyCodeLine{392                                 \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{393                                 \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{394                                 \textcolor{comment}{//double Pe = vel * h / 6. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{395                                 \textcolor{keywordtype}{double} tau = 0.;}
\DoxyCodeLine{396                                 \textcolor{keywordtype}{double} Pe = vel * h / 6. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{397                                 \textcolor{comment}{//double beta = h / 2. / vel * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{398                                 \textcolor{comment}{//double beta = h / std::sqrt(3.) * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{399                                 \textcolor{comment}{//double beta = h / 2. * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{400                                 \textcolor{comment}{//double beta = h / 2. * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{401                                 \textcolor{comment}{//beta = 0.;}}
\DoxyCodeLine{402                                 \textcolor{comment}{//for (int ii = 0; ii < (int)dofs; ++ii)}}
\DoxyCodeLine{403                                     \textcolor{comment}{//beta += m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) * elem-\/>GetGradShapeFunction(ii, p);}}
\DoxyCodeLine{404                                 \textcolor{comment}{//return beta * m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) *}}
\DoxyCodeLine{405                                 \textcolor{comment}{//        elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}}
\DoxyCodeLine{406                                 \textcolor{keywordflow}{if} (Pe >= 1.)}
\DoxyCodeLine{407                                     tau = h / 2. / vel;}
\DoxyCodeLine{408                                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{409                                     tau = h * h / 12. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{410                                 \textcolor{comment}{//return 0.;}}
\DoxyCodeLine{411                                 \textcolor{keywordflow}{return} tau * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) *}
\DoxyCodeLine{412                                         elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{413                             \};}
\DoxyCodeLine{414 }
\DoxyCodeLine{415                             \textcolor{comment}{//double tau =}}
\DoxyCodeLine{416                             \textcolor{keyword}{auto} \_mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{417                             m\_GlobalMatrix-\/>AddElement(elem-\/>GetNode(i), elem-\/>GetNode(j), \_mij);}
\DoxyCodeLine{418                         \}}
\DoxyCodeLine{419                         \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{420                         \{}
\DoxyCodeLine{421                             \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{422                             \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{423                             \textcolor{keywordtype}{double} Pe = vel * h / 6. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{424                             \textcolor{keywordtype}{double} tau = 0.;}
\DoxyCodeLine{425                             \textcolor{comment}{//double Pe = vel * h / 2. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{426 }
\DoxyCodeLine{427                             \textcolor{keywordflow}{if} (Pe >= 1.)}
\DoxyCodeLine{428                                 tau = h / 2. / vel;}
\DoxyCodeLine{429                             \textcolor{keywordflow}{else}}
\DoxyCodeLine{430                                 tau = h * h / 12. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{431                             \textcolor{keyword}{auto} supg = tau * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da4a56e919ee256e21151e6df79babae35}{Terms::EFV}}, elem-\/>GetType(), l, i, p) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * elem-\/>GetGradShapeFunction(i, p);}
\DoxyCodeLine{432 }
\DoxyCodeLine{433                             \textcolor{keywordflow}{return} supg;}
\DoxyCodeLine{434                         \};}
\DoxyCodeLine{435                         mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{436                         m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += mij;}
\DoxyCodeLine{437                     \}}
\DoxyCodeLine{438                 \}}
\DoxyCodeLine{439                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{440                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{441                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{442                 \}}
\DoxyCodeLine{443             \}}
\DoxyCodeLine{444             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{445         \}}
\DoxyCodeLine{446         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{447         \textcolor{keywordtype}{void} FEMethod<Problem, Grid, Matrix>::MainConditions()}
\DoxyCodeLine{448         \{}
\DoxyCodeLine{449             \textcolor{keywordtype}{double} mu\{ 1e10 \};}
\DoxyCodeLine{450             \textcolor{keyword}{const} \textcolor{keyword}{auto} n = m\_problem-\/>get\_number\_of\_boundaries();}
\DoxyCodeLine{451             \textcolor{keyword}{const} \textcolor{keyword}{auto} m = m\_Grid-\/>GetNumberOfBoundaries();}
\DoxyCodeLine{452             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{453             \{}
\DoxyCodeLine{454                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& type = m\_problem-\/>get\_boundary\_type(i);}
\DoxyCodeLine{455                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < m; ++j)}
\DoxyCodeLine{456                 \{}
\DoxyCodeLine{457                     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& row = m\_Grid-\/>GetBoundary(j);}
\DoxyCodeLine{458                     \textcolor{keywordflow}{if} (row-\/>GetType() == type)}
\DoxyCodeLine{459                     \{}
\DoxyCodeLine{460                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs = (int)row-\/>GetDoFs();}
\DoxyCodeLine{461                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs2 = 2;}
\DoxyCodeLine{462                         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\_num = row-\/>GetNeighbour(0);}
\DoxyCodeLine{463                         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem = m\_Grid-\/>GetElement(elem\_num);}
\DoxyCodeLine{464                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\_elem = elem-\/>GetDoFs();}
\DoxyCodeLine{465                         std::vector<Mesh::Point> points(dofs\_elem);}
\DoxyCodeLine{466                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < dofs\_elem; ++k)}
\DoxyCodeLine{467                             points[k] = m\_Grid-\/>GetNode(elem-\/>GetNode(k));}
\DoxyCodeLine{468                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < dofs; ++k)}
\DoxyCodeLine{469                         \{}
\DoxyCodeLine{470                             \textcolor{keywordtype}{int} l = 0;}
\DoxyCodeLine{471                             \textcolor{keywordflow}{for} (; l < dofs\_elem; ++l)}
\DoxyCodeLine{472                             \{}
\DoxyCodeLine{473                                 \textcolor{keywordflow}{if} (elem-\/>GetNode(l) == row-\/>GetNode(k))}
\DoxyCodeLine{474                                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{475                             \}}
\DoxyCodeLine{476                             m\_GlobalMatrix-\/>NullRow(row-\/>GetNode(k));}
\DoxyCodeLine{477                             m\_GlobalMatrix-\/>operator()(row-\/>GetNode(k), row-\/>GetNode(k)) = 0;}
\DoxyCodeLine{478                             \textcolor{comment}{//m\_GlobalMatrix-\/>operator()(row-\/>GetNode(k), row-\/>GetNode(k)) *= mu;}}
\DoxyCodeLine{479                             \textcolor{comment}{//m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = m\_problem-\/>get\_boundary\_parameter(0, type, m\_Grid-\/>GetNode(row-\/>GetNode(k)));}}
\DoxyCodeLine{480                             \textcolor{comment}{//m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = m\_problem-\/>get\_boundary\_parameter(0, type, elem\_num, l, m\_Grid-\/>GetNode(row-\/>GetNode(k)));}}
\DoxyCodeLine{481                             m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = elem-\/>GetWeight(l, points, [=](\textcolor{keyword}{const} Mesh::Point\& p) \{ \textcolor{keywordflow}{return} m\_problem-\/>get\_boundary\_parameter(0, type, p); \});}
\DoxyCodeLine{482                             \textcolor{keywordflow}{if}(m\_problem-\/>findTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}))}
\DoxyCodeLine{483                                 \{}
\DoxyCodeLine{484                                     m\_RightMatrix-\/>NullRow(row-\/>GetNode(k));}
\DoxyCodeLine{485                                     \textcolor{comment}{//m\_RightMatrix-\/>operator()(row-\/>GetNode(k), row-\/>GetNode(k)) *= mu;}}
\DoxyCodeLine{486                                 \}}
\DoxyCodeLine{487                         \}}
\DoxyCodeLine{488                         \textcolor{comment}{/*for (int k = dofs2; k < dofs; ++k)}}
\DoxyCodeLine{489 \textcolor{comment}{                        \{}}
\DoxyCodeLine{490 \textcolor{comment}{                            m\_GlobalMatrix-\/>NullRow(row-\/>GetNode(k));}}
\DoxyCodeLine{491 \textcolor{comment}{                            m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = 0;}}
\DoxyCodeLine{492 \textcolor{comment}{                        \}*/}}
\DoxyCodeLine{493                     \}}
\DoxyCodeLine{494                 \}}
\DoxyCodeLine{495             \}}
\DoxyCodeLine{496             \textcolor{comment}{/*for (auto bnd : m\_Grid-\/>GetBoundaryConditions())}}
\DoxyCodeLine{497 \textcolor{comment}{            \{}}
\DoxyCodeLine{498 \textcolor{comment}{                if (get<0>(bnd.second) == 1)}}
\DoxyCodeLine{499 \textcolor{comment}{                    for (auto row : m\_Grid-\/>GetBoundary())}}
\DoxyCodeLine{500 \textcolor{comment}{                    \{}}
\DoxyCodeLine{501 \textcolor{comment}{                        if (bnd.first == row-\/>GetType())}}
\DoxyCodeLine{502 \textcolor{comment}{                        \{}}
\DoxyCodeLine{503 \textcolor{comment}{                            for (int i = 0; i < row-\/>GetDoF(); ++i)}}
\DoxyCodeLine{504 \textcolor{comment}{                            \{}}
\DoxyCodeLine{505 \textcolor{comment}{                                m\_GlobalMatrix-\/>NullRow(row-\/>GetNodes(i));}}
\DoxyCodeLine{506 \textcolor{comment}{                                m\_rhsvector[row-\/>GetNodes(i)] = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{507 \textcolor{comment}{                            \}}}
\DoxyCodeLine{508 \textcolor{comment}{                        \}}}
\DoxyCodeLine{509 \textcolor{comment}{                    \}}}
\DoxyCodeLine{510 \textcolor{comment}{            \}*/}}
\DoxyCodeLine{511         \}}
\DoxyCodeLine{512         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{513         \textcolor{keywordtype}{void} FEMethod<Problem, Grid, Matrix>::SecondConditions()}
\DoxyCodeLine{514         \{}
\DoxyCodeLine{515             \textcolor{keywordtype}{double} theta = 0;}
\DoxyCodeLine{516             \textcolor{keywordtype}{int} nfem;}
\DoxyCodeLine{517             Mesh::Point temp[3];}
\DoxyCodeLine{518             std::vector<int> local;}
\DoxyCodeLine{519             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{520             \{}
\DoxyCodeLine{521                 \textcolor{comment}{//if (get<0>(bnd.second) == 2)}}
\DoxyCodeLine{522                 \{}
\DoxyCodeLine{523                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{524                     \{}
\DoxyCodeLine{525                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{526                         \{}
\DoxyCodeLine{527                             local.resize(0);}
\DoxyCodeLine{528                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{529                             nfem = row-\/>GetNumberOfElement(0);}
\DoxyCodeLine{530                             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{531                             \textcolor{comment}{//auto GetBasis = [\&](int t, Point p)\{return elem-\/>GetBasis(t, p); \};}}
\DoxyCodeLine{532                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{533                             \{}
\DoxyCodeLine{534                                 temp[j] = m\_Grid-\/>GetNodes()[row-\/>GetNodes(j)];}
\DoxyCodeLine{535                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{536                                 \{}
\DoxyCodeLine{537                                     \textcolor{keywordflow}{if} (row-\/>GetNodes(j) == elem-\/>GetNodes()[i])}
\DoxyCodeLine{538                                     \{}
\DoxyCodeLine{539                                         local.push\_back(i);}
\DoxyCodeLine{540                                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{541                                     \}}
\DoxyCodeLine{542                                 \}}
\DoxyCodeLine{543                             \}}
\DoxyCodeLine{544                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{545                             \{}
\DoxyCodeLine{546                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{547                                 \{}
\DoxyCodeLine{548                                     \textcolor{comment}{//theta = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{549                                     theta = 0;}
\DoxyCodeLine{550                                     \textcolor{keyword}{auto} GetMass = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} elem-\/>GetBasis(local[j], p) * elem-\/>GetBasis(local[i], p); \};}
\DoxyCodeLine{551                                     \textcolor{keyword}{auto} GetBBasis = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} row-\/>GetBasis(j, p)*row-\/>GetBasis(i, p); \};}
\DoxyCodeLine{552                                     \textcolor{comment}{//if (i < 2 || j < 2)}}
\DoxyCodeLine{553                                     m\_rhsvector[row-\/>GetNodes(i)] += theta * row-\/>Integrate(GetMass, temp);}
\DoxyCodeLine{554 }
\DoxyCodeLine{555                                     \textcolor{comment}{//if (i < 3 || j < 3)}}
\DoxyCodeLine{556                                     \textcolor{comment}{//  m\_rhsvector[row[i + 1]] += theta * row-\/>Integrate(GetBBasis, temp);}}
\DoxyCodeLine{557                                 \}}
\DoxyCodeLine{558                             \}}
\DoxyCodeLine{559                         \}}
\DoxyCodeLine{560                     \}}
\DoxyCodeLine{561                 \}}
\DoxyCodeLine{562             \}}
\DoxyCodeLine{563         \}}
\DoxyCodeLine{564         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{565         \textcolor{keywordtype}{void} FEMethod<Problem, Grid, Matrix>::StefanConditions()}
\DoxyCodeLine{566         \{}
\DoxyCodeLine{567             \textcolor{keywordtype}{double} dest\{ 0. \}, lat\{ 0 \};}
\DoxyCodeLine{568             \textcolor{keywordtype}{int} nfem;}
\DoxyCodeLine{569             Mesh::Point temp[3];}
\DoxyCodeLine{570             std::vector<int> local;}
\DoxyCodeLine{571             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{572             \{}
\DoxyCodeLine{573                 \textcolor{comment}{//if (get<0>(bnd.second) == 4)}}
\DoxyCodeLine{574                 \{}
\DoxyCodeLine{575                     lat = 0;}
\DoxyCodeLine{576                     \textcolor{comment}{//lat = get<2>(bnd.second);}}
\DoxyCodeLine{577                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{578                     \{}
\DoxyCodeLine{579                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{580                         \{}
\DoxyCodeLine{581                             local.resize(0);}
\DoxyCodeLine{582                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{583                             nfem = row-\/>GetNumberOfElement(0);}
\DoxyCodeLine{584                             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{585                             \textcolor{comment}{//auto GetBasis = [\&](int t, Point p)\{return elem-\/>GetBasis(t, p); \};}}
\DoxyCodeLine{586                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{587                             \{}
\DoxyCodeLine{588                                 temp[j] = m\_Grid-\/>GetNodes()[row-\/>GetNodes(j)];}
\DoxyCodeLine{589                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{590                                 \{}
\DoxyCodeLine{591                                     \textcolor{keywordflow}{if} (row-\/>GetNodes(j) == elem-\/>GetNodes()[i])}
\DoxyCodeLine{592                                     \{}
\DoxyCodeLine{593                                         local.push\_back(i);}
\DoxyCodeLine{594                                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{595                                     \}}
\DoxyCodeLine{596                                 \}}
\DoxyCodeLine{597                             \}}
\DoxyCodeLine{598                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{599                             \{}
\DoxyCodeLine{600                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{601                                 \{}
\DoxyCodeLine{602                                     dest = 0;}
\DoxyCodeLine{603                                     \textcolor{comment}{//dest = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{604                                     \textcolor{keyword}{auto} GetBBasis = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} row-\/>GetBasis(j, p)*row-\/>GetBasis(i, p); \};}
\DoxyCodeLine{605                                     \textcolor{comment}{//if (i < 2 || j < 2)}}
\DoxyCodeLine{606                                     m\_rhsvector[row-\/>GetNodes(i)] += dest * lat * row-\/>Integrate(GetBBasis, temp);}
\DoxyCodeLine{607 }
\DoxyCodeLine{608                                     \textcolor{comment}{//if (i < 3 || j < 3)}}
\DoxyCodeLine{609                                     \textcolor{comment}{//  m\_rhsvector[row[i + 1]] += theta * row-\/>Integrate(GetBBasis, temp);}}
\DoxyCodeLine{610                                 \}}
\DoxyCodeLine{611                             \}}
\DoxyCodeLine{612                         \}}
\DoxyCodeLine{613                     \}}
\DoxyCodeLine{614                 \}}
\DoxyCodeLine{615             \}}
\DoxyCodeLine{616         \}}
\DoxyCodeLine{617         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{618         \textcolor{keywordtype}{void} FEMethod<Problem, Grid, Matrix>::ThirdConditions()}
\DoxyCodeLine{619         \{}
\DoxyCodeLine{620             \textcolor{keywordtype}{double} param\{ 0 \}, beta\{ 0 \};}
\DoxyCodeLine{621             \textcolor{keywordtype}{int} nfem;}
\DoxyCodeLine{622             Mesh::Point temp[6];}
\DoxyCodeLine{623             std::vector<int> local;}
\DoxyCodeLine{624             \textcolor{keyword}{auto} fxy = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} (10 * p.y*m\_time + m\_time) / 10; \};}
\DoxyCodeLine{625             \textcolor{comment}{//auto fxy = [\&](const Point\& p)\{return 10 * p.y + 10 * m\_time; \};}}
\DoxyCodeLine{626             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{627             \{}
\DoxyCodeLine{628                 \textcolor{comment}{//if (get<0>(bnd.second) == 3)}}
\DoxyCodeLine{629                 \{}
\DoxyCodeLine{630 }
\DoxyCodeLine{631                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{632                     \{}
\DoxyCodeLine{633                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{634                         \{}
\DoxyCodeLine{635                             local.resize(0);}
\DoxyCodeLine{636                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{637                             nfem = row-\/>GetNumberOfElement(0);}
\DoxyCodeLine{638                             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{639                             \textcolor{comment}{//auto GetBasis = [\&](int t, Point p)\{return elem-\/>GetBasis(t, p); \};}}
\DoxyCodeLine{640                             \textcolor{keyword}{auto} order = elem-\/>GetDoF();}
\DoxyCodeLine{641                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{642                             \{}
\DoxyCodeLine{643                                 temp[j] = m\_Grid-\/>GetNodes()[row-\/>GetNodes(j)];}
\DoxyCodeLine{644                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < order; ++i)}
\DoxyCodeLine{645                                 \{}
\DoxyCodeLine{646                                     \textcolor{keywordflow}{if} (row-\/>GetNodes(j) == elem-\/>GetNodes()[i])}
\DoxyCodeLine{647                                     \{}
\DoxyCodeLine{648                                         local.push\_back(i);}
\DoxyCodeLine{649                                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{650                                     \}}
\DoxyCodeLine{651                                 \}}
\DoxyCodeLine{652                             \}}
\DoxyCodeLine{653                             \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{654                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{655                             \{}
\DoxyCodeLine{656                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{657                                 \{}
\DoxyCodeLine{658                                     param = 0;}
\DoxyCodeLine{659                                     beta = 0;}
\DoxyCodeLine{660                                     \textcolor{comment}{//beta = get<2>(bnd.second);}}
\DoxyCodeLine{661                                     \textcolor{comment}{//param = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{662                                     \textcolor{comment}{//param = fxy(temp[j]);}}
\DoxyCodeLine{663                                     \textcolor{keyword}{auto} GetBBasis = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} elem-\/>GetBasis(local[j], p)*elem-\/>GetBasis(local[i], p); \};}
\DoxyCodeLine{664                                     \textcolor{comment}{//val = row-\/>GetElement(GetBBasis, temp);}}
\DoxyCodeLine{665                                     val = row-\/>Integrate(GetBBasis, temp);}
\DoxyCodeLine{666                                     m\_GlobalMatrix-\/>operator()(row-\/>GetNodes(i), row-\/>GetNodes(j)) += beta * val;}
\DoxyCodeLine{667                                     m\_rhsvector[row-\/>GetNodes(i)] += beta * param * val;}
\DoxyCodeLine{668                                 \}}
\DoxyCodeLine{669                             \}}
\DoxyCodeLine{670                         \}}
\DoxyCodeLine{671                     \}}
\DoxyCodeLine{672                 \}}
\DoxyCodeLine{673             \}}
\DoxyCodeLine{674         \}}
\DoxyCodeLine{675         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{676         Matrix* \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a239946bbc34935ade8dcd50a0c5ab6b7}{FEMethod<Problem, Grid, Matrix>::GetGlobalMatrix}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{677 \textcolor{keyword}{        }\{}
\DoxyCodeLine{678             \textcolor{keywordflow}{return} m\_GlobalMatrix;}
\DoxyCodeLine{679         \}}
\DoxyCodeLine{680         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{681         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{FEMethod<Problem, Grid, Matrix>::GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)\textcolor{keyword}{ const}}
\DoxyCodeLine{682 \textcolor{keyword}{        }\{}
\DoxyCodeLine{683             \textcolor{keywordflow}{if} (!m\_solution.size())}
\DoxyCodeLine{684                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{685             \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{686             \textcolor{keywordtype}{int} nfem = -\/1;}
\DoxyCodeLine{687             nfem = m\_Grid-\/>FindElement(p);}
\DoxyCodeLine{688             \textcolor{keywordflow}{if} (nfem == -\/1)}
\DoxyCodeLine{689                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{690             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{691             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{692                 val += m\_solution[elem-\/>GetNodes()[i]] * elem-\/>GetBasis(i, p);}
\DoxyCodeLine{693             \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{694         \}}
\DoxyCodeLine{695         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{696         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{FEMethod<Problem, Grid, Matrix>::GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} std::vector<double>\& vec)\textcolor{keyword}{ const}}
\DoxyCodeLine{697 \textcolor{keyword}{        }\{}
\DoxyCodeLine{698             \textcolor{keywordflow}{if} (!vec.size())}
\DoxyCodeLine{699                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{700             \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{701             \textcolor{keywordtype}{int} nfem\{ -\/1 \};}
\DoxyCodeLine{702             nfem = m\_Grid-\/>FindElement(p);}
\DoxyCodeLine{703             \textcolor{keywordflow}{if} (nfem == -\/1)}
\DoxyCodeLine{704                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{705             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{706             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoFs(); ++i)}
\DoxyCodeLine{707                 val += vec[elem-\/>GetNode(i)] * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{708             \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{709         \}}
\DoxyCodeLine{710         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{711         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_acd0ad5d645661000738cdb574dbdeb38}{FEMethod<Problem, Grid, Matrix>::GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} std::vector<double>\& vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num)\textcolor{keyword}{ const}}
\DoxyCodeLine{712 \textcolor{keyword}{        }\{}
\DoxyCodeLine{713             \textcolor{keywordflow}{if} (!vec.size() || num < 0)}
\DoxyCodeLine{714                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{715             \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{716             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[num];}
\DoxyCodeLine{717             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{718                 val += vec[elem-\/>GetNodes()[i]] * elem-\/>GetBasis(i, p);}
\DoxyCodeLine{719             \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{720         \}}
\DoxyCodeLine{721         \textcolor{comment}{//template<class Problem, class Grid, class Matrix>}}
\DoxyCodeLine{722         \textcolor{comment}{//const Mesh::Point FEMethod<Problem, Grid, Matrix>::GetGradValue(const Mesh::Point\& p, const std::vector<double>\& vec) const}}
\DoxyCodeLine{723         \textcolor{comment}{//\{}}
\DoxyCodeLine{724         \textcolor{comment}{//  Mesh::Point val\{ 0, 0 \};}}
\DoxyCodeLine{725         \textcolor{comment}{//  int nfem\{ -\/1 \};}}
\DoxyCodeLine{726         \textcolor{comment}{//  nfem = m\_Grid-\/>FindElement(p);}}
\DoxyCodeLine{727         \textcolor{comment}{//  if (nfem == -\/1)}}
\DoxyCodeLine{728         \textcolor{comment}{//      return val;}}
\DoxyCodeLine{729         \textcolor{comment}{//  auto elem = m\_Grid-\/>GetElements()[nfem];}}
\DoxyCodeLine{730         \textcolor{comment}{//  for (int i = 0; i < elem-\/>GetDoF(); ++i)}}
\DoxyCodeLine{731         \textcolor{comment}{//  \{}}
\DoxyCodeLine{732         \textcolor{comment}{//      val.x += vec[elem-\/>GetNodes()[i]] * elem-\/>GetGradBasis(i, p).x;}}
\DoxyCodeLine{733         \textcolor{comment}{//      val.y += vec[elem-\/>GetNodes()[i]] * elem-\/>GetGradBasis(i, p).y;}}
\DoxyCodeLine{734         \textcolor{comment}{//      val.z += vec[elem-\/>GetNodes()[i]] * elem-\/>GetGradBasis(i, p).z;}}
\DoxyCodeLine{735         \textcolor{comment}{//  \}}}
\DoxyCodeLine{736         \textcolor{comment}{//  return val;}}
\DoxyCodeLine{737         \textcolor{comment}{//\}}}
\DoxyCodeLine{738         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{739         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a5c286a9d43be47e959101b0350d74128}{FEMethod<Problem, Grid, Matrix>::GetEffective}}(\textcolor{keyword}{const} std::vector<double>\& vec)\textcolor{keyword}{ const}}
\DoxyCodeLine{740 \textcolor{keyword}{        }\{}
\DoxyCodeLine{741             \textcolor{keywordtype}{double} sum = 0;}
\DoxyCodeLine{742             \textcolor{comment}{//std::vector<int> dofs;}}
\DoxyCodeLine{743             \textcolor{comment}{//Mesh::Point points[10];}}
\DoxyCodeLine{744             \textcolor{comment}{//for (int i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}}
\DoxyCodeLine{745             \textcolor{comment}{//\{}}
\DoxyCodeLine{746                 \textcolor{comment}{//auto mb = [\&](const Mesh::Point\& b) \{return GetGradValue(b, vec)*GetGradValue(b, vec); \};}}
\DoxyCodeLine{747                 \textcolor{comment}{//dofs.resize(0);}}
\DoxyCodeLine{748                 \textcolor{comment}{//auto elem = m\_Grid-\/>GetElements()[i];}}
\DoxyCodeLine{749                 \textcolor{comment}{//int order = elem-\/>GetDoF();}}
\DoxyCodeLine{750                 \textcolor{comment}{//double diff = std::get<0>(m\_Grid-\/>GetDiffusion().find(elem-\/>GetType())-\/>second);}}
\DoxyCodeLine{751                 \textcolor{comment}{//for (int j = 0; j < order; ++j)}}
\DoxyCodeLine{752                 \textcolor{comment}{//\{}}
\DoxyCodeLine{753                     \textcolor{comment}{//dofs.push\_back(elem-\/>GetNodes()[j]);}}
\DoxyCodeLine{754                     \textcolor{comment}{//points[j] = m\_Grid-\/>GetNodes()[dofs[j]];}}
\DoxyCodeLine{755                 \textcolor{comment}{//\}}}
\DoxyCodeLine{756                 \textcolor{comment}{//sum += diff * elem-\/>Integrate(mb, points);}}
\DoxyCodeLine{757             \textcolor{comment}{//\}}}
\DoxyCodeLine{758             \textcolor{comment}{//std::cout << "{}Effect (local): "{} << sum << std::endl;}}
\DoxyCodeLine{759             \textcolor{comment}{//std::cout << "{}Effect (local) sqrt: "{} << sqrt(sum) << std::endl;}}
\DoxyCodeLine{760             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{761         \}}
\DoxyCodeLine{762         \textcolor{comment}{//template<class Problem, class Grid, class Matrix>}}
\DoxyCodeLine{763         \textcolor{comment}{//const Mesh::Point FEMethod<Problem, Grid, Matrix>::GetLambdaGrad(const Mesh::Point\& p, const std::vector<double>\& vec) const}}
\DoxyCodeLine{764         \textcolor{comment}{//\{}}
\DoxyCodeLine{765         \textcolor{comment}{//  Mesh::Point val\{ 0, 0, 0 \};}}
\DoxyCodeLine{766         \textcolor{comment}{//  //double val\{ 0 \};}}
\DoxyCodeLine{767         \textcolor{comment}{//  double diff\{ 0 \};}}
\DoxyCodeLine{768         \textcolor{comment}{//  Mesh::Point temp\{ 0, 0, 0 \};}}
\DoxyCodeLine{769         \textcolor{comment}{//  int nfem\{ -\/1 \};}}
\DoxyCodeLine{770         \textcolor{comment}{//  nfem = m\_Grid-\/>FindElement(p);}}
\DoxyCodeLine{771         \textcolor{comment}{//  if (nfem == -\/1)}}
\DoxyCodeLine{772         \textcolor{comment}{//      return val;}}
\DoxyCodeLine{773         \textcolor{comment}{//  auto elem = m\_Grid-\/>GetElements()[nfem];}}
\DoxyCodeLine{774         \textcolor{comment}{//  diff = std::get<0>(m\_Grid-\/>GetDiffusion().find(elem-\/>GetType())-\/>second);}}
\DoxyCodeLine{775         \textcolor{comment}{//  for (int i = 0; i < elem-\/>GetDoF(); ++i)}}
\DoxyCodeLine{776         \textcolor{comment}{//  \{}}
\DoxyCodeLine{777         \textcolor{comment}{//      //val += elem-\/>GetGradBasis(i, p) * elem-\/>GetGradBasis(i, p) * vec[elem-\/>GetNodes()[i]] * vec[elem-\/>GetNodes()[i]] * diff;}}
\DoxyCodeLine{778         \textcolor{comment}{//      //val += elem-\/>GetBasis(i, p) * vec[elem-\/>GetNodes()[i]] * diff;}}
\DoxyCodeLine{779         \textcolor{comment}{//      temp = elem-\/>GetGradBasis(i, p);}}
\DoxyCodeLine{780         \textcolor{comment}{//      val.x += temp.x * vec[elem-\/>GetNodes()[i]] * (diff);}}
\DoxyCodeLine{781         \textcolor{comment}{//      val.y += temp.y * vec[elem-\/>GetNodes()[i]] * (diff);}}
\DoxyCodeLine{782         \textcolor{comment}{//      val.z += temp.z * vec[elem-\/>GetNodes()[i]] * (diff);}}
\DoxyCodeLine{783         \textcolor{comment}{//  \}}}
\DoxyCodeLine{784         \textcolor{comment}{//  return val;}}
\DoxyCodeLine{785         \textcolor{comment}{//\}}}
\DoxyCodeLine{786         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{787         \textcolor{keyword}{const} std::vector<double> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6df01711cfd3a84323aa47ade3d77684}{FEMethod<Problem, Grid, Matrix>::GetRightVector}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{788 \textcolor{keyword}{        }\{}
\DoxyCodeLine{789             \textcolor{keywordflow}{return} *m\_rhsvector;}
\DoxyCodeLine{790         \}}
\DoxyCodeLine{791         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{792         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a30ba41d521e56edc0b6dc8807ca5f68a}{FEMethod<Problem, Grid, Matrix>::OutDatFormat}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& mn, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& mx, \textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec)\textcolor{keyword}{ const}}
\DoxyCodeLine{793 \textcolor{keyword}{        }\{}
\DoxyCodeLine{794             std::ofstream of(file\_name + \textcolor{stringliteral}{"{}z.dat"{}});}
\DoxyCodeLine{795             std::streambuf *buf = std::cout.rdbuf();}
\DoxyCodeLine{796             std::cout.rdbuf(of.rdbuf());}
\DoxyCodeLine{797             std::cout << \textcolor{stringliteral}{"{}TITLE = FE-\/METHOD\(\backslash\)n"{}};}
\DoxyCodeLine{798             std::cout << \textcolor{stringliteral}{"{}VARIABLES = \(\backslash\)"{}dx1\(\backslash\)"{}, \(\backslash\)"{}dx2\(\backslash\)"{}, \(\backslash\)"{}u\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{799             std::cout << \textcolor{stringliteral}{"{}ZONE i=51, j=51, F=POINT\(\backslash\)n"{}};}
\DoxyCodeLine{800             \textcolor{keywordtype}{double} stepx = (mx.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} -\/ mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}}) / 51;}
\DoxyCodeLine{801             \textcolor{keywordtype}{double} stepy = (mx.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} -\/ mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}}) / 51;}
\DoxyCodeLine{802             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 51; ++i)}
\DoxyCodeLine{803                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 51; ++j)}
\DoxyCodeLine{804                     std::cout << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + stepy * i << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + i * stepy, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}}), vec) << std::endl;}
\DoxyCodeLine{805             std::cout.rdbuf(buf);}
\DoxyCodeLine{806             of.close();}
\DoxyCodeLine{807             of.open(file\_name + \textcolor{stringliteral}{"{}x.dat"{}});}
\DoxyCodeLine{808             buf = std::cout.rdbuf();}
\DoxyCodeLine{809             std::cout.rdbuf(of.rdbuf());}
\DoxyCodeLine{810             std::cout << \textcolor{stringliteral}{"{}TITLE = FE-\/METHOD\(\backslash\)n"{}};}
\DoxyCodeLine{811             std::cout << \textcolor{stringliteral}{"{}VARIABLES = \(\backslash\)"{}dx1\(\backslash\)"{}, \(\backslash\)"{}dx2\(\backslash\)"{}, \(\backslash\)"{}u\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{812             std::cout << \textcolor{stringliteral}{"{}ZONE i=51, j=51, F=POINT\(\backslash\)n"{}};}
\DoxyCodeLine{813             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 51; ++i)}
\DoxyCodeLine{814                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 51; ++j)}
\DoxyCodeLine{815                     std::cout << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + stepy * i << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}}, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + i * stepy), vec) << std::endl;}
\DoxyCodeLine{816             std::cout.rdbuf(buf);}
\DoxyCodeLine{817             of.close();}
\DoxyCodeLine{818             of.open(file\_name + \textcolor{stringliteral}{"{}y.dat"{}});}
\DoxyCodeLine{819             buf = std::cout.rdbuf();}
\DoxyCodeLine{820             std::cout.rdbuf(of.rdbuf());}
\DoxyCodeLine{821             std::cout << \textcolor{stringliteral}{"{}TITLE = FE-\/METHOD\(\backslash\)n"{}};}
\DoxyCodeLine{822             std::cout << \textcolor{stringliteral}{"{}VARIABLES = \(\backslash\)"{}dx1\(\backslash\)"{}, \(\backslash\)"{}dx2\(\backslash\)"{}, \(\backslash\)"{}u\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{823             std::cout << \textcolor{stringliteral}{"{}ZONE i=51, j=51, F=POINT\(\backslash\)n"{}};}
\DoxyCodeLine{824             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 51; ++i)}
\DoxyCodeLine{825                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 51; ++j)}
\DoxyCodeLine{826                     std::cout << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + stepy * i << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}}, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + i * stepy), vec) << std::endl;}
\DoxyCodeLine{827             std::cout.rdbuf(buf);}
\DoxyCodeLine{828             of.close();}
\DoxyCodeLine{829         \}}
\DoxyCodeLine{830         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{831         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod}{FEMethod<Problem, Grid, Matrix>::ApplySources}}()}
\DoxyCodeLine{832         \{}
\DoxyCodeLine{833             \textcolor{keywordtype}{int} nfem = -\/1;}
\DoxyCodeLine{834             \textcolor{keyword}{auto} total = m\_problem-\/>get\_total\_sources();}
\DoxyCodeLine{835             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < total; ++i)}
\DoxyCodeLine{836             \{}
\DoxyCodeLine{837                 \textcolor{keyword}{auto} src = m\_problem-\/>get\_point\_source(i);}
\DoxyCodeLine{838                 \textcolor{keyword}{auto} point = src.get\_point();}
\DoxyCodeLine{839                 nfem = m\_Grid-\/>FindElement(point);}
\DoxyCodeLine{840                 \textcolor{keywordflow}{if} (nfem != -\/1)}
\DoxyCodeLine{841                 \{}
\DoxyCodeLine{842                     \textcolor{keyword}{auto} val = src.get\_value();}
\DoxyCodeLine{843                     \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElement(nfem);}
\DoxyCodeLine{844                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{845                         m\_rhsvector-\/>operator[](elem-\/>GetNode(j)) += val * elem-\/>GetShapeFunction(j, point);}
\DoxyCodeLine{846                 \}}
\DoxyCodeLine{847                 nfem = -\/1;}
\DoxyCodeLine{848             \}}
\DoxyCodeLine{849             \textcolor{comment}{/*for (auto srd : m\_Grid-\/>GetDottedSources())}}
\DoxyCodeLine{850 \textcolor{comment}{            \{}}
\DoxyCodeLine{851 \textcolor{comment}{                nfem = m\_Grid-\/>FindElement(srd.first);}}
\DoxyCodeLine{852 \textcolor{comment}{                if (nfem != -\/1)}}
\DoxyCodeLine{853 \textcolor{comment}{                \{}}
\DoxyCodeLine{854 \textcolor{comment}{                    auto elem = m\_Grid-\/>GetElements()[nfem];}}
\DoxyCodeLine{855 \textcolor{comment}{                    for (int i = 0; i < elem-\/>GetDoF(); ++i)}}
\DoxyCodeLine{856 \textcolor{comment}{                    \{}}
\DoxyCodeLine{857 \textcolor{comment}{                        m\_rhsvector[elem-\/>GetNodes()[i]] += srd.second * elem-\/>GetBasis(i, srd.first);}}
\DoxyCodeLine{858 \textcolor{comment}{                    \}}}
\DoxyCodeLine{859 \textcolor{comment}{                \}}}
\DoxyCodeLine{860 \textcolor{comment}{                nfem = -\/1;}}
\DoxyCodeLine{861 \textcolor{comment}{            \}*/}}
\DoxyCodeLine{862         \}}
\DoxyCodeLine{863         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{864         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a00e0463e735af23fe0ad017ec5df58bd}{FEMethod<Problem, Grid, Matrix>::Rediscretization}}(\textcolor{keyword}{const} std::shared\_ptr<Grid>\& grid)}
\DoxyCodeLine{865         \{}
\DoxyCodeLine{866             m\_GlobalMatrix-\/>NullMatrix();}
\DoxyCodeLine{867             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < m\_rhsvector-\/>size(); ++i)}
\DoxyCodeLine{868                 (*m\_rhsvector)[i] = 0;}
\DoxyCodeLine{869             AssemblGlobal();}
\DoxyCodeLine{870             \textcolor{comment}{//SecondConditions();}}
\DoxyCodeLine{871             \textcolor{comment}{//ApplySources();}}
\DoxyCodeLine{872             \textcolor{comment}{//StefanConditions();}}
\DoxyCodeLine{873             MainConditions();}
\DoxyCodeLine{874         \}}
\DoxyCodeLine{875         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{876         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a00e0463e735af23fe0ad017ec5df58bd}{FEMethod<Problem, Grid, Matrix>::Rediscretization}}()}
\DoxyCodeLine{877         \{}
\DoxyCodeLine{878             m\_time += m\_step;}
\DoxyCodeLine{879             m\_GlobalMatrix-\/>NullMatrix();}
\DoxyCodeLine{880             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < m\_rhsvector-\/>size(); ++i)}
\DoxyCodeLine{881                 (*m\_rhsvector)[i] = 0;}
\DoxyCodeLine{882             AssemblGlobal();}
\DoxyCodeLine{883             SecondConditions();}
\DoxyCodeLine{884             ThirdConditions();}
\DoxyCodeLine{885             StefanConditions();}
\DoxyCodeLine{886             \textcolor{comment}{//ApplySources();}}
\DoxyCodeLine{887             MainConditions();}
\DoxyCodeLine{888         \}}
\DoxyCodeLine{889         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{890         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{FEMethod<Problem, Grid, Matrix>::GetSolution}}(std::vector<double>\& vec)}
\DoxyCodeLine{891         \{}
\DoxyCodeLine{892             \textcolor{keywordtype}{int} size = vec.size();}
\DoxyCodeLine{893             \textcolor{comment}{//Translation(vec);}}
\DoxyCodeLine{894             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i)}
\DoxyCodeLine{895                 vec[i] = m\_solution[i];}
\DoxyCodeLine{896         \}}
\DoxyCodeLine{897         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{898         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{FEMethod<Problem, Grid, Matrix>::GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)}
\DoxyCodeLine{899         \{}
\DoxyCodeLine{900             \textcolor{keywordtype}{double} sum\{ 0 \};}
\DoxyCodeLine{901             \textcolor{keyword}{auto} nfem\{ g.FindElement(p) \};}
\DoxyCodeLine{902             \textcolor{keywordflow}{if} (nfem < 0)}
\DoxyCodeLine{903                 \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{904             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{905             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{906             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{907                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{908             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{909         \}}
\DoxyCodeLine{910         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{911         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a6d78616d95a6207b31084fb1de0db424}{FEMethod<Problem, Grid, Matrix>::GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nfem)}
\DoxyCodeLine{912         \{}
\DoxyCodeLine{913             \textcolor{keywordtype}{double} sum\{ 0 \};}
\DoxyCodeLine{914             \textcolor{comment}{//if (nfem < 0)}}
\DoxyCodeLine{915             \textcolor{comment}{//    return 0.;}}
\DoxyCodeLine{916             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{917             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{918             \textcolor{comment}{//std::cout << nfem << std::endl;}}
\DoxyCodeLine{919             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{920                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{921             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{922         \}}
\DoxyCodeLine{923         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{924         \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9500dc1e392800ff9580e371e50b3475}{FEMethod<Problem, Grid, Matrix>::GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)}
\DoxyCodeLine{925         \{}
\DoxyCodeLine{926             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} sum\{ 0, 0, 0 \};}
\DoxyCodeLine{927             \textcolor{keyword}{auto} nfem\{ g.FindElement(p) \};}
\DoxyCodeLine{928             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{929             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{930             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{931                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetGradShapeFunction(i, p);}
\DoxyCodeLine{932             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{933         \}}
\DoxyCodeLine{934         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{935         \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9500dc1e392800ff9580e371e50b3475}{FEMethod<Problem, Grid, Matrix>::GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nfem)}
\DoxyCodeLine{936         \{}
\DoxyCodeLine{937             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} sum\{ 0, 0, 0 \};}
\DoxyCodeLine{938             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{939             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{940             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{941                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetGradShapeFunction(i, p);}
\DoxyCodeLine{942             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{943         \}}
\DoxyCodeLine{944         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{945         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a2490006ce185d9a8604b76ed7f40532e}{FEMethod<Problem, Grid, Matrix>::LoadSolution}}(\textcolor{keyword}{const} std::vector<double>\& vec)}
\DoxyCodeLine{946         \{}
\DoxyCodeLine{947             m\_solution.resize(vec.size());}
\DoxyCodeLine{948             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < vec.size(); ++i)}
\DoxyCodeLine{949                 m\_solution[i] = vec[i];}
\DoxyCodeLine{950         \}}
\DoxyCodeLine{951         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{952         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_afaa26602de8a51328cfbe5ad358c6099}{FEMethod<Problem, Grid, Matrix>::OutMeshFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec)}
\DoxyCodeLine{953         \{}
\DoxyCodeLine{954             \textcolor{keyword}{const} \textcolor{keywordtype}{int} size\{ (int)m\_Grid-\/>GetNodes().size() \};}
\DoxyCodeLine{955             \textcolor{keyword}{const} \textcolor{keywordtype}{int} number\{ (int)m\_Grid-\/>GetElements().size() \};}
\DoxyCodeLine{956             \textcolor{comment}{//const int size\{ number * 4 \};}}
\DoxyCodeLine{957             std::ofstream ofs(file\_name + \textcolor{stringliteral}{"{}.dat"{}}, std::ios::out);}
\DoxyCodeLine{958             std::string title(\textcolor{stringliteral}{"{}TITLE = \(\backslash\)"{}Mesh data\(\backslash\)"{}\(\backslash\)n Variables = \(\backslash\)"{}X\(\backslash\)"{}, \(\backslash\)"{}Y\(\backslash\)"{}, \(\backslash\)"{}Z\(\backslash\)"{}, \(\backslash\)"{}U\(\backslash\)"{}\(\backslash\)n Zone N = "{}} + std::to\_string(size) + \textcolor{stringliteral}{"{}, E = "{}} + std::to\_string(number) + \textcolor{stringliteral}{"{}, DATAPACKING = POINT, ZONETYPE = FETETRAHEDRON\(\backslash\)n"{}});}
\DoxyCodeLine{959             ofs << title;}
\DoxyCodeLine{960             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} p;}
\DoxyCodeLine{961             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i)}
\DoxyCodeLine{962             \{}
\DoxyCodeLine{963                 p = m\_Grid-\/>GetNodes()[i];}
\DoxyCodeLine{964                 ofs << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(p, vec, 1) << std::endl;}
\DoxyCodeLine{965             \}}
\DoxyCodeLine{966             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < number; ++i)}
\DoxyCodeLine{967             \{}
\DoxyCodeLine{968                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{969                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 4; ++k)}
\DoxyCodeLine{970                 \{}
\DoxyCodeLine{971                     ofs << elem-\/>GetNodes()[k] + 1 << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{972                 \}}
\DoxyCodeLine{973                 ofs << std::endl;}
\DoxyCodeLine{974             \}}
\DoxyCodeLine{975             ofs.close();}
\DoxyCodeLine{976         \}}
\DoxyCodeLine{977         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{978         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a9a03d52d7faafa836c659295c680e7dd}{FEMethod<Problem, Grid, Matrix>::OutMeshTimeFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec)}
\DoxyCodeLine{979         \{}
\DoxyCodeLine{980             \textcolor{keyword}{const} \textcolor{keywordtype}{int} size\{ (int)m\_Grid-\/>GetNodes().size() \};}
\DoxyCodeLine{981             \textcolor{keyword}{const} \textcolor{keywordtype}{int} number\{ (int)m\_Grid-\/>GetElements().size() \};}
\DoxyCodeLine{982             \textcolor{comment}{//const int size\{ number * 4 \};}}
\DoxyCodeLine{983             std::ofstream ofs(file\_name + \textcolor{stringliteral}{"{}.dat"{}}, std::ios::out | std::ios::app);}
\DoxyCodeLine{984             std::string title(\textcolor{stringliteral}{"{}TITLE = \(\backslash\)"{}Mesh data\(\backslash\)"{}\(\backslash\)n Variables = \(\backslash\)"{}X\(\backslash\)"{}, \(\backslash\)"{}Y\(\backslash\)"{}, \(\backslash\)"{}Z\(\backslash\)"{}, \(\backslash\)"{}U\(\backslash\)"{}\(\backslash\)n Zone N = "{}} + std::to\_string(size) + \textcolor{stringliteral}{"{}, E = "{}} + std::to\_string(number) + \textcolor{stringliteral}{"{}, DATAPACKING = POINT, ZONETYPE = FETETRAHEDRON\(\backslash\)n"{}});}
\DoxyCodeLine{985             ofs << title;}
\DoxyCodeLine{986             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} p;}
\DoxyCodeLine{987             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i)}
\DoxyCodeLine{988             \{}
\DoxyCodeLine{989                 p = m\_Grid-\/>GetNodes()[i];}
\DoxyCodeLine{990                 ofs << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(p, vec, 1) << std::endl;}
\DoxyCodeLine{991             \}}
\DoxyCodeLine{992             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < number; ++i)}
\DoxyCodeLine{993             \{}
\DoxyCodeLine{994                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{995                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 4; ++k)}
\DoxyCodeLine{996                 \{}
\DoxyCodeLine{997                     ofs << elem-\/>GetNodes()[k] + 1 << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{998                 \}}
\DoxyCodeLine{999                 ofs << std::endl;}
\DoxyCodeLine{1000             \}}
\DoxyCodeLine{1001             ofs.close();}
\DoxyCodeLine{1002         \}}
\DoxyCodeLine{1003         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1004         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a93d04fcb12ab526ab01d593781586b58}{FEMethod<Problem, Grid, Matrix>::ProjectSolution}}(std::vector<double>\& sol, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&, \textcolor{keyword}{const} \textcolor{keywordtype}{int})> GetVal, std::vector<double>\& vec)}
\DoxyCodeLine{1005         \{}
\DoxyCodeLine{1006             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}
\DoxyCodeLine{1007             \{}
\DoxyCodeLine{1008                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1009                 \textcolor{keywordtype}{int} order = elem-\/>GetDoF();}
\DoxyCodeLine{1010                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1011                     sol[elem-\/>GetNodes(j)] = GetVal(m\_Grid-\/>GetNodes()[elem-\/>GetNodes(j)], vec, i);}
\DoxyCodeLine{1012             \}}
\DoxyCodeLine{1013         \}}
\DoxyCodeLine{1014         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1015         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a93d04fcb12ab526ab01d593781586b58}{FEMethod<Problem, Grid, Matrix>::ProjectSolution}}(std::vector<double>\& sol, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&)> GetVal, std::vector<double>\& vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int})}
\DoxyCodeLine{1016         \{}
\DoxyCodeLine{1017             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}
\DoxyCodeLine{1018             \{}
\DoxyCodeLine{1019                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1020                 \textcolor{keywordtype}{int} order = elem-\/>GetDoF();}
\DoxyCodeLine{1021                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1022                     sol[elem-\/>GetNodes(j)] = GetVal(m\_Grid-\/>GetNodes()[elem-\/>GetNodes(j)], vec);}
\DoxyCodeLine{1023             \}}
\DoxyCodeLine{1024         \}}
\DoxyCodeLine{1025         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1026         \textcolor{keyword}{const} std::vector<double> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_a039760e61a3ea14edf113e90f3d1ae01}{FEMethod<Problem, Grid, Matrix>::SetSolution}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} sol, \textcolor{keyword}{const} \textcolor{keywordtype}{int} liq, \textcolor{keyword}{const} \textcolor{keywordtype}{double} s, \textcolor{keyword}{const} \textcolor{keywordtype}{double} l, \textcolor{keyword}{const} \textcolor{keywordtype}{double} m)}
\DoxyCodeLine{1027         \{}
\DoxyCodeLine{1028             \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1029             m\_solution.resize(m\_Grid-\/>GetNodes().size());}
\DoxyCodeLine{1030             \textcolor{keywordflow}{for} (i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}
\DoxyCodeLine{1031             \{}
\DoxyCodeLine{1032                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1033                 \textcolor{keywordtype}{int} order = elem-\/>GetDoF();}
\DoxyCodeLine{1034                 \textcolor{keywordflow}{if} (m\_Grid-\/>GetElements()[i]-\/>GetType() == liq)}
\DoxyCodeLine{1035                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1036                         m\_solution[elem-\/>GetNodes()[j]] = l;}
\DoxyCodeLine{1037                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1038                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1039                         m\_solution[elem-\/>GetNodes()[j]] = s;}
\DoxyCodeLine{1040             \}}
\DoxyCodeLine{1041 }
\DoxyCodeLine{1042             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{1043             \{}
\DoxyCodeLine{1044                 \textcolor{comment}{//if (get<0>(bnd.second) == 4)}}
\DoxyCodeLine{1045                 \{}
\DoxyCodeLine{1046                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{1047                     \{}
\DoxyCodeLine{1048                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{1049                         \{}
\DoxyCodeLine{1050                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{1051                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{1052                             \{}
\DoxyCodeLine{1053                                 m\_solution[row-\/>GetNodes(i)] = m;}
\DoxyCodeLine{1054                             \}}
\DoxyCodeLine{1055                         \}}
\DoxyCodeLine{1056                     \}}
\DoxyCodeLine{1057                 \}}
\DoxyCodeLine{1058             \}}
\DoxyCodeLine{1059             \textcolor{keywordflow}{return} m\_solution;}
\DoxyCodeLine{1060         \}}
\DoxyCodeLine{1061         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1062         \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethod_afc0d409b21125a73ccd9eb78f6eb3b9e}{FEMethod<Problem, Grid, Matrix>::\string~FEMethod}}()}
\DoxyCodeLine{1063         \{}
\DoxyCodeLine{1064             \textcolor{keyword}{delete} m\_Grid;}
\DoxyCodeLine{1065         \}}
\DoxyCodeLine{1066     \}}
\DoxyCodeLine{1067 \}}
\DoxyCodeLine{1068 }
\DoxyCodeLine{1069 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !CORENC\_METHODS\_FEMethod\_h}}
\DoxyCodeLine{1070 }

\end{DoxyCode}
