\hypertarget{FEMethodZero_8h_source}{}\doxysection{FEMethod\+Zero.\+h}
\label{FEMethodZero_8h_source}\index{CoreNCFEM/Methods/FEMethodZero.h@{CoreNCFEM/Methods/FEMethodZero.h}}
\mbox{\hyperlink{FEMethodZero_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// FEMethodZero.h describes an abstract interface and functions for a general finite element method with zero Dirichlet boundaries}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#ifndef CORENC\_METHODS\_FEMethodZeroZero\_h}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#define CORENC\_METHODS\_FEMethodZeroZero\_h}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}../Point.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}../Parameter.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{CSMethod_8h}{CSMethod.h}}"{}}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecorenc}{corenc}}}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19     \textcolor{keyword}{namespace }Mesh}
\DoxyCodeLine{20     \{}
\DoxyCodeLine{21         \textcolor{keyword}{class }Point;}
\DoxyCodeLine{22     \}}
\DoxyCodeLine{23     \textcolor{keyword}{namespace }method}
\DoxyCodeLine{24     \{}
\DoxyCodeLine{25         \textcolor{comment}{// class Type = Type of the solution, for ex vector or double, or even more specific}}
\DoxyCodeLine{26 }
\DoxyCodeLine{27 }
\DoxyCodeLine{28         \textcolor{keyword}{template}<\textcolor{keyword}{class} Type>}
\DoxyCodeLine{29         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero}{CFEMethodZero}}}
\DoxyCodeLine{30         \{}
\DoxyCodeLine{31         \textcolor{keyword}{public}:}
\DoxyCodeLine{32             \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_aeca9b518e1ce7b3abd721f5c2ebb4791}{CFEMethodZero}}() \{\};}
\DoxyCodeLine{33             \textcolor{keyword}{virtual} \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_a7e4943c23b8225f09501f2b3d5149cb4}{\string~CFEMethodZero}}() \{\};}
\DoxyCodeLine{34             \textcolor{keyword}{virtual} \textcolor{keyword}{const} \textcolor{keywordtype}{int}                           \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_a22dad0dec3791ed5abcbf2a0f7e352e4}{Assemble}}() = 0;}
\DoxyCodeLine{35             \textcolor{keyword}{virtual} \textcolor{keyword}{const} Type                          \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_a1314a59803aa07f669a4c7757405b134}{GetSolution}}(\textcolor{keyword}{const} std::vector<double>\& point) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{36             \textcolor{keyword}{virtual} \textcolor{keyword}{const} std::vector<Type>             \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_a870cac9b5dd48feb5e2d2a55814868f5}{GetSolution}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{37             \textcolor{keyword}{virtual} \textcolor{keyword}{const} Type                          \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_ab0a4dc406bda813b94fb257df2c04062}{GetMaxSolution}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{38             \textcolor{keyword}{virtual} \textcolor{keyword}{const} Type                          \mbox{\hyperlink{classcorenc_1_1method_1_1CFEMethodZero_acb1d331edae51962f69d99c508ae7169}{GetMinSolution}}() \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{39         \};}
\DoxyCodeLine{40 }
\DoxyCodeLine{41         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{42         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero}{FEMethodZero}}}
\DoxyCodeLine{43         \{}
\DoxyCodeLine{44         \textcolor{keyword}{public}:}
\DoxyCodeLine{45             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aaf25bd2f3953b17b0e2d10b0b69194b8}{FEMethodZero}}() :}
\DoxyCodeLine{46                 m\_problem\{nullptr\},}
\DoxyCodeLine{47                 m\_Grid\{nullptr\},}
\DoxyCodeLine{48                 m\_GlobalMatrix\{nullptr\},}
\DoxyCodeLine{49                 m\_RightMatrix\{nullptr\},}
\DoxyCodeLine{50                 m\_rhsvector\{nullptr\}}
\DoxyCodeLine{51             \{\}}
\DoxyCodeLine{52             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adb9f8b9096a74457d34103a8f9c14fde}{FEMethodZero}}(}
\DoxyCodeLine{53                 Problem* p,}
\DoxyCodeLine{54                 Grid* g,}
\DoxyCodeLine{55                 Matrix* m,}
\DoxyCodeLine{56                 std::vector<double>* rhs):}
\DoxyCodeLine{57                 m\_problem\{ p \},}
\DoxyCodeLine{58                 m\_Grid\{ g-\/>Clone() \},}
\DoxyCodeLine{59                 m\_GlobalMatrix\{ m \},}
\DoxyCodeLine{60                 m\_N\{ g-\/>GetNumberOfElements() \},}
\DoxyCodeLine{61                 m\_Ns\{ g-\/>GetNumberOfBoundaries() \},}
\DoxyCodeLine{62                 m\_rhsvector\{ rhs \}\{}
\DoxyCodeLine{63                 \textcolor{comment}{//GeneratePortrait();}}
\DoxyCodeLine{64             \}}
\DoxyCodeLine{65             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a4022c8bca59884034c92ca90503b9193}{FEMethodZero}}(}
\DoxyCodeLine{66                 Problem* p,}
\DoxyCodeLine{67                 Grid* g,}
\DoxyCodeLine{68                 Matrix* m,}
\DoxyCodeLine{69                 Matrix* rm,}
\DoxyCodeLine{70                 std::vector<double>* rhs):}
\DoxyCodeLine{71                 m\_problem\{ p \},}
\DoxyCodeLine{72                 m\_Grid\{ g-\/>Clone() \},}
\DoxyCodeLine{73                 m\_GlobalMatrix\{ m \},}
\DoxyCodeLine{74                 m\_RightMatrix\{ rm \},}
\DoxyCodeLine{75                 m\_N\{ g-\/>GetNumberOfElements() \},}
\DoxyCodeLine{76                 m\_Ns\{ g-\/>GetNumberOfBoundaries() \},}
\DoxyCodeLine{77                 m\_rhsvector\{ rhs \}\{}
\DoxyCodeLine{78                 \textcolor{comment}{//GeneratePortrait();}}
\DoxyCodeLine{79             \}}
\DoxyCodeLine{80             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a83d63cec4980d8b5d38b9dede96e50df}{FEMethodZero}}(\textcolor{keyword}{const} std::shared\_ptr<Grid>\& grid) :m\_Grid\{ grid-\/>Clone() \} \{\}}
\DoxyCodeLine{81             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a5b889904498805a911f940bcf3d1aae1}{FEMethodZero}}(Grid* grid) :m\_Grid\{ grid-\/>Clone() \} \{\}}
\DoxyCodeLine{82             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a9c6b9f2d06c010732e6be2a491634bd6}{FEMethodZero}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero}{FEMethodZero}}\& meth) :}
\DoxyCodeLine{83                 m\_Grid\{ meth.m\_Grid-\/>Clone() \},}
\DoxyCodeLine{84                 \textcolor{comment}{//m\_GlobalMatrix\{ meth.m\_GlobalMatrix-\/>Clone() \},}}
\DoxyCodeLine{85                 \textcolor{comment}{//m\_rhsvector\{ meth.m\_rhsvector \},}}
\DoxyCodeLine{86                 \textcolor{comment}{//m\_problem\{ meth.m\_problem \},}}
\DoxyCodeLine{87                 m\_time\{ meth.m\_time \},}
\DoxyCodeLine{88                 \textcolor{comment}{//m\_solution\{ meth.m\_solution \},}}
\DoxyCodeLine{89                 m\_size\{ meth.m\_size \},}
\DoxyCodeLine{90                 m\_N\{ meth.m\_N \},}
\DoxyCodeLine{91                 m\_Ns\{ meth.m\_Ns \},}
\DoxyCodeLine{92                 m\_nums\{ meth.m\_nums \}}
\DoxyCodeLine{93             \{\};}
\DoxyCodeLine{94             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a2a93554d366cde7e43d33b62f6cdc3ee}{Discretization}}();}
\DoxyCodeLine{95             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&) \textcolor{keyword}{const};}
\DoxyCodeLine{96             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\& vec) \textcolor{keyword}{const};}
\DoxyCodeLine{97             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\& vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num) \textcolor{keyword}{const};}
\DoxyCodeLine{98             \textcolor{comment}{//const Mesh::Point         GetGradValue(const Mesh::Point\&, const std::vector<double>\& vec) const;}}
\DoxyCodeLine{99             \textcolor{comment}{//const Mesh::Point         GetLambdaGrad(const Mesh::Point\&, const std::vector<double>\& vec) const;}}
\DoxyCodeLine{100             \textcolor{keyword}{const} \textcolor{keywordtype}{double}                \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a1ee73cbde17b79365c4fce9d67991a22}{GetEffective}}(\textcolor{keyword}{const} std::vector<double>\& vec) \textcolor{keyword}{const};}
\DoxyCodeLine{101             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeaddd875e327ab03b8cf0e9e6351a918}{ProjectSolution}}(std::vector<double>\&, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&, \textcolor{keyword}{const} \textcolor{keywordtype}{int})> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{GetValue}}, std::vector<double>\& sol);}
\DoxyCodeLine{102             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeaddd875e327ab03b8cf0e9e6351a918}{ProjectSolution}}(std::vector<double>\&, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&)> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{GetValue}}, std::vector<double>\& sol, \textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{103             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a43afd3230ff310cba4d4992d530b3976}{LoadSolution}}(\textcolor{keyword}{const} std::vector<double>\& vec);}
\DoxyCodeLine{104             \textcolor{keyword}{const} std::vector<double>   \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeec36e8b838d791c61675f43926937e1}{SetSolution}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} sol, \textcolor{keyword}{const} \textcolor{keywordtype}{int} liq, \textcolor{keyword}{const} \textcolor{keywordtype}{double}, \textcolor{keyword}{const} \textcolor{keywordtype}{double}, \textcolor{keyword}{const} \textcolor{keywordtype}{double});}
\DoxyCodeLine{105             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a80d494891a70eb68f111897ba4b64eec}{GetSolution}}(std::vector<double>\& vec);}
\DoxyCodeLine{106             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeb0d62b554a42ac372453dee08547173}{Rediscretization}}(\textcolor{keyword}{const} std::shared\_ptr<Grid>\&);}
\DoxyCodeLine{107             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeb0d62b554a42ac372453dee08547173}{Rediscretization}}();}
\DoxyCodeLine{108             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_ad01d2754470e2f83cf13e79764e6f062}{SetTimeStep}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double}\& step) \{ m\_step = step; m\_time = step; \}}
\DoxyCodeLine{109             Matrix*                     \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_ad595adcc3935cad9c15f7c013a64ff67}{GetGlobalMatrix}}() \textcolor{keyword}{const};}
\DoxyCodeLine{110             Grid*                       \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_ab5cc0c98ab973f8b65042139791a8f02}{GetMesh}}() \{ \textcolor{keywordflow}{return} m\_Grid; \}}
\DoxyCodeLine{111             \textcolor{keyword}{const} std::vector<double>   \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a377d3d94bdbae6740f6b739d5e5ef767}{GetRightVector}}() \textcolor{keyword}{const};}
\DoxyCodeLine{112             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a2f3682858f2e1ceaa302db7277d58732}{OutDatFormat}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& min, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& max, \textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec) \textcolor{keyword}{const};}
\DoxyCodeLine{113             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a7abb3b918bae993c533d1b48e2519ee0}{OutMeshFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec);}
\DoxyCodeLine{114             \textcolor{keywordtype}{void}                        \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aaafa84c4105971722fc55d94b01f70f5}{OutMeshTimeFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec);}
\DoxyCodeLine{115             \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double}         \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a80d494891a70eb68f111897ba4b64eec}{GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p);}
\DoxyCodeLine{116             \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{double}         \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a80d494891a70eb68f111897ba4b64eec}{GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nfem);}
\DoxyCodeLine{117             \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a8a27552ec18dc9af1b92eb612698ec84}{GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p);}
\DoxyCodeLine{118             \textcolor{keyword}{static} \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a8a27552ec18dc9af1b92eb612698ec84}{GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} n);}
\DoxyCodeLine{119             \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adcfa379268d60597506e141a71946cdc}{\string~FEMethodZero}}();}
\DoxyCodeLine{120         \textcolor{keyword}{private}:}
\DoxyCodeLine{121             \textcolor{keywordtype}{void}                        GeneratePortrait();}
\DoxyCodeLine{122             \textcolor{keywordtype}{void}                        AssemblGlobal();}
\DoxyCodeLine{123             \textcolor{keywordtype}{void}                        MainConditions();}
\DoxyCodeLine{124             \textcolor{keywordtype}{void}                        SecondConditions();}
\DoxyCodeLine{125             \textcolor{keywordtype}{void}                        ThirdConditions();}
\DoxyCodeLine{126             \textcolor{keywordtype}{void}                        StefanConditions();}
\DoxyCodeLine{127             \textcolor{keywordtype}{void}                        ApplySources();}
\DoxyCodeLine{128             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleLocalMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{129             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleIDUDVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{130             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleIDUVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{131             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleIUDVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{132             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleRUVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{133             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleSUPGMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{134             \textcolor{keyword}{const} \textcolor{keywordtype}{int}                   AssembleLocalMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int}, \textcolor{keyword}{const} \textcolor{keywordtype}{int});}
\DoxyCodeLine{135             Grid*                       m\_Grid = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{136             Matrix*                     m\_GlobalMatrix = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{137             Matrix*                 m\_RightMatrix = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{138             Problem*                    m\_problem = \textcolor{keyword}{nullptr};}
\DoxyCodeLine{139             std::vector<double>         m\_solution;}
\DoxyCodeLine{140             std::vector<double>*        m\_rhsvector;}
\DoxyCodeLine{141             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                m\_size;}
\DoxyCodeLine{142             \textcolor{keywordtype}{double}                      m\_step\{ 0.1 \};}
\DoxyCodeLine{143             \textcolor{keywordtype}{double}                      m\_time\{ 0.1 \};}
\DoxyCodeLine{144             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                m\_N;}
\DoxyCodeLine{145             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int}                m\_Ns;}
\DoxyCodeLine{146             std::vector<unsigned int>   m\_nums;}
\DoxyCodeLine{147 }
\DoxyCodeLine{148         \};}
\DoxyCodeLine{149 }
\DoxyCodeLine{150         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{151         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a2a93554d366cde7e43d33b62f6cdc3ee}{FEMethodZero<Problem, Grid, Matrix>::Discretization}}()}
\DoxyCodeLine{152         \{}
\DoxyCodeLine{153             GeneratePortrait();}
\DoxyCodeLine{154             AssemblGlobal();}
\DoxyCodeLine{155             \textcolor{comment}{//ApplySources();}}
\DoxyCodeLine{156             \textcolor{comment}{//SecondConditions();}}
\DoxyCodeLine{157             \textcolor{comment}{//ThirdConditions();}}
\DoxyCodeLine{158             \textcolor{comment}{//MainConditions();}}
\DoxyCodeLine{159             \textcolor{comment}{//StefanConditions();}}
\DoxyCodeLine{160         \}}
\DoxyCodeLine{161         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{162         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero}{FEMethodZero<Problem, Grid, Matrix>::GeneratePortrait}}()}
\DoxyCodeLine{163         \{}
\DoxyCodeLine{164             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& el = m\_Grid-\/>GetElement(0);}
\DoxyCodeLine{165             \textcolor{keywordtype}{int} order = m\_Grid-\/>GetElement(0)-\/>GetDoFs();}
\DoxyCodeLine{166             std::vector<std::set<unsigned int>> temp;}
\DoxyCodeLine{167             m\_Ns = m\_Grid-\/>GetNumberOfINodes();}
\DoxyCodeLine{168             m\_N = m\_Grid-\/>GetNumberOfElements();}
\DoxyCodeLine{169             temp.resize(m\_Grid-\/>GetNumberOfINodes());}
\DoxyCodeLine{170             \textcolor{keywordtype}{unsigned} i, j, k;}
\DoxyCodeLine{171             \textcolor{keywordflow}{for} (k = 0; k < m\_N; ++k)}
\DoxyCodeLine{172             \{}
\DoxyCodeLine{173                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(k) \};}
\DoxyCodeLine{174                 \textcolor{keywordflow}{for} (i = 0; i < order; ++i)}
\DoxyCodeLine{175                     \textcolor{keywordflow}{for} (j = 0; j < order; ++j)}
\DoxyCodeLine{176                     \{}
\DoxyCodeLine{177                         \textcolor{comment}{//std::cout << "{}inside"{} << std::endl;}}
\DoxyCodeLine{178                         \textcolor{keywordtype}{int} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{179                         \textcolor{keywordtype}{int} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{180                         \textcolor{comment}{//std::cout << jnode << "{}\(\backslash\)t"{} << inode << std::endl;}}
\DoxyCodeLine{181                         \textcolor{comment}{//std::cout << "{}outside"{} << std::endl;}}
\DoxyCodeLine{182                         \textcolor{keywordflow}{if} (jnode > -\/1 \&\& inode > -\/1)}
\DoxyCodeLine{183                             \textcolor{keywordflow}{if} (jnode > inode)}
\DoxyCodeLine{184                             \{}
\DoxyCodeLine{185                                 temp[jnode].insert(inode);}
\DoxyCodeLine{186                             \}}
\DoxyCodeLine{187                     \}}
\DoxyCodeLine{188             \}}
\DoxyCodeLine{189             \textcolor{keywordflow}{if}(m\_problem-\/>findTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}))}
\DoxyCodeLine{190                 m\_RightMatrix-\/>Create(temp.size(), temp);}
\DoxyCodeLine{191 }
\DoxyCodeLine{192             \textcolor{comment}{//m\_GlobalMatrix = std::shared\_ptr<Matrix>(new Matrix(m\_Grid-\/>GetNumberOfNodes(), temp));}}
\DoxyCodeLine{193             \textcolor{comment}{//m\_rhsvector.resize(m\_Grid-\/>GetNumberOfNodes());}}
\DoxyCodeLine{194             \textcolor{comment}{//std::cout << temp.size() << std::endl;}}
\DoxyCodeLine{195             m\_GlobalMatrix-\/>Create(temp.size(), temp);}
\DoxyCodeLine{196             m\_rhsvector-\/>resize(temp.size());}
\DoxyCodeLine{197             \textcolor{comment}{//m\_solution.resize(m\_Grid-\/>GetNumberOfNodes());}}
\DoxyCodeLine{198             \textcolor{comment}{//for (int l = 0; l < m\_Grid-\/>GetNumberOfNodes(); ++l)}}
\DoxyCodeLine{199             \textcolor{comment}{//  m\_solution[l] = 20;}}
\DoxyCodeLine{200         \}}
\DoxyCodeLine{201         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{202         \textcolor{keywordtype}{void} FEMethodZero<Problem, Grid, Matrix>::AssemblGlobal()}
\DoxyCodeLine{203         \{}
\DoxyCodeLine{204             \textcolor{keywordtype}{int} l;}
\DoxyCodeLine{205             \textcolor{comment}{//std::vector<std::future<int>> futures;}}
\DoxyCodeLine{206             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{207             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{208             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{209             \textcolor{keywordflow}{for} (k = 0; k < terms; ++k)}
\DoxyCodeLine{210             \{}
\DoxyCodeLine{211                 \textcolor{keywordflow}{switch} (m\_problem-\/>getTerm(k))}
\DoxyCodeLine{212                 \{}
\DoxyCodeLine{213                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}:}
\DoxyCodeLine{214                         \textcolor{keywordflow}{for} (l = 0; l < m\_N; ++l)}
\DoxyCodeLine{215                             AssembleIDUDVMatrix(l);}
\DoxyCodeLine{216                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{217                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}:}
\DoxyCodeLine{218                         \textcolor{keywordflow}{for} (l = 0; l < m\_N; ++l)}
\DoxyCodeLine{219                             AssembleIDUVMatrix(l);}
\DoxyCodeLine{220                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{221                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dab9a50fb352778c6273b307887dd2ba28}{Terms::IUDV}}:}
\DoxyCodeLine{222                         \textcolor{keywordflow}{for} (l = 0; l < m\_N; ++l)}
\DoxyCodeLine{223                             AssembleIUDVMatrix(l);}
\DoxyCodeLine{224                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{225                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da9aa23ab26cb4db3b1e10a668eff580f2}{Terms::SUPG}}:}
\DoxyCodeLine{226                         \textcolor{keywordflow}{for} (l = 0; l < m\_N; ++l)}
\DoxyCodeLine{227                             AssembleSUPGMatrix(l);}
\DoxyCodeLine{228                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{229                     \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}:}
\DoxyCodeLine{230                         \textcolor{keywordflow}{for} (l = 0; l < m\_N; ++l)}
\DoxyCodeLine{231                             AssembleRUVMatrix(l);}
\DoxyCodeLine{232                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{233                     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{234                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{235                 \}}
\DoxyCodeLine{236             \}}
\DoxyCodeLine{237             \textcolor{comment}{//for (l = 0; l < m\_N; ++l)}}
\DoxyCodeLine{238                 \textcolor{comment}{//futures.push\_back(async(\&DGMethod<Problem, Grid, Matrix>::AssembleLocalMatrix, this, l));}}
\DoxyCodeLine{239              \textcolor{comment}{//   AssembleLocalMatrix(l, 0);}}
\DoxyCodeLine{240             \textcolor{comment}{//for (auto \&it : futures)}}
\DoxyCodeLine{241             \textcolor{comment}{//it.get();}}
\DoxyCodeLine{242         \}}
\DoxyCodeLine{243 }
\DoxyCodeLine{244         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{245         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethodZero<Problem, Grid, Matrix>::AssembleIDUDVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l)}
\DoxyCodeLine{246         \{}
\DoxyCodeLine{247             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{248             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{249             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{250             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{251             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{252             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{253             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{254             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{255                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{256             \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{257             \{}
\DoxyCodeLine{258                 \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{259                 \{}
\DoxyCodeLine{260                     \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{261                     \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{262                     \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{263                         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{264                     \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{265                     \{}
\DoxyCodeLine{266                         \textcolor{comment}{//auto m = elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}}
\DoxyCodeLine{267                         \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p) * elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{268                     \};}
\DoxyCodeLine{269                     \textcolor{comment}{//mij = m\_Grid-\/>getParameter(Parameters::DIFFUSION, l, j) * elem-\/>Integrate(M, points);}}
\DoxyCodeLine{270                     mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{271                     m\_GlobalMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{272                 \}}
\DoxyCodeLine{273             \}}
\DoxyCodeLine{274             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{275         \}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{278         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethodZero<Problem, Grid, Matrix>::AssembleIDUVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l)}
\DoxyCodeLine{279         \{}
\DoxyCodeLine{280             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{281             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{282             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{283             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{284             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{285             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{286             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{287             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{288                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{289             \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{290             \{}
\DoxyCodeLine{291                 \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{292                 \{}
\DoxyCodeLine{293                     \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{294                     \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{295                     \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{296                         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{297                     \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{298                     \{}
\DoxyCodeLine{299                         \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{300                     \};}
\DoxyCodeLine{301                     \textcolor{keyword}{auto} \_mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{302                     m\_GlobalMatrix-\/>AddElement(inode, jnode, \_mij);}
\DoxyCodeLine{303                 \}}
\DoxyCodeLine{304             \}}
\DoxyCodeLine{305             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{306         \}}
\DoxyCodeLine{307 }
\DoxyCodeLine{308         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{309         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethodZero<Problem, Grid, Matrix>::AssembleIUDVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l)}
\DoxyCodeLine{310         \{}
\DoxyCodeLine{311             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{312             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{313             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{314             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{315             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{316             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{317             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{318             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{319                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{320             \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{321             \{}
\DoxyCodeLine{322                 \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{323                 \{}
\DoxyCodeLine{324                     \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{325                     \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{326                     \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{327                         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{328                     \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{329                     \{}
\DoxyCodeLine{330                         \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{331                     \};}
\DoxyCodeLine{332                     \textcolor{comment}{//mij = m\_CoarseGrid-\/>getParameter(Parameters::ADVECTION, l, j) * m\_flux(m\_CoarseGrid-\/>getSolution(l, j)) * elem-\/>Integrate(M, points).x;}}
\DoxyCodeLine{333                     mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{334                     m\_GlobalMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{335                 \}}
\DoxyCodeLine{336             \}}
\DoxyCodeLine{337             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{338         \}}
\DoxyCodeLine{339 }
\DoxyCodeLine{340 }
\DoxyCodeLine{341         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{342         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethodZero<Problem, Grid, Matrix>::AssembleRUVMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l)}
\DoxyCodeLine{343         \{}
\DoxyCodeLine{344             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{345             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{346             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{347             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{348             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{349             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{350             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{351             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{352                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{353             \textcolor{keywordtype}{double} minPec = -\/1;}
\DoxyCodeLine{354             \textcolor{keyword}{auto} MM = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{355             \{}
\DoxyCodeLine{356                 \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{357                 \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{358                 \textcolor{comment}{//h = fabs(points[1].x -\/ points[0].x);}}
\DoxyCodeLine{359                 h = sqrt(h);}
\DoxyCodeLine{360                 \textcolor{comment}{//h = fabs(m\_Grid-\/>GetNode(0).x -\/ m\_Grid-\/>GetNode(1).x);}}
\DoxyCodeLine{361                 \textcolor{keywordtype}{double} Pe = vel * h / 2. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{362 }
\DoxyCodeLine{363                 \textcolor{comment}{//double Pe = vel * h / 2. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{364 }
\DoxyCodeLine{365                 \textcolor{keywordflow}{if} (Pe > minPec)}
\DoxyCodeLine{366                     minPec = Pe;}
\DoxyCodeLine{367                 \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{368             \};}
\DoxyCodeLine{369             elem-\/>Integrate(MM, points);}
\DoxyCodeLine{370             \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{371             \{}
\DoxyCodeLine{372                 \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{373                 \{}
\DoxyCodeLine{374                     \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{375                     \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{376                     \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{377                         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{378                     \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{379                     \{}
\DoxyCodeLine{380                         \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{381                         \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{382                         \textcolor{comment}{//h = fabs(points[1].x -\/ points[0].x);}}
\DoxyCodeLine{383                         h = sqrt(h);}
\DoxyCodeLine{384                         \textcolor{comment}{//h = fabs(m\_Grid-\/>GetNode(0).x -\/ m\_Grid-\/>GetNode(1).x);}}
\DoxyCodeLine{385                         \textcolor{comment}{//double Pe = vel * h / 6. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{386                         \textcolor{keywordtype}{double} Pe = minPec;}
\DoxyCodeLine{387                         \textcolor{keywordtype}{double} tau = 0.;}
\DoxyCodeLine{388                         \textcolor{keywordtype}{double} beta = h / 2. / vel * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}
\DoxyCodeLine{389                         \textcolor{comment}{//double Pe = vel * h / 2. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{390 }
\DoxyCodeLine{391                         \textcolor{keywordflow}{if} (Pe >= 1)}
\DoxyCodeLine{392                             tau = h / 2. / vel;}
\DoxyCodeLine{393                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{394                             tau = h * h / 12. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{395                             \textcolor{comment}{//tau = 0.;}}
\DoxyCodeLine{396                         \textcolor{comment}{//tau = 1e-\/7;}}
\DoxyCodeLine{397                         \textcolor{comment}{//std::cout << "{}tau Pe:\(\backslash\)t"{} << Pe << std::endl;}}
\DoxyCodeLine{398                         \textcolor{comment}{//std::cout << "{}tau vel:\(\backslash\)t"{} << vel << std::endl;}}
\DoxyCodeLine{399                         \textcolor{comment}{//std::cout << "{}tau h:\(\backslash\)t"{} << h << std::endl;}}
\DoxyCodeLine{400                         \textcolor{comment}{//std::cout << "{}tau:\(\backslash\)t"{} << tau << std::endl;}}
\DoxyCodeLine{401                         \textcolor{keyword}{auto} supg = tau * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p) * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{402                         \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);\textcolor{comment}{// + supg;}}
\DoxyCodeLine{403                     \};}
\DoxyCodeLine{404                     mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{405                     m\_RightMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{406                 \}}
\DoxyCodeLine{407             \}}
\DoxyCodeLine{408             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{409         \}}
\DoxyCodeLine{410 }
\DoxyCodeLine{411         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{412         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethodZero<Problem, Grid, Matrix>::AssembleSUPGMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l)}
\DoxyCodeLine{413         \{}
\DoxyCodeLine{414             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{415             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{416             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{417             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{418             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{419             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{420             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{421             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{422                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{423             \textcolor{keywordtype}{double} minPec = -\/1;}
\DoxyCodeLine{424             \textcolor{keyword}{auto} MM = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{425             \{}
\DoxyCodeLine{426                 \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{427                 \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{428                 \textcolor{comment}{//h = fabs(points[1].x -\/ points[0].x);}}
\DoxyCodeLine{429                 h = sqrt(h);}
\DoxyCodeLine{430                 \textcolor{comment}{//h = fabs(m\_Grid-\/>GetNode(0).x -\/ m\_Grid-\/>GetNode(1).x);}}
\DoxyCodeLine{431                 \textcolor{keywordtype}{double} Pe = vel * h / 2. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{432 }
\DoxyCodeLine{433                 \textcolor{comment}{//double Pe = vel * h / 2. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{434 }
\DoxyCodeLine{435                 \textcolor{keywordflow}{if} (Pe > minPec)}
\DoxyCodeLine{436                     minPec = Pe;}
\DoxyCodeLine{437                 \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{438             \};}
\DoxyCodeLine{439             elem-\/>Integrate(MM, points);}
\DoxyCodeLine{440             \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{441             \{}
\DoxyCodeLine{442                 \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{443                 \{}
\DoxyCodeLine{444                     \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{445                     \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{446                     \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{447                         \textcolor{keywordflow}{continue};}
\DoxyCodeLine{448                     \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{449                     \{}
\DoxyCodeLine{450                         \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{451                         \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{452                         h = sqrt(h);}
\DoxyCodeLine{453                         \textcolor{comment}{//h = fabs(points[1].x -\/ points[0].x);}}
\DoxyCodeLine{454                         \textcolor{comment}{//h = fabs(m\_Grid-\/>GetNode(0).x -\/ m\_Grid-\/>GetNode(1).x);}}
\DoxyCodeLine{455                         \textcolor{comment}{//h *= h;}}
\DoxyCodeLine{456                         \textcolor{comment}{//double Pe = vel * h / 6. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{457                         \textcolor{keywordtype}{double} tau = 0.;}
\DoxyCodeLine{458                         \textcolor{comment}{//double Pe = vel * h / 6. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{459                         \textcolor{keywordtype}{double} Pe = minPec;}
\DoxyCodeLine{460                         \textcolor{keywordtype}{double} beta = h / 2. / vel * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}
\DoxyCodeLine{461                         \textcolor{comment}{//double beta = h / std::sqrt(3.) * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{462                         \textcolor{comment}{//double beta = h / 2. * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{463                         \textcolor{comment}{//double beta = h / 2. * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{464                         \textcolor{comment}{//beta = 0.;}}
\DoxyCodeLine{465                         \textcolor{comment}{//for (int ii = 0; ii < (int)dofs; ++ii)}}
\DoxyCodeLine{466                             \textcolor{comment}{//beta += m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) * elem-\/>GetGradShapeFunction(ii, p);}}
\DoxyCodeLine{467                         \textcolor{comment}{//return beta * m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) *}}
\DoxyCodeLine{468                         \textcolor{comment}{//        elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}}
\DoxyCodeLine{469                         \textcolor{keywordflow}{if} (Pe >= 1)}
\DoxyCodeLine{470                             tau = h / 2. / vel;}
\DoxyCodeLine{471                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{472                             tau = h * h / 12. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{473                             \textcolor{comment}{//tau = 0;}}
\DoxyCodeLine{474                         \textcolor{comment}{//return 0.;}}
\DoxyCodeLine{475                         \textcolor{comment}{//tau = 1e-\/7;}}
\DoxyCodeLine{476                         \textcolor{comment}{//std::cout << "{}Stau Pe:\(\backslash\)t"{} << Pe << std::endl;}}
\DoxyCodeLine{477                         \textcolor{comment}{//std::cout << "{}Stau vel:\(\backslash\)t"{} << vel << std::endl;}}
\DoxyCodeLine{478                         \textcolor{comment}{//std::cout << "{}Stau h:\(\backslash\)t"{} << h << std::endl;}}
\DoxyCodeLine{479                         \textcolor{comment}{//std::cout << "{}Stau:\(\backslash\)t"{} << tau << std::endl;}}
\DoxyCodeLine{480                         \textcolor{keyword}{auto} ret = tau * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) *}
\DoxyCodeLine{481                                 elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{482                         \textcolor{comment}{//std::cout << ret << std::endl;}}
\DoxyCodeLine{483                         \textcolor{keywordflow}{return} ret;}
\DoxyCodeLine{484                     \};}
\DoxyCodeLine{485 }
\DoxyCodeLine{486                     \textcolor{comment}{//double tau =}}
\DoxyCodeLine{487                     \textcolor{keyword}{auto} \_mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{488                     m\_GlobalMatrix-\/>AddElement(inode, jnode, \_mij);}
\DoxyCodeLine{489                 \}}
\DoxyCodeLine{490             \}}
\DoxyCodeLine{491             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{492         \}}
\DoxyCodeLine{493 }
\DoxyCodeLine{494         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{495         \textcolor{keyword}{const} \textcolor{keywordtype}{int} FEMethodZero<Problem, Grid, Matrix>::AssembleLocalMatrix(\textcolor{keyword}{const} \textcolor{keywordtype}{int} l, \textcolor{keyword}{const} \textcolor{keywordtype}{int} old)}
\DoxyCodeLine{496         \{}
\DoxyCodeLine{497             \textcolor{keywordtype}{int} i, j, k, nodes;}
\DoxyCodeLine{498             \textcolor{keywordtype}{double} mij;}
\DoxyCodeLine{499             \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\{ m\_Grid-\/>GetElement(l) \};}
\DoxyCodeLine{500             \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\{ (int)elem-\/>GetDoFs() \};}
\DoxyCodeLine{501             \textcolor{keyword}{const} \textcolor{keywordtype}{int} terms\{ (int)m\_problem-\/>getNumberOfTerms() \};}
\DoxyCodeLine{502             nodes = elem-\/>GetNumberOfNodes();}
\DoxyCodeLine{503             std::vector<Mesh::Point> points(nodes);}
\DoxyCodeLine{504             \textcolor{keywordflow}{for} (i = 0; i < nodes; ++i)}
\DoxyCodeLine{505                 points[i] = m\_Grid-\/>GetNode(elem-\/>GetNode(i));}
\DoxyCodeLine{506             \textcolor{keywordflow}{for} (k = 0; k < terms; ++k)}
\DoxyCodeLine{507             \{}
\DoxyCodeLine{508                 \textcolor{keywordflow}{switch} (m\_problem-\/>getTerm(k))}
\DoxyCodeLine{509                 \{}
\DoxyCodeLine{510                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da511236cf0a2ae58312752c309767be64}{Terms::IUV}}:}
\DoxyCodeLine{511                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{512                     \{}
\DoxyCodeLine{513                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{514                         \{}
\DoxyCodeLine{515                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{516                             \{}
\DoxyCodeLine{517                                 \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da511236cf0a2ae58312752c309767be64}{Terms::IUV}}, l, elem-\/>GetType(), p) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{518                             \};}
\DoxyCodeLine{519                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{520                             \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{521                             \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{522                             \textcolor{keywordflow}{if} (inode > -\/1 \&\& jnode > -\/1)}
\DoxyCodeLine{523                                 m\_GlobalMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{524                         \}}
\DoxyCodeLine{525                     \}}
\DoxyCodeLine{526                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{527                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}:}
\DoxyCodeLine{528                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{529                     \{}
\DoxyCodeLine{530                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{531                         \{}
\DoxyCodeLine{532                             \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{533                             \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{534                             \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{535                                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{536                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{537                             \{}
\DoxyCodeLine{538                                 \textcolor{comment}{//auto m = elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}}
\DoxyCodeLine{539                                 \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p) * elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{540                             \};}
\DoxyCodeLine{541                             \textcolor{comment}{//mij = m\_Grid-\/>getParameter(Parameters::DIFFUSION, l, j) * elem-\/>Integrate(M, points);}}
\DoxyCodeLine{542                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{543                             m\_GlobalMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{544                         \}}
\DoxyCodeLine{545                     \}}
\DoxyCodeLine{546                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{547                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}:}
\DoxyCodeLine{548                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{549                     \{}
\DoxyCodeLine{550                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{551                         \{}
\DoxyCodeLine{552                             \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{553                             \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{554                             \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{555                                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{556                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{557                             \{}
\DoxyCodeLine{558                                 \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{559                             \};}
\DoxyCodeLine{560                             \textcolor{keyword}{auto} \_mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{561                             m\_GlobalMatrix-\/>AddElement(inode, jnode, \_mij);}
\DoxyCodeLine{562                         \}}
\DoxyCodeLine{563                     \}}
\DoxyCodeLine{564                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{565                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dab9a50fb352778c6273b307887dd2ba28}{Terms::IUDV}}:}
\DoxyCodeLine{566                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{567                     \{}
\DoxyCodeLine{568                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{569                         \{}
\DoxyCodeLine{570                             \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{571                             \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{572                             \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{573                                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{574                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{575                             \{}
\DoxyCodeLine{576                                 \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{577                             \};}
\DoxyCodeLine{578                             \textcolor{comment}{//mij = m\_CoarseGrid-\/>getParameter(Parameters::ADVECTION, l, j) * m\_flux(m\_CoarseGrid-\/>getSolution(l, j)) * elem-\/>Integrate(M, points).x;}}
\DoxyCodeLine{579                             mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{580                             m\_GlobalMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{581                         \}}
\DoxyCodeLine{582                     \}}
\DoxyCodeLine{583                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{584                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da601d1ecfe8543b457d918d636d84cc9d}{Terms::EUV}}:}
\DoxyCodeLine{585                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{586                     \{}
\DoxyCodeLine{587                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{588                         \{}
\DoxyCodeLine{589                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{590                             \{}
\DoxyCodeLine{591                                 \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{592                             \};}
\DoxyCodeLine{593                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{594                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02facb6c2c4b3c8f95f9b58ad13f0a97245d}{Parameters::MASS}}, l, j) * m\_Grid-\/>getSolution(l, j) * mij;}
\DoxyCodeLine{595                             \textcolor{comment}{//m\_rhsvector-\/>operator[](m\_nums[l] + i) += m\_CoarseGrid-\/>getParameter(Parameters::MASS, l, points[j]) * elem-\/>GetValue(j) * mij;}}
\DoxyCodeLine{596                         \}}
\DoxyCodeLine{597                     \}}
\DoxyCodeLine{598                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{599                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dac74248d6b3ec20c4b6969c4e520b09ca}{Terms::EDUDV}}:}
\DoxyCodeLine{600                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{601                     \{}
\DoxyCodeLine{602                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{603                         \{}
\DoxyCodeLine{604                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{605                             \{}
\DoxyCodeLine{606                                 \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{607                             \};}
\DoxyCodeLine{608                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{609                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02fac9f4e4b1345e4e958a307bf67ae358a7}{Parameters::DIFFUSION}}, l, j) * m\_Grid-\/>getSolution(l, j) * mij;}
\DoxyCodeLine{610                         \}}
\DoxyCodeLine{611                     \}}
\DoxyCodeLine{612                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{613                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7daa7a21a5469737f2aa8b257cce9aa27e3}{Terms::EDUV}}:}
\DoxyCodeLine{614                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{615                     \{}
\DoxyCodeLine{616                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{617                         \{}
\DoxyCodeLine{618                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{619                             \{}
\DoxyCodeLine{620                                 \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{621                             \};}
\DoxyCodeLine{622                             mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{623                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02fa21d5412bbfc0a49ed5cb827c133bb3fb}{Parameters::ADVECTION}}, l, j) * mij;}
\DoxyCodeLine{624                         \}}
\DoxyCodeLine{625                     \}}
\DoxyCodeLine{626                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{627                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da38f852dce31a67414f478b5626a4d118}{Terms::EUDV}}:}
\DoxyCodeLine{628                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{629                     \{}
\DoxyCodeLine{630                         \textcolor{keywordflow}{for} (j = 0; j < dofs; ++j)}
\DoxyCodeLine{631                         \{}
\DoxyCodeLine{632                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{633                             \{}
\DoxyCodeLine{634                                 \textcolor{keywordflow}{return} elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{635                             \};}
\DoxyCodeLine{636                             mij = elem-\/>Integrate(M, points).x;}
\DoxyCodeLine{637                             m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += m\_Grid-\/>getParameter(\mbox{\hyperlink{namespacecorenc_a2902da21a64b0735c94fc4e59e25b02fa21d5412bbfc0a49ed5cb827c133bb3fb}{Parameters::ADVECTION}}, l, j) * mij;\textcolor{comment}{// *mij;}}
\DoxyCodeLine{638                         \}}
\DoxyCodeLine{639                     \}}
\DoxyCodeLine{640                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{641                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da4a56e919ee256e21151e6df79babae35}{Terms::EFV}}:}
\DoxyCodeLine{642                     \textcolor{keywordflow}{for} (i = 0; i < dofs; ++i)}
\DoxyCodeLine{643                     \{}
\DoxyCodeLine{644                         \textcolor{comment}{/*for (j = 0; j < dofs; ++j)}}
\DoxyCodeLine{645 \textcolor{comment}{                        \{}}
\DoxyCodeLine{646 \textcolor{comment}{                            auto M = [\&](const Mesh::Point\& p)}}
\DoxyCodeLine{647 \textcolor{comment}{                            \{}}
\DoxyCodeLine{648 \textcolor{comment}{                                return m\_problem-\/>get\_parameter(Terms::EFV, elem-\/>GetType(), l, j, p) * elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}}
\DoxyCodeLine{649 \textcolor{comment}{                            \};}}
\DoxyCodeLine{650 \textcolor{comment}{                            mij = elem-\/>Integrate(M, points);}}
\DoxyCodeLine{651 \textcolor{comment}{                            m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += mij;}}
\DoxyCodeLine{652 \textcolor{comment}{                        \}*/}}
\DoxyCodeLine{653                         \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{654                         \{}
\DoxyCodeLine{655                             \textcolor{keywordflow}{return} m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da4a56e919ee256e21151e6df79babae35}{Terms::EFV}}, elem-\/>GetType(), l, i, p) * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{656                         \};}
\DoxyCodeLine{657                         mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{658                         m\_rhsvector-\/>operator[](elem-\/>GetNode(i)) += mij;}
\DoxyCodeLine{659                     \}}
\DoxyCodeLine{660                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{661                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}:}
\DoxyCodeLine{662                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{663                     \{}
\DoxyCodeLine{664                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{665                         \{}
\DoxyCodeLine{666                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{667                             \{}
\DoxyCodeLine{668                                 \textcolor{keywordflow}{return} elem-\/>GetShapeFunction(i, p) * elem-\/>GetShapeFunction(j, p);}
\DoxyCodeLine{669                             \};}
\DoxyCodeLine{670                             mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{671                             \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{672                             \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{673                             \textcolor{keywordflow}{if} (inode > -\/1 \&\& jnode > -\/1)}
\DoxyCodeLine{674                                 m\_RightMatrix-\/>AddElement(inode, jnode, mij);}
\DoxyCodeLine{675                         \}}
\DoxyCodeLine{676                     \}}
\DoxyCodeLine{677                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{678                 \textcolor{keywordflow}{case} \mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da9aa23ab26cb4db3b1e10a668eff580f2}{Terms::SUPG}}:}
\DoxyCodeLine{679                     \textcolor{keywordflow}{for} (i = 0; i < (int)dofs; ++i)}
\DoxyCodeLine{680                     \{}
\DoxyCodeLine{681                         \textcolor{keywordflow}{for} (j = 0; j < (int)dofs; ++j)}
\DoxyCodeLine{682                         \{}
\DoxyCodeLine{683                             \textcolor{keyword}{auto} inode = m\_Grid-\/>interpolate(elem-\/>GetNode(i));}
\DoxyCodeLine{684                             \textcolor{keyword}{auto} jnode = m\_Grid-\/>interpolate(elem-\/>GetNode(j));}
\DoxyCodeLine{685                             \textcolor{keywordflow}{if} (inode == -\/1 || jnode == -\/1)}
\DoxyCodeLine{686                                 \textcolor{keywordflow}{continue};}
\DoxyCodeLine{687                             \textcolor{keyword}{auto} M = [\&](\textcolor{keyword}{const} Mesh::Point\& p)}
\DoxyCodeLine{688                             \{}
\DoxyCodeLine{689                                 \textcolor{keywordtype}{double} vel = sqrt(m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0));}
\DoxyCodeLine{690                                 \textcolor{keywordtype}{double} h = elem-\/>GetMeasure();}
\DoxyCodeLine{691                                 \textcolor{comment}{//double Pe = vel * h / 6. / m\_problem-\/>get\_parameter(Terms::IDUDV, l, elem-\/>GetType(), p);}}
\DoxyCodeLine{692                                 \textcolor{keywordtype}{double} tau = 0.;}
\DoxyCodeLine{693                                 \textcolor{keywordtype}{double} Pe = vel * h / 2. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{694                                 \textcolor{comment}{//double beta = h / 2. / vel * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{695                                 \textcolor{keywordtype}{double} beta = h / std::sqrt(3.) * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}
\DoxyCodeLine{696                                 \textcolor{comment}{//double beta = h / 2. * ((exp(2. * Pe) + 1.) / (exp(2. * Pe) -\/ 1.) -\/ 1. / Pe);}}
\DoxyCodeLine{697                                 \textcolor{comment}{//beta = 0.;}}
\DoxyCodeLine{698                                 \textcolor{comment}{//for (int ii = 0; ii < (int)dofs; ++ii)}}
\DoxyCodeLine{699                                     \textcolor{comment}{//beta += m\_problem-\/>get\_parameter(Terms::IDUV, l, elem-\/>GetType(), p, 0) * elem-\/>GetGradShapeFunction(ii, p);}}
\DoxyCodeLine{700                                 \textcolor{keywordflow}{return} beta * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) *}
\DoxyCodeLine{701                                         elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{702                                 \textcolor{keywordflow}{if} (Pe >= 1)}
\DoxyCodeLine{703                                     tau = h / 2. / vel;}
\DoxyCodeLine{704                                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{705                                     tau = h * h / 12. / m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6700bf7165821afe98b24ac1b0966758}{Terms::IDUDV}}, l, elem-\/>GetType(), p);}
\DoxyCodeLine{706                                 \textcolor{comment}{//return 0.;}}
\DoxyCodeLine{707                                 \textcolor{keywordflow}{return} tau * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) * m\_problem-\/>get\_parameter(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da6cbf1e7c8586e0d3a65915638e2ae293}{Terms::IDUV}}, l, elem-\/>GetType(), p, 0) *}
\DoxyCodeLine{708                                         elem-\/>GetGradShapeFunction(i, p) * elem-\/>GetGradShapeFunction(j, p);}
\DoxyCodeLine{709                             \};}
\DoxyCodeLine{710 }
\DoxyCodeLine{711                             \textcolor{comment}{//double tau =}}
\DoxyCodeLine{712                             \textcolor{keyword}{auto} \_mij = elem-\/>Integrate(M, points);}
\DoxyCodeLine{713                             m\_GlobalMatrix-\/>AddElement(inode, jnode, \_mij);}
\DoxyCodeLine{714                         \}}
\DoxyCodeLine{715                     \}}
\DoxyCodeLine{716                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{717                 \textcolor{keywordflow}{default}:}
\DoxyCodeLine{718                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{719                 \}}
\DoxyCodeLine{720             \}}
\DoxyCodeLine{721             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{722         \}}
\DoxyCodeLine{723         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{724         \textcolor{keywordtype}{void} FEMethodZero<Problem, Grid, Matrix>::MainConditions()}
\DoxyCodeLine{725         \{}
\DoxyCodeLine{726             \textcolor{keywordtype}{double} mu\{ 1e10 \};}
\DoxyCodeLine{727             \textcolor{keyword}{const} \textcolor{keyword}{auto} n = m\_problem-\/>get\_number\_of\_boundaries();}
\DoxyCodeLine{728             \textcolor{keyword}{const} \textcolor{keyword}{auto} m = m\_Grid-\/>GetNumberOfBoundaries();}
\DoxyCodeLine{729             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{730             \{}
\DoxyCodeLine{731                 \textcolor{keyword}{const} \textcolor{keyword}{auto}\& type = m\_problem-\/>get\_boundary\_type(i);}
\DoxyCodeLine{732                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < m; ++j)}
\DoxyCodeLine{733                 \{}
\DoxyCodeLine{734                     \textcolor{keyword}{const} \textcolor{keyword}{auto}\& row = m\_Grid-\/>GetBoundary(j);}
\DoxyCodeLine{735                     \textcolor{keywordflow}{if} (row-\/>GetType() == type)}
\DoxyCodeLine{736                     \{}
\DoxyCodeLine{737                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs = (int)row-\/>GetDoFs();}
\DoxyCodeLine{738                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs2 = 2;}
\DoxyCodeLine{739                         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem\_num = row-\/>GetNeighbour(0);}
\DoxyCodeLine{740                         \textcolor{keyword}{const} \textcolor{keyword}{auto}\& elem = m\_Grid-\/>GetElement(elem\_num);}
\DoxyCodeLine{741                         \textcolor{keyword}{const} \textcolor{keywordtype}{int} dofs\_elem = elem-\/>GetDoFs();}
\DoxyCodeLine{742                         std::vector<Mesh::Point> points(dofs\_elem);}
\DoxyCodeLine{743                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < dofs\_elem; ++k)}
\DoxyCodeLine{744                             points[k] = m\_Grid-\/>GetNode(elem-\/>GetNode(k));}
\DoxyCodeLine{745                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < dofs; ++k)}
\DoxyCodeLine{746                         \{}
\DoxyCodeLine{747                             \textcolor{keywordtype}{int} l = 0;}
\DoxyCodeLine{748                             \textcolor{keywordflow}{for} (; l < dofs\_elem; ++l)}
\DoxyCodeLine{749                             \{}
\DoxyCodeLine{750                                 \textcolor{keywordflow}{if} (elem-\/>GetNode(l) == row-\/>GetNode(k))}
\DoxyCodeLine{751                                     \textcolor{keywordflow}{break};}
\DoxyCodeLine{752                             \}}
\DoxyCodeLine{753                             m\_GlobalMatrix-\/>NullRow(row-\/>GetNode(k));}
\DoxyCodeLine{754                             \textcolor{comment}{//m\_GlobalMatrix-\/>operator()(row-\/>GetNode(k), row-\/>GetNode(k)) *= mu;}}
\DoxyCodeLine{755                             \textcolor{comment}{//m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = m\_problem-\/>get\_boundary\_parameter(0, type, m\_Grid-\/>GetNode(row-\/>GetNode(k)));}}
\DoxyCodeLine{756                             \textcolor{comment}{//m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = m\_problem-\/>get\_boundary\_parameter(0, type, elem\_num, l, m\_Grid-\/>GetNode(row-\/>GetNode(k)));}}
\DoxyCodeLine{757                             m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = elem-\/>GetWeight(l, points, [=](\textcolor{keyword}{const} Mesh::Point\& p) \{ \textcolor{keywordflow}{return} m\_problem-\/>get\_boundary\_parameter(0, type, p); \});}
\DoxyCodeLine{758                             \textcolor{keywordflow}{if}(m\_problem-\/>findTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7dad3b7f41b5ee98737009f90516d82fd4c}{Terms::RUV}}))}
\DoxyCodeLine{759                                 \{}
\DoxyCodeLine{760                                     m\_RightMatrix-\/>NullRow(row-\/>GetNode(k));}
\DoxyCodeLine{761                                     \textcolor{comment}{//m\_RightMatrix-\/>operator()(row-\/>GetNode(k), row-\/>GetNode(k)) *= mu;}}
\DoxyCodeLine{762                                 \}}
\DoxyCodeLine{763                         \}}
\DoxyCodeLine{764                         \textcolor{comment}{/*for (int k = dofs2; k < dofs; ++k)}}
\DoxyCodeLine{765 \textcolor{comment}{                        \{}}
\DoxyCodeLine{766 \textcolor{comment}{                            m\_GlobalMatrix-\/>NullRow(row-\/>GetNode(k));}}
\DoxyCodeLine{767 \textcolor{comment}{                            m\_rhsvector-\/>operator[](row-\/>GetNode(k)) = 0;}}
\DoxyCodeLine{768 \textcolor{comment}{                        \}*/}}
\DoxyCodeLine{769                     \}}
\DoxyCodeLine{770                 \}}
\DoxyCodeLine{771             \}}
\DoxyCodeLine{772             \textcolor{comment}{/*for (auto bnd : m\_Grid-\/>GetBoundaryConditions())}}
\DoxyCodeLine{773 \textcolor{comment}{            \{}}
\DoxyCodeLine{774 \textcolor{comment}{                if (get<0>(bnd.second) == 1)}}
\DoxyCodeLine{775 \textcolor{comment}{                    for (auto row : m\_Grid-\/>GetBoundary())}}
\DoxyCodeLine{776 \textcolor{comment}{                    \{}}
\DoxyCodeLine{777 \textcolor{comment}{                        if (bnd.first == row-\/>GetType())}}
\DoxyCodeLine{778 \textcolor{comment}{                        \{}}
\DoxyCodeLine{779 \textcolor{comment}{                            for (int i = 0; i < row-\/>GetDoF(); ++i)}}
\DoxyCodeLine{780 \textcolor{comment}{                            \{}}
\DoxyCodeLine{781 \textcolor{comment}{                                m\_GlobalMatrix-\/>NullRow(row-\/>GetNodes(i));}}
\DoxyCodeLine{782 \textcolor{comment}{                                m\_rhsvector[row-\/>GetNodes(i)] = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{783 \textcolor{comment}{                            \}}}
\DoxyCodeLine{784 \textcolor{comment}{                        \}}}
\DoxyCodeLine{785 \textcolor{comment}{                    \}}}
\DoxyCodeLine{786 \textcolor{comment}{            \}*/}}
\DoxyCodeLine{787         \}}
\DoxyCodeLine{788         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{789         \textcolor{keywordtype}{void} FEMethodZero<Problem, Grid, Matrix>::SecondConditions()}
\DoxyCodeLine{790         \{}
\DoxyCodeLine{791             \textcolor{keywordtype}{double} theta = 0;}
\DoxyCodeLine{792             \textcolor{keywordtype}{int} nfem;}
\DoxyCodeLine{793             Mesh::Point temp[3];}
\DoxyCodeLine{794             std::vector<int> local;}
\DoxyCodeLine{795             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{796             \{}
\DoxyCodeLine{797                 \textcolor{comment}{//if (get<0>(bnd.second) == 2)}}
\DoxyCodeLine{798                 \{}
\DoxyCodeLine{799                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{800                     \{}
\DoxyCodeLine{801                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{802                         \{}
\DoxyCodeLine{803                             local.resize(0);}
\DoxyCodeLine{804                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{805                             nfem = row-\/>GetNumberOfElement(0);}
\DoxyCodeLine{806                             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{807                             \textcolor{comment}{//auto GetBasis = [\&](int t, Point p)\{return elem-\/>GetBasis(t, p); \};}}
\DoxyCodeLine{808                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{809                             \{}
\DoxyCodeLine{810                                 temp[j] = m\_Grid-\/>GetNodes()[row-\/>GetNodes(j)];}
\DoxyCodeLine{811                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{812                                 \{}
\DoxyCodeLine{813                                     \textcolor{keywordflow}{if} (row-\/>GetNodes(j) == elem-\/>GetNodes()[i])}
\DoxyCodeLine{814                                     \{}
\DoxyCodeLine{815                                         local.push\_back(i);}
\DoxyCodeLine{816                                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{817                                     \}}
\DoxyCodeLine{818                                 \}}
\DoxyCodeLine{819                             \}}
\DoxyCodeLine{820                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{821                             \{}
\DoxyCodeLine{822                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{823                                 \{}
\DoxyCodeLine{824                                     \textcolor{comment}{//theta = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{825                                     theta = 0;}
\DoxyCodeLine{826                                     \textcolor{keyword}{auto} GetMass = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} elem-\/>GetBasis(local[j], p) * elem-\/>GetBasis(local[i], p); \};}
\DoxyCodeLine{827                                     \textcolor{keyword}{auto} GetBBasis = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} row-\/>GetBasis(j, p)*row-\/>GetBasis(i, p); \};}
\DoxyCodeLine{828                                     \textcolor{comment}{//if (i < 2 || j < 2)}}
\DoxyCodeLine{829                                     m\_rhsvector[row-\/>GetNodes(i)] += theta * row-\/>Integrate(GetMass, temp);}
\DoxyCodeLine{830 }
\DoxyCodeLine{831                                     \textcolor{comment}{//if (i < 3 || j < 3)}}
\DoxyCodeLine{832                                     \textcolor{comment}{//  m\_rhsvector[row[i + 1]] += theta * row-\/>Integrate(GetBBasis, temp);}}
\DoxyCodeLine{833                                 \}}
\DoxyCodeLine{834                             \}}
\DoxyCodeLine{835                         \}}
\DoxyCodeLine{836                     \}}
\DoxyCodeLine{837                 \}}
\DoxyCodeLine{838             \}}
\DoxyCodeLine{839         \}}
\DoxyCodeLine{840         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{841         \textcolor{keywordtype}{void} FEMethodZero<Problem, Grid, Matrix>::StefanConditions()}
\DoxyCodeLine{842         \{}
\DoxyCodeLine{843             \textcolor{keywordtype}{double} dest\{ 0. \}, lat\{ 0 \};}
\DoxyCodeLine{844             \textcolor{keywordtype}{int} nfem;}
\DoxyCodeLine{845             Mesh::Point temp[3];}
\DoxyCodeLine{846             std::vector<int> local;}
\DoxyCodeLine{847             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{848             \{}
\DoxyCodeLine{849                 \textcolor{comment}{//if (get<0>(bnd.second) == 4)}}
\DoxyCodeLine{850                 \{}
\DoxyCodeLine{851                     lat = 0;}
\DoxyCodeLine{852                     \textcolor{comment}{//lat = get<2>(bnd.second);}}
\DoxyCodeLine{853                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{854                     \{}
\DoxyCodeLine{855                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{856                         \{}
\DoxyCodeLine{857                             local.resize(0);}
\DoxyCodeLine{858                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{859                             nfem = row-\/>GetNumberOfElement(0);}
\DoxyCodeLine{860                             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{861                             \textcolor{comment}{//auto GetBasis = [\&](int t, Point p)\{return elem-\/>GetBasis(t, p); \};}}
\DoxyCodeLine{862                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{863                             \{}
\DoxyCodeLine{864                                 temp[j] = m\_Grid-\/>GetNodes()[row-\/>GetNodes(j)];}
\DoxyCodeLine{865                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{866                                 \{}
\DoxyCodeLine{867                                     \textcolor{keywordflow}{if} (row-\/>GetNodes(j) == elem-\/>GetNodes()[i])}
\DoxyCodeLine{868                                     \{}
\DoxyCodeLine{869                                         local.push\_back(i);}
\DoxyCodeLine{870                                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{871                                     \}}
\DoxyCodeLine{872                                 \}}
\DoxyCodeLine{873                             \}}
\DoxyCodeLine{874                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{875                             \{}
\DoxyCodeLine{876                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{877                                 \{}
\DoxyCodeLine{878                                     dest = 0;}
\DoxyCodeLine{879                                     \textcolor{comment}{//dest = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{880                                     \textcolor{keyword}{auto} GetBBasis = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} row-\/>GetBasis(j, p)*row-\/>GetBasis(i, p); \};}
\DoxyCodeLine{881                                     \textcolor{comment}{//if (i < 2 || j < 2)}}
\DoxyCodeLine{882                                     m\_rhsvector[row-\/>GetNodes(i)] += dest * lat * row-\/>Integrate(GetBBasis, temp);}
\DoxyCodeLine{883 }
\DoxyCodeLine{884                                     \textcolor{comment}{//if (i < 3 || j < 3)}}
\DoxyCodeLine{885                                     \textcolor{comment}{//  m\_rhsvector[row[i + 1]] += theta * row-\/>Integrate(GetBBasis, temp);}}
\DoxyCodeLine{886                                 \}}
\DoxyCodeLine{887                             \}}
\DoxyCodeLine{888                         \}}
\DoxyCodeLine{889                     \}}
\DoxyCodeLine{890                 \}}
\DoxyCodeLine{891             \}}
\DoxyCodeLine{892         \}}
\DoxyCodeLine{893         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{894         \textcolor{keywordtype}{void} FEMethodZero<Problem, Grid, Matrix>::ThirdConditions()}
\DoxyCodeLine{895         \{}
\DoxyCodeLine{896             \textcolor{keywordtype}{double} param\{ 0 \}, beta\{ 0 \};}
\DoxyCodeLine{897             \textcolor{keywordtype}{int} nfem;}
\DoxyCodeLine{898             Mesh::Point temp[6];}
\DoxyCodeLine{899             std::vector<int> local;}
\DoxyCodeLine{900             \textcolor{keyword}{auto} fxy = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} (10 * p.y*m\_time + m\_time) / 10; \};}
\DoxyCodeLine{901             \textcolor{comment}{//auto fxy = [\&](const Point\& p)\{return 10 * p.y + 10 * m\_time; \};}}
\DoxyCodeLine{902             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{903             \{}
\DoxyCodeLine{904                 \textcolor{comment}{//if (get<0>(bnd.second) == 3)}}
\DoxyCodeLine{905                 \{}
\DoxyCodeLine{906 }
\DoxyCodeLine{907                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{908                     \{}
\DoxyCodeLine{909                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{910                         \{}
\DoxyCodeLine{911                             local.resize(0);}
\DoxyCodeLine{912                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{913                             nfem = row-\/>GetNumberOfElement(0);}
\DoxyCodeLine{914                             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{915                             \textcolor{comment}{//auto GetBasis = [\&](int t, Point p)\{return elem-\/>GetBasis(t, p); \};}}
\DoxyCodeLine{916                             \textcolor{keyword}{auto} order = elem-\/>GetDoF();}
\DoxyCodeLine{917                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{918                             \{}
\DoxyCodeLine{919                                 temp[j] = m\_Grid-\/>GetNodes()[row-\/>GetNodes(j)];}
\DoxyCodeLine{920                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < order; ++i)}
\DoxyCodeLine{921                                 \{}
\DoxyCodeLine{922                                     \textcolor{keywordflow}{if} (row-\/>GetNodes(j) == elem-\/>GetNodes()[i])}
\DoxyCodeLine{923                                     \{}
\DoxyCodeLine{924                                         local.push\_back(i);}
\DoxyCodeLine{925                                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{926                                     \}}
\DoxyCodeLine{927                                 \}}
\DoxyCodeLine{928                             \}}
\DoxyCodeLine{929                             \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{930                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{931                             \{}
\DoxyCodeLine{932                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < dofs; ++j)}
\DoxyCodeLine{933                                 \{}
\DoxyCodeLine{934                                     param = 0;}
\DoxyCodeLine{935                                     beta = 0;}
\DoxyCodeLine{936                                     \textcolor{comment}{//beta = get<2>(bnd.second);}}
\DoxyCodeLine{937                                     \textcolor{comment}{//param = get<1>(bnd.second)(m\_Grid-\/>GetNodes()[row-\/>GetNodes(i)]);}}
\DoxyCodeLine{938                                     \textcolor{comment}{//param = fxy(temp[j]);}}
\DoxyCodeLine{939                                     \textcolor{keyword}{auto} GetBBasis = [\&](\textcolor{keyword}{const} Mesh::Point\& p) \{\textcolor{keywordflow}{return} elem-\/>GetBasis(local[j], p)*elem-\/>GetBasis(local[i], p); \};}
\DoxyCodeLine{940                                     \textcolor{comment}{//val = row-\/>GetElement(GetBBasis, temp);}}
\DoxyCodeLine{941                                     val = row-\/>Integrate(GetBBasis, temp);}
\DoxyCodeLine{942                                     m\_GlobalMatrix-\/>operator()(row-\/>GetNodes(i), row-\/>GetNodes(j)) += beta * val;}
\DoxyCodeLine{943                                     m\_rhsvector[row-\/>GetNodes(i)] += beta * param * val;}
\DoxyCodeLine{944                                 \}}
\DoxyCodeLine{945                             \}}
\DoxyCodeLine{946                         \}}
\DoxyCodeLine{947                     \}}
\DoxyCodeLine{948                 \}}
\DoxyCodeLine{949             \}}
\DoxyCodeLine{950         \}}
\DoxyCodeLine{951         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{952         Matrix* \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_ad595adcc3935cad9c15f7c013a64ff67}{FEMethodZero<Problem, Grid, Matrix>::GetGlobalMatrix}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{953 \textcolor{keyword}{        }\{}
\DoxyCodeLine{954             \textcolor{keywordflow}{return} m\_GlobalMatrix;}
\DoxyCodeLine{955         \}}
\DoxyCodeLine{956         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{957         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{FEMethodZero<Problem, Grid, Matrix>::GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)\textcolor{keyword}{ const}}
\DoxyCodeLine{958 \textcolor{keyword}{        }\{}
\DoxyCodeLine{959             \textcolor{keywordflow}{if} (!m\_solution.size())}
\DoxyCodeLine{960                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{961             \textcolor{keywordtype}{double} val = 0;}
\DoxyCodeLine{962             \textcolor{keywordtype}{int} nfem = -\/1;}
\DoxyCodeLine{963             nfem = m\_Grid-\/>FindElement(p);}
\DoxyCodeLine{964             \textcolor{keywordflow}{if} (nfem == -\/1)}
\DoxyCodeLine{965                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{966             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{967             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{968                 val += m\_solution[elem-\/>GetNodes()[i]] * elem-\/>GetBasis(i, p);}
\DoxyCodeLine{969             \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{970         \}}
\DoxyCodeLine{971         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{972         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{FEMethodZero<Problem, Grid, Matrix>::GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} std::vector<double>\& vec)\textcolor{keyword}{ const}}
\DoxyCodeLine{973 \textcolor{keyword}{        }\{}
\DoxyCodeLine{974             \textcolor{keywordflow}{if} (!vec.size())}
\DoxyCodeLine{975                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{976             \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{977             \textcolor{keywordtype}{int} nfem\{ -\/1 \};}
\DoxyCodeLine{978             nfem = m\_Grid-\/>FindElement(p);}
\DoxyCodeLine{979             \textcolor{keywordflow}{if} (nfem == -\/1)}
\DoxyCodeLine{980                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{981             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[nfem];}
\DoxyCodeLine{982             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoFs(); ++i)}
\DoxyCodeLine{983                 val += vec[elem-\/>GetNode(i)] * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{984             \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{985         \}}
\DoxyCodeLine{986         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{987         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adbab15f62e549adf53466fb03913b71b}{FEMethodZero<Problem, Grid, Matrix>::GetValue}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} std::vector<double>\& vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int} num)\textcolor{keyword}{ const}}
\DoxyCodeLine{988 \textcolor{keyword}{        }\{}
\DoxyCodeLine{989             \textcolor{keywordflow}{if} (!vec.size() || num < 0)}
\DoxyCodeLine{990                 \textcolor{keywordflow}{return} -\/1;}
\DoxyCodeLine{991             \textcolor{keywordtype}{double} val\{ 0 \};}
\DoxyCodeLine{992             \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[num];}
\DoxyCodeLine{993             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < elem-\/>GetDoF(); ++i)}
\DoxyCodeLine{994                 val += vec[elem-\/>GetNodes()[i]] * elem-\/>GetBasis(i, p);}
\DoxyCodeLine{995             \textcolor{keywordflow}{return} val;}
\DoxyCodeLine{996         \}}
\DoxyCodeLine{997         \textcolor{comment}{//template<class Problem, class Grid, class Matrix>}}
\DoxyCodeLine{998         \textcolor{comment}{//const Mesh::Point FEMethodZero<Problem, Grid, Matrix>::GetGradValue(const Mesh::Point\& p, const std::vector<double>\& vec) const}}
\DoxyCodeLine{999         \textcolor{comment}{//\{}}
\DoxyCodeLine{1000         \textcolor{comment}{//  Mesh::Point val\{ 0, 0 \};}}
\DoxyCodeLine{1001         \textcolor{comment}{//  int nfem\{ -\/1 \};}}
\DoxyCodeLine{1002         \textcolor{comment}{//  nfem = m\_Grid-\/>FindElement(p);}}
\DoxyCodeLine{1003         \textcolor{comment}{//  if (nfem == -\/1)}}
\DoxyCodeLine{1004         \textcolor{comment}{//      return val;}}
\DoxyCodeLine{1005         \textcolor{comment}{//  auto elem = m\_Grid-\/>GetElements()[nfem];}}
\DoxyCodeLine{1006         \textcolor{comment}{//  for (int i = 0; i < elem-\/>GetDoF(); ++i)}}
\DoxyCodeLine{1007         \textcolor{comment}{//  \{}}
\DoxyCodeLine{1008         \textcolor{comment}{//      val.x += vec[elem-\/>GetNodes()[i]] * elem-\/>GetGradBasis(i, p).x;}}
\DoxyCodeLine{1009         \textcolor{comment}{//      val.y += vec[elem-\/>GetNodes()[i]] * elem-\/>GetGradBasis(i, p).y;}}
\DoxyCodeLine{1010         \textcolor{comment}{//      val.z += vec[elem-\/>GetNodes()[i]] * elem-\/>GetGradBasis(i, p).z;}}
\DoxyCodeLine{1011         \textcolor{comment}{//  \}}}
\DoxyCodeLine{1012         \textcolor{comment}{//  return val;}}
\DoxyCodeLine{1013         \textcolor{comment}{//\}}}
\DoxyCodeLine{1014         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1015         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a1ee73cbde17b79365c4fce9d67991a22}{FEMethodZero<Problem, Grid, Matrix>::GetEffective}}(\textcolor{keyword}{const} std::vector<double>\& vec)\textcolor{keyword}{ const}}
\DoxyCodeLine{1016 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1017             \textcolor{keywordtype}{double} sum = 0;}
\DoxyCodeLine{1018             \textcolor{comment}{//std::vector<int> dofs;}}
\DoxyCodeLine{1019             \textcolor{comment}{//Mesh::Point points[10];}}
\DoxyCodeLine{1020             \textcolor{comment}{//for (int i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}}
\DoxyCodeLine{1021             \textcolor{comment}{//\{}}
\DoxyCodeLine{1022                 \textcolor{comment}{//auto mb = [\&](const Mesh::Point\& b) \{return GetGradValue(b, vec)*GetGradValue(b, vec); \};}}
\DoxyCodeLine{1023                 \textcolor{comment}{//dofs.resize(0);}}
\DoxyCodeLine{1024                 \textcolor{comment}{//auto elem = m\_Grid-\/>GetElements()[i];}}
\DoxyCodeLine{1025                 \textcolor{comment}{//int order = elem-\/>GetDoF();}}
\DoxyCodeLine{1026                 \textcolor{comment}{//double diff = std::get<0>(m\_Grid-\/>GetDiffusion().find(elem-\/>GetType())-\/>second);}}
\DoxyCodeLine{1027                 \textcolor{comment}{//for (int j = 0; j < order; ++j)}}
\DoxyCodeLine{1028                 \textcolor{comment}{//\{}}
\DoxyCodeLine{1029                     \textcolor{comment}{//dofs.push\_back(elem-\/>GetNodes()[j]);}}
\DoxyCodeLine{1030                     \textcolor{comment}{//points[j] = m\_Grid-\/>GetNodes()[dofs[j]];}}
\DoxyCodeLine{1031                 \textcolor{comment}{//\}}}
\DoxyCodeLine{1032                 \textcolor{comment}{//sum += diff * elem-\/>Integrate(mb, points);}}
\DoxyCodeLine{1033             \textcolor{comment}{//\}}}
\DoxyCodeLine{1034             \textcolor{comment}{//std::cout << "{}Effect (local): "{} << sum << std::endl;}}
\DoxyCodeLine{1035             \textcolor{comment}{//std::cout << "{}Effect (local) sqrt: "{} << sqrt(sum) << std::endl;}}
\DoxyCodeLine{1036             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{1037         \}}
\DoxyCodeLine{1038         \textcolor{comment}{//template<class Problem, class Grid, class Matrix>}}
\DoxyCodeLine{1039         \textcolor{comment}{//const Mesh::Point FEMethodZero<Problem, Grid, Matrix>::GetLambdaGrad(const Mesh::Point\& p, const std::vector<double>\& vec) const}}
\DoxyCodeLine{1040         \textcolor{comment}{//\{}}
\DoxyCodeLine{1041         \textcolor{comment}{//  Mesh::Point val\{ 0, 0, 0 \};}}
\DoxyCodeLine{1042         \textcolor{comment}{//  //double val\{ 0 \};}}
\DoxyCodeLine{1043         \textcolor{comment}{//  double diff\{ 0 \};}}
\DoxyCodeLine{1044         \textcolor{comment}{//  Mesh::Point temp\{ 0, 0, 0 \};}}
\DoxyCodeLine{1045         \textcolor{comment}{//  int nfem\{ -\/1 \};}}
\DoxyCodeLine{1046         \textcolor{comment}{//  nfem = m\_Grid-\/>FindElement(p);}}
\DoxyCodeLine{1047         \textcolor{comment}{//  if (nfem == -\/1)}}
\DoxyCodeLine{1048         \textcolor{comment}{//      return val;}}
\DoxyCodeLine{1049         \textcolor{comment}{//  auto elem = m\_Grid-\/>GetElements()[nfem];}}
\DoxyCodeLine{1050         \textcolor{comment}{//  diff = std::get<0>(m\_Grid-\/>GetDiffusion().find(elem-\/>GetType())-\/>second);}}
\DoxyCodeLine{1051         \textcolor{comment}{//  for (int i = 0; i < elem-\/>GetDoF(); ++i)}}
\DoxyCodeLine{1052         \textcolor{comment}{//  \{}}
\DoxyCodeLine{1053         \textcolor{comment}{//      //val += elem-\/>GetGradBasis(i, p) * elem-\/>GetGradBasis(i, p) * vec[elem-\/>GetNodes()[i]] * vec[elem-\/>GetNodes()[i]] * diff;}}
\DoxyCodeLine{1054         \textcolor{comment}{//      //val += elem-\/>GetBasis(i, p) * vec[elem-\/>GetNodes()[i]] * diff;}}
\DoxyCodeLine{1055         \textcolor{comment}{//      temp = elem-\/>GetGradBasis(i, p);}}
\DoxyCodeLine{1056         \textcolor{comment}{//      val.x += temp.x * vec[elem-\/>GetNodes()[i]] * (diff);}}
\DoxyCodeLine{1057         \textcolor{comment}{//      val.y += temp.y * vec[elem-\/>GetNodes()[i]] * (diff);}}
\DoxyCodeLine{1058         \textcolor{comment}{//      val.z += temp.z * vec[elem-\/>GetNodes()[i]] * (diff);}}
\DoxyCodeLine{1059         \textcolor{comment}{//  \}}}
\DoxyCodeLine{1060         \textcolor{comment}{//  return val;}}
\DoxyCodeLine{1061         \textcolor{comment}{//\}}}
\DoxyCodeLine{1062         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1063         \textcolor{keyword}{const} std::vector<double> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a377d3d94bdbae6740f6b739d5e5ef767}{FEMethodZero<Problem, Grid, Matrix>::GetRightVector}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{1064 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1065             \textcolor{keywordflow}{return} *m\_rhsvector;}
\DoxyCodeLine{1066         \}}
\DoxyCodeLine{1067         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1068         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a2f3682858f2e1ceaa302db7277d58732}{FEMethodZero<Problem, Grid, Matrix>::OutDatFormat}}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& mn, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& mx, \textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec)\textcolor{keyword}{ const}}
\DoxyCodeLine{1069 \textcolor{keyword}{        }\{}
\DoxyCodeLine{1070             std::ofstream of(file\_name + \textcolor{stringliteral}{"{}z.dat"{}});}
\DoxyCodeLine{1071             std::streambuf *buf = std::cout.rdbuf();}
\DoxyCodeLine{1072             std::cout.rdbuf(of.rdbuf());}
\DoxyCodeLine{1073             std::cout << \textcolor{stringliteral}{"{}TITLE = FE-\/METHOD\(\backslash\)n"{}};}
\DoxyCodeLine{1074             std::cout << \textcolor{stringliteral}{"{}VARIABLES = \(\backslash\)"{}dx1\(\backslash\)"{}, \(\backslash\)"{}dx2\(\backslash\)"{}, \(\backslash\)"{}u\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1075             std::cout << \textcolor{stringliteral}{"{}ZONE i=51, j=51, F=POINT\(\backslash\)n"{}};}
\DoxyCodeLine{1076             \textcolor{keywordtype}{double} stepx = (mx.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} -\/ mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}}) / 51;}
\DoxyCodeLine{1077             \textcolor{keywordtype}{double} stepy = (mx.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} -\/ mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}}) / 51;}
\DoxyCodeLine{1078             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 51; ++i)}
\DoxyCodeLine{1079                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 51; ++j)}
\DoxyCodeLine{1080                     std::cout << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + stepy * i << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + i * stepy, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}}), vec) << std::endl;}
\DoxyCodeLine{1081             std::cout.rdbuf(buf);}
\DoxyCodeLine{1082             of.close();}
\DoxyCodeLine{1083             of.open(file\_name + \textcolor{stringliteral}{"{}x.dat"{}});}
\DoxyCodeLine{1084             buf = std::cout.rdbuf();}
\DoxyCodeLine{1085             std::cout.rdbuf(of.rdbuf());}
\DoxyCodeLine{1086             std::cout << \textcolor{stringliteral}{"{}TITLE = FE-\/METHOD\(\backslash\)n"{}};}
\DoxyCodeLine{1087             std::cout << \textcolor{stringliteral}{"{}VARIABLES = \(\backslash\)"{}dx1\(\backslash\)"{}, \(\backslash\)"{}dx2\(\backslash\)"{}, \(\backslash\)"{}u\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1088             std::cout << \textcolor{stringliteral}{"{}ZONE i=51, j=51, F=POINT\(\backslash\)n"{}};}
\DoxyCodeLine{1089             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 51; ++i)}
\DoxyCodeLine{1090                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 51; ++j)}
\DoxyCodeLine{1091                     std::cout << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + stepy * i << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}}, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + i * stepy), vec) << std::endl;}
\DoxyCodeLine{1092             std::cout.rdbuf(buf);}
\DoxyCodeLine{1093             of.close();}
\DoxyCodeLine{1094             of.open(file\_name + \textcolor{stringliteral}{"{}y.dat"{}});}
\DoxyCodeLine{1095             buf = std::cout.rdbuf();}
\DoxyCodeLine{1096             std::cout.rdbuf(of.rdbuf());}
\DoxyCodeLine{1097             std::cout << \textcolor{stringliteral}{"{}TITLE = FE-\/METHOD\(\backslash\)n"{}};}
\DoxyCodeLine{1098             std::cout << \textcolor{stringliteral}{"{}VARIABLES = \(\backslash\)"{}dx1\(\backslash\)"{}, \(\backslash\)"{}dx2\(\backslash\)"{}, \(\backslash\)"{}u\(\backslash\)"{}\(\backslash\)n"{}};}
\DoxyCodeLine{1099             std::cout << \textcolor{stringliteral}{"{}ZONE i=51, j=51, F=POINT\(\backslash\)n"{}};}
\DoxyCodeLine{1100             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 51; ++i)}
\DoxyCodeLine{1101                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 51; ++j)}
\DoxyCodeLine{1102                     std::cout << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + stepy * i << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}(mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} + j * stepx, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}}, mn.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} + i * stepy), vec) << std::endl;}
\DoxyCodeLine{1103             std::cout.rdbuf(buf);}
\DoxyCodeLine{1104             of.close();}
\DoxyCodeLine{1105         \}}
\DoxyCodeLine{1106         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1107         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero}{FEMethodZero<Problem, Grid, Matrix>::ApplySources}}()}
\DoxyCodeLine{1108         \{}
\DoxyCodeLine{1109             \textcolor{keywordtype}{int} nfem = -\/1;}
\DoxyCodeLine{1110             \textcolor{keyword}{auto} total = m\_problem-\/>get\_total\_sources();}
\DoxyCodeLine{1111             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < total; ++i)}
\DoxyCodeLine{1112             \{}
\DoxyCodeLine{1113                 \textcolor{keyword}{auto} src = m\_problem-\/>get\_point\_source(i);}
\DoxyCodeLine{1114                 \textcolor{keyword}{auto} point = src.get\_point();}
\DoxyCodeLine{1115                 nfem = m\_Grid-\/>FindElement(point);}
\DoxyCodeLine{1116                 \textcolor{keywordflow}{if} (nfem != -\/1)}
\DoxyCodeLine{1117                 \{}
\DoxyCodeLine{1118                     \textcolor{keyword}{auto} val = src.get\_value();}
\DoxyCodeLine{1119                     \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElement(nfem);}
\DoxyCodeLine{1120                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j)}
\DoxyCodeLine{1121                         m\_rhsvector-\/>operator[](elem-\/>GetNode(j)) += val * elem-\/>GetShapeFunction(j, point);}
\DoxyCodeLine{1122                 \}}
\DoxyCodeLine{1123                 nfem = -\/1;}
\DoxyCodeLine{1124             \}}
\DoxyCodeLine{1125             \textcolor{comment}{/*for (auto srd : m\_Grid-\/>GetDottedSources())}}
\DoxyCodeLine{1126 \textcolor{comment}{            \{}}
\DoxyCodeLine{1127 \textcolor{comment}{                nfem = m\_Grid-\/>FindElement(srd.first);}}
\DoxyCodeLine{1128 \textcolor{comment}{                if (nfem != -\/1)}}
\DoxyCodeLine{1129 \textcolor{comment}{                \{}}
\DoxyCodeLine{1130 \textcolor{comment}{                    auto elem = m\_Grid-\/>GetElements()[nfem];}}
\DoxyCodeLine{1131 \textcolor{comment}{                    for (int i = 0; i < elem-\/>GetDoF(); ++i)}}
\DoxyCodeLine{1132 \textcolor{comment}{                    \{}}
\DoxyCodeLine{1133 \textcolor{comment}{                        m\_rhsvector[elem-\/>GetNodes()[i]] += srd.second * elem-\/>GetBasis(i, srd.first);}}
\DoxyCodeLine{1134 \textcolor{comment}{                    \}}}
\DoxyCodeLine{1135 \textcolor{comment}{                \}}}
\DoxyCodeLine{1136 \textcolor{comment}{                nfem = -\/1;}}
\DoxyCodeLine{1137 \textcolor{comment}{            \}*/}}
\DoxyCodeLine{1138         \}}
\DoxyCodeLine{1139         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1140         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeb0d62b554a42ac372453dee08547173}{FEMethodZero<Problem, Grid, Matrix>::Rediscretization}}(\textcolor{keyword}{const} std::shared\_ptr<Grid>\& grid)}
\DoxyCodeLine{1141         \{}
\DoxyCodeLine{1142             m\_GlobalMatrix-\/>NullMatrix();}
\DoxyCodeLine{1143             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < m\_rhsvector-\/>size(); ++i)}
\DoxyCodeLine{1144                 (*m\_rhsvector)[i] = 0;}
\DoxyCodeLine{1145             AssemblGlobal();}
\DoxyCodeLine{1146             \textcolor{comment}{//SecondConditions();}}
\DoxyCodeLine{1147             \textcolor{comment}{//ApplySources();}}
\DoxyCodeLine{1148             \textcolor{comment}{//StefanConditions();}}
\DoxyCodeLine{1149             MainConditions();}
\DoxyCodeLine{1150         \}}
\DoxyCodeLine{1151         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1152         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeb0d62b554a42ac372453dee08547173}{FEMethodZero<Problem, Grid, Matrix>::Rediscretization}}()}
\DoxyCodeLine{1153         \{}
\DoxyCodeLine{1154             m\_time += m\_step;}
\DoxyCodeLine{1155             m\_GlobalMatrix-\/>NullMatrix();}
\DoxyCodeLine{1156             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < m\_rhsvector-\/>size(); ++i)}
\DoxyCodeLine{1157                 (*m\_rhsvector)[i] = 0;}
\DoxyCodeLine{1158             AssemblGlobal();}
\DoxyCodeLine{1159             SecondConditions();}
\DoxyCodeLine{1160             ThirdConditions();}
\DoxyCodeLine{1161             StefanConditions();}
\DoxyCodeLine{1162             \textcolor{comment}{//ApplySources();}}
\DoxyCodeLine{1163             MainConditions();}
\DoxyCodeLine{1164         \}}
\DoxyCodeLine{1165         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1166         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a80d494891a70eb68f111897ba4b64eec}{FEMethodZero<Problem, Grid, Matrix>::GetSolution}}(std::vector<double>\& vec)}
\DoxyCodeLine{1167         \{}
\DoxyCodeLine{1168             \textcolor{keywordtype}{int} size = vec.size();}
\DoxyCodeLine{1169             \textcolor{comment}{//Translation(vec);}}
\DoxyCodeLine{1170             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i)}
\DoxyCodeLine{1171                 vec[i] = m\_solution[i];}
\DoxyCodeLine{1172         \}}
\DoxyCodeLine{1173         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1174         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a80d494891a70eb68f111897ba4b64eec}{FEMethodZero<Problem, Grid, Matrix>::GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)}
\DoxyCodeLine{1175         \{}
\DoxyCodeLine{1176             \textcolor{keywordtype}{double} sum\{ 0 \};}
\DoxyCodeLine{1177             \textcolor{keyword}{auto} nfem\{ g.FindElement(p) \};}
\DoxyCodeLine{1178             \textcolor{keywordflow}{if} (nfem < 0)}
\DoxyCodeLine{1179                 \textcolor{keywordflow}{return} 0.;}
\DoxyCodeLine{1180             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{1181             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{1182             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{1183                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{1184             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{1185         \}}
\DoxyCodeLine{1186         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1187         \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a80d494891a70eb68f111897ba4b64eec}{FEMethodZero<Problem, Grid, Matrix>::GetSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nfem)}
\DoxyCodeLine{1188         \{}
\DoxyCodeLine{1189             \textcolor{keywordtype}{double} sum\{ 0 \};}
\DoxyCodeLine{1190             \textcolor{comment}{//if (nfem < 0)}}
\DoxyCodeLine{1191             \textcolor{comment}{//    return 0.;}}
\DoxyCodeLine{1192             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{1193             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{1194             \textcolor{comment}{//std::cout << nfem << std::endl;}}
\DoxyCodeLine{1195             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{1196                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetShapeFunction(i, p);}
\DoxyCodeLine{1197             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{1198         \}}
\DoxyCodeLine{1199         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1200         \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a8a27552ec18dc9af1b92eb612698ec84}{FEMethodZero<Problem, Grid, Matrix>::GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p)}
\DoxyCodeLine{1201         \{}
\DoxyCodeLine{1202             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} sum\{ 0, 0, 0 \};}
\DoxyCodeLine{1203             \textcolor{keyword}{auto} nfem\{ g.FindElement(p) \};}
\DoxyCodeLine{1204             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{1205             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{1206             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{1207                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetGradShapeFunction(i, p);}
\DoxyCodeLine{1208             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{1209         \}}
\DoxyCodeLine{1210         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1211         \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a8a27552ec18dc9af1b92eb612698ec84}{FEMethodZero<Problem, Grid, Matrix>::GetGradSolution}}(\textcolor{keyword}{const} Grid\& g, \textcolor{keyword}{const} std::vector<double> \&weights, \textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\& p, \textcolor{keyword}{const} \textcolor{keywordtype}{int} nfem)}
\DoxyCodeLine{1212         \{}
\DoxyCodeLine{1213             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} sum\{ 0, 0, 0 \};}
\DoxyCodeLine{1214             \textcolor{keyword}{auto} elem\{ g.GetElement(nfem) \};}
\DoxyCodeLine{1215             \textcolor{keyword}{auto} dofs\{ elem-\/>GetDoFs() \};}
\DoxyCodeLine{1216             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i\{ 0 \}; i < dofs; ++i)}
\DoxyCodeLine{1217                 sum += weights[elem-\/>GetNode(i)] * elem-\/>GetGradShapeFunction(i, p);}
\DoxyCodeLine{1218             \textcolor{keywordflow}{return} sum;}
\DoxyCodeLine{1219         \}}
\DoxyCodeLine{1220         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1221         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a43afd3230ff310cba4d4992d530b3976}{FEMethodZero<Problem, Grid, Matrix>::LoadSolution}}(\textcolor{keyword}{const} std::vector<double>\& vec)}
\DoxyCodeLine{1222         \{}
\DoxyCodeLine{1223             m\_solution.resize(vec.size());}
\DoxyCodeLine{1224             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i < vec.size(); ++i)}
\DoxyCodeLine{1225                 m\_solution[i] = vec[i];}
\DoxyCodeLine{1226         \}}
\DoxyCodeLine{1227         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1228         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_a7abb3b918bae993c533d1b48e2519ee0}{FEMethodZero<Problem, Grid, Matrix>::OutMeshFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec)}
\DoxyCodeLine{1229         \{}
\DoxyCodeLine{1230             \textcolor{keyword}{const} \textcolor{keywordtype}{int} size\{ (int)m\_Grid-\/>GetNodes().size() \};}
\DoxyCodeLine{1231             \textcolor{keyword}{const} \textcolor{keywordtype}{int} number\{ (int)m\_Grid-\/>GetElements().size() \};}
\DoxyCodeLine{1232             \textcolor{comment}{//const int size\{ number * 4 \};}}
\DoxyCodeLine{1233             std::ofstream ofs(file\_name + \textcolor{stringliteral}{"{}.dat"{}}, std::ios::out);}
\DoxyCodeLine{1234             std::string title(\textcolor{stringliteral}{"{}TITLE = \(\backslash\)"{}Mesh data\(\backslash\)"{}\(\backslash\)n Variables = \(\backslash\)"{}X\(\backslash\)"{}, \(\backslash\)"{}Y\(\backslash\)"{}, \(\backslash\)"{}Z\(\backslash\)"{}, \(\backslash\)"{}U\(\backslash\)"{}\(\backslash\)n Zone N = "{}} + std::to\_string(size) + \textcolor{stringliteral}{"{}, E = "{}} + std::to\_string(number) + \textcolor{stringliteral}{"{}, DATAPACKING = POINT, ZONETYPE = FETETRAHEDRON\(\backslash\)n"{}});}
\DoxyCodeLine{1235             ofs << title;}
\DoxyCodeLine{1236             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} p;}
\DoxyCodeLine{1237             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i)}
\DoxyCodeLine{1238             \{}
\DoxyCodeLine{1239                 p = m\_Grid-\/>GetNodes()[i];}
\DoxyCodeLine{1240                 ofs << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(p, vec, 1) << std::endl;}
\DoxyCodeLine{1241             \}}
\DoxyCodeLine{1242             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < number; ++i)}
\DoxyCodeLine{1243             \{}
\DoxyCodeLine{1244                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1245                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 4; ++k)}
\DoxyCodeLine{1246                 \{}
\DoxyCodeLine{1247                     ofs << elem-\/>GetNodes()[k] + 1 << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{1248                 \}}
\DoxyCodeLine{1249                 ofs << std::endl;}
\DoxyCodeLine{1250             \}}
\DoxyCodeLine{1251             ofs.close();}
\DoxyCodeLine{1252         \}}
\DoxyCodeLine{1253         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1254         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aaafa84c4105971722fc55d94b01f70f5}{FEMethodZero<Problem, Grid, Matrix>::OutMeshTimeFormat}}(\textcolor{keyword}{const} std::string\& file\_name, \textcolor{keyword}{const} std::vector<double>\& vec)}
\DoxyCodeLine{1255         \{}
\DoxyCodeLine{1256             \textcolor{keyword}{const} \textcolor{keywordtype}{int} size\{ (int)m\_Grid-\/>GetNodes().size() \};}
\DoxyCodeLine{1257             \textcolor{keyword}{const} \textcolor{keywordtype}{int} number\{ (int)m\_Grid-\/>GetElements().size() \};}
\DoxyCodeLine{1258             \textcolor{comment}{//const int size\{ number * 4 \};}}
\DoxyCodeLine{1259             std::ofstream ofs(file\_name + \textcolor{stringliteral}{"{}.dat"{}}, std::ios::out | std::ios::app);}
\DoxyCodeLine{1260             std::string title(\textcolor{stringliteral}{"{}TITLE = \(\backslash\)"{}Mesh data\(\backslash\)"{}\(\backslash\)n Variables = \(\backslash\)"{}X\(\backslash\)"{}, \(\backslash\)"{}Y\(\backslash\)"{}, \(\backslash\)"{}Z\(\backslash\)"{}, \(\backslash\)"{}U\(\backslash\)"{}\(\backslash\)n Zone N = "{}} + std::to\_string(size) + \textcolor{stringliteral}{"{}, E = "{}} + std::to\_string(number) + \textcolor{stringliteral}{"{}, DATAPACKING = POINT, ZONETYPE = FETETRAHEDRON\(\backslash\)n"{}});}
\DoxyCodeLine{1261             ofs << title;}
\DoxyCodeLine{1262             \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}} p;}
\DoxyCodeLine{1263             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; ++i)}
\DoxyCodeLine{1264             \{}
\DoxyCodeLine{1265                 p = m\_Grid-\/>GetNodes()[i];}
\DoxyCodeLine{1266                 ofs << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_a4a1b6340ba2c09f18d67e6c3324a960c}{x}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ad284cc2cdcd57432d6667bacb0cc5ccd}{y}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << p.\mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point_ab3ce06a03b41ac6c0cd96217a4f64ba0}{z}} << \textcolor{stringliteral}{"{}\(\backslash\)t"{}} << GetValue(p, vec, 1) << std::endl;}
\DoxyCodeLine{1267             \}}
\DoxyCodeLine{1268             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < number; ++i)}
\DoxyCodeLine{1269             \{}
\DoxyCodeLine{1270                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1271                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 4; ++k)}
\DoxyCodeLine{1272                 \{}
\DoxyCodeLine{1273                     ofs << elem-\/>GetNodes()[k] + 1 << \textcolor{stringliteral}{"{}\(\backslash\)t"{}};}
\DoxyCodeLine{1274                 \}}
\DoxyCodeLine{1275                 ofs << std::endl;}
\DoxyCodeLine{1276             \}}
\DoxyCodeLine{1277             ofs.close();}
\DoxyCodeLine{1278         \}}
\DoxyCodeLine{1279         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1280         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeaddd875e327ab03b8cf0e9e6351a918}{FEMethodZero<Problem, Grid, Matrix>::ProjectSolution}}(std::vector<double>\& sol, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&, \textcolor{keyword}{const} \textcolor{keywordtype}{int})> GetVal, std::vector<double>\& vec)}
\DoxyCodeLine{1281         \{}
\DoxyCodeLine{1282             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}
\DoxyCodeLine{1283             \{}
\DoxyCodeLine{1284                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1285                 \textcolor{keywordtype}{int} order = elem-\/>GetDoF();}
\DoxyCodeLine{1286                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1287                     sol[elem-\/>GetNodes(j)] = GetVal(m\_Grid-\/>GetNodes()[elem-\/>GetNodes(j)], vec, i);}
\DoxyCodeLine{1288             \}}
\DoxyCodeLine{1289         \}}
\DoxyCodeLine{1290         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1291         \textcolor{keywordtype}{void} \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeaddd875e327ab03b8cf0e9e6351a918}{FEMethodZero<Problem, Grid, Matrix>::ProjectSolution}}(std::vector<double>\& sol, std::function<\textcolor{keyword}{const} \textcolor{keywordtype}{double}(\textcolor{keyword}{const} \mbox{\hyperlink{classcorenc_1_1Mesh_1_1Point}{Mesh::Point}}\&, \textcolor{keyword}{const} std::vector<double>\&)> GetVal, std::vector<double>\& vec, \textcolor{keyword}{const} \textcolor{keywordtype}{int})}
\DoxyCodeLine{1292         \{}
\DoxyCodeLine{1293             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}
\DoxyCodeLine{1294             \{}
\DoxyCodeLine{1295                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1296                 \textcolor{keywordtype}{int} order = elem-\/>GetDoF();}
\DoxyCodeLine{1297                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1298                     sol[elem-\/>GetNodes(j)] = GetVal(m\_Grid-\/>GetNodes()[elem-\/>GetNodes(j)], vec);}
\DoxyCodeLine{1299             \}}
\DoxyCodeLine{1300         \}}
\DoxyCodeLine{1301         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1302         \textcolor{keyword}{const} std::vector<double> \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_aeec36e8b838d791c61675f43926937e1}{FEMethodZero<Problem, Grid, Matrix>::SetSolution}}(\textcolor{keyword}{const} \textcolor{keywordtype}{int} sol, \textcolor{keyword}{const} \textcolor{keywordtype}{int} liq, \textcolor{keyword}{const} \textcolor{keywordtype}{double} s, \textcolor{keyword}{const} \textcolor{keywordtype}{double} l, \textcolor{keyword}{const} \textcolor{keywordtype}{double} m)}
\DoxyCodeLine{1303         \{}
\DoxyCodeLine{1304             \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1305             m\_solution.resize(m\_Grid-\/>GetNodes().size());}
\DoxyCodeLine{1306             \textcolor{keywordflow}{for} (i = 0; i < m\_Grid-\/>GetElements().size(); ++i)}
\DoxyCodeLine{1307             \{}
\DoxyCodeLine{1308                 \textcolor{keyword}{auto} elem = m\_Grid-\/>GetElements()[i];}
\DoxyCodeLine{1309                 \textcolor{keywordtype}{int} order = elem-\/>GetDoF();}
\DoxyCodeLine{1310                 \textcolor{keywordflow}{if} (m\_Grid-\/>GetElements()[i]-\/>GetType() == liq)}
\DoxyCodeLine{1311                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1312                         m\_solution[elem-\/>GetNodes()[j]] = l;}
\DoxyCodeLine{1313                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{1314                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < order; ++j)}
\DoxyCodeLine{1315                         m\_solution[elem-\/>GetNodes()[j]] = s;}
\DoxyCodeLine{1316             \}}
\DoxyCodeLine{1317 }
\DoxyCodeLine{1318             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} bnd : m\_Grid-\/>GetBoundaryConditions())}
\DoxyCodeLine{1319             \{}
\DoxyCodeLine{1320                 \textcolor{comment}{//if (get<0>(bnd.second) == 4)}}
\DoxyCodeLine{1321                 \{}
\DoxyCodeLine{1322                     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} row : m\_Grid-\/>GetBoundary())}
\DoxyCodeLine{1323                     \{}
\DoxyCodeLine{1324                         \textcolor{keywordflow}{if} (bnd.first == row-\/>GetType())}
\DoxyCodeLine{1325                         \{}
\DoxyCodeLine{1326                             \textcolor{keywordtype}{int} dofs = row-\/>GetDoF();}
\DoxyCodeLine{1327                             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < dofs; ++i)}
\DoxyCodeLine{1328                             \{}
\DoxyCodeLine{1329                                 m\_solution[row-\/>GetNodes(i)] = m;}
\DoxyCodeLine{1330                             \}}
\DoxyCodeLine{1331                         \}}
\DoxyCodeLine{1332                     \}}
\DoxyCodeLine{1333                 \}}
\DoxyCodeLine{1334             \}}
\DoxyCodeLine{1335             \textcolor{keywordflow}{return} m\_solution;}
\DoxyCodeLine{1336         \}}
\DoxyCodeLine{1337         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Gr\textcolor{keywordtype}{id}, \textcolor{keyword}{class} Matrix>}
\DoxyCodeLine{1338         \mbox{\hyperlink{classcorenc_1_1method_1_1FEMethodZero_adcfa379268d60597506e141a71946cdc}{FEMethodZero<Problem, Grid, Matrix>::\string~FEMethodZero}}()}
\DoxyCodeLine{1339         \{}
\DoxyCodeLine{1340             \textcolor{keyword}{delete} m\_Grid;}
\DoxyCodeLine{1341         \}}
\DoxyCodeLine{1342     \}}
\DoxyCodeLine{1343 \}}
\DoxyCodeLine{1344 }
\DoxyCodeLine{1345 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !CORENC\_METHODS\_FEMethodZeroZero\_h}}
\DoxyCodeLine{1346 }

\end{DoxyCode}
