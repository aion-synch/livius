\hypertarget{eigen__solver_8h_source}{}\doxysection{eigen\+\_\+solver.\+h}
\label{eigen__solver_8h_source}\index{Solvers/eigen\_solver.h@{Solvers/eigen\_solver.h}}
\mbox{\hyperlink{eigen__solver_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef EIGEN\_SOLVER\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define EIGEN\_SOLVER\_H}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <complex>}}
\DoxyCodeLine{5 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecorenc}{corenc}}}
\DoxyCodeLine{6 \{}
\DoxyCodeLine{7     \textcolor{keyword}{namespace }solvers}
\DoxyCodeLine{8     \{}
\DoxyCodeLine{9         \textcolor{keyword}{template}<\textcolor{keyword}{class} Matrix, \textcolor{keyword}{class} Solver>}
\DoxyCodeLine{10         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1solvers_1_1eigen__solver}{eigen\_solver}}}
\DoxyCodeLine{11         \{}
\DoxyCodeLine{12         \textcolor{keyword}{public}:}
\DoxyCodeLine{13             \mbox{\hyperlink{classcorenc_1_1solvers_1_1eigen__solver_a38bf08ddd2a792f5a5a555cc8e0ffdb9}{eigen\_solver}}()\{\}}
\DoxyCodeLine{14             \mbox{\hyperlink{classcorenc_1_1solvers_1_1eigen__solver_a4dc0182d1a50a5abc4d8f08f33e1d560}{\string~eigen\_solver}}()\{\}}
\DoxyCodeLine{15             \textcolor{keywordtype}{void}        \mbox{\hyperlink{classcorenc_1_1solvers_1_1eigen__solver_acb7fb0193bd0001c4260231c6efdebea}{rayleigh}}(Matrix* A, Matrix* B, Solver* esl, std::complex<double>* mu0, \textcolor{keywordtype}{double}* x0, \textcolor{keyword}{const} \textcolor{keywordtype}{int} n)\textcolor{keyword}{ const}}
\DoxyCodeLine{16 \textcolor{keyword}{            }\{}
\DoxyCodeLine{17                 std::vector<std::complex<double>> x(n);}
\DoxyCodeLine{18                 std::vector<std::complex<double>> y(n);}
\DoxyCodeLine{19                 std::vector<std::complex<double>> lam(n);}
\DoxyCodeLine{20                 \textcolor{keywordtype}{double} norm\_mu = 0;}
\DoxyCodeLine{21                 \textcolor{keywordtype}{double} norm\_x = 0;}
\DoxyCodeLine{22                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{23                 \{}
\DoxyCodeLine{24                     norm\_mu += std::norm(mu0[i]) * std::norm(mu0[i]);}
\DoxyCodeLine{25                     norm\_x += std::norm(x0[i]) * std::norm(x0[i]);}
\DoxyCodeLine{26                 \}}
\DoxyCodeLine{27                 norm\_mu = sqrt(norm\_mu);}
\DoxyCodeLine{28                 norm\_x = sqrt(norm\_x);}
\DoxyCodeLine{29                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; ++i)}
\DoxyCodeLine{30                 \{}
\DoxyCodeLine{31                     x[i] = x0[i] / norm\_x;}
\DoxyCodeLine{32                     y[i] = mu0[i] / norm\_mu;}
\DoxyCodeLine{33                 \}}
\DoxyCodeLine{34                 std::complex<double> temp(0, 0);}
\DoxyCodeLine{35                 temp =}
\DoxyCodeLine{36             \}}
\DoxyCodeLine{37         \};}
\DoxyCodeLine{38     \}}
\DoxyCodeLine{39 \}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// EIGEN\_SOLVER\_H}}

\end{DoxyCode}
