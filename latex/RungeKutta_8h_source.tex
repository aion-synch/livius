\hypertarget{RungeKutta_8h_source}{}\doxysection{Runge\+Kutta.\+h}
\label{RungeKutta_8h_source}\index{CoreNCFEM/Methods/RungeKutta.h@{CoreNCFEM/Methods/RungeKutta.h}}
\mbox{\hyperlink{RungeKutta_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef CORENC\_METHODS\_RUNGEKUTTA}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define CORENC\_METHODS\_RUNGEKUTTA}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}../Point.h"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{7 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacecorenc}{corenc}}}
\DoxyCodeLine{8 \{}
\DoxyCodeLine{9     \textcolor{keyword}{namespace }method}
\DoxyCodeLine{10     \{}
\DoxyCodeLine{11         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Type>}
\DoxyCodeLine{12         \textcolor{keyword}{class }\mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta}{RungeKutta}}}
\DoxyCodeLine{13         \{}
\DoxyCodeLine{14         \textcolor{keyword}{public}:}
\DoxyCodeLine{15             \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_a2022c5c0a944fbaea880a3a970288614}{RungeKutta}}() \{\};}
\DoxyCodeLine{16             \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_aef4593ae1bd98ec51972b080c779a62a}{RungeKutta}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} step, \textcolor{keyword}{const} \textcolor{keywordtype}{double} \textcolor{keyword}{final}, Problem* problem, \textcolor{keyword}{const} Type* solution) :}
\DoxyCodeLine{17                 m\_step\{ step \}, }
\DoxyCodeLine{18                 m\_final\{ final \},}
\DoxyCodeLine{19                 m\_problem\{problem\} \{\}}
\DoxyCodeLine{20             \textcolor{keyword}{const} Type              \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_a480accf374b76db67e1f1f5483da01d4}{discretize}}(\textcolor{keyword}{const} Type\& solution, \textcolor{keyword}{const} std::function<\textcolor{keyword}{const} Type(\textcolor{keyword}{const} \textcolor{keywordtype}{double} time, \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_step, \textcolor{keyword}{const} Type\& curr\_sol, Type* result)>\& func);}
\DoxyCodeLine{21             \textcolor{keyword}{const} Type              \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_ad89b61048b3820da5485712477a4106c}{explicitEuler}}(\textcolor{keyword}{const} Type\& solution, \textcolor{keyword}{const} std::function<\textcolor{keyword}{const} Type(\textcolor{keyword}{const} \textcolor{keywordtype}{double} time, \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_step, \textcolor{keyword}{const} Type\& curr\_sol, Type* result)>\& func);}
\DoxyCodeLine{22             \textcolor{keywordtype}{void}                    \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_a056fbd48cc2bc699631af6ac4348fe4e}{updateTimestep}}(\textcolor{keyword}{const} \textcolor{keywordtype}{double} step) \{ m\_step = step; \};}
\DoxyCodeLine{23             \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_adc6c6695f8b401f9883d9c2c769c13a5}{\string~RungeKutta}}() \{\};}
\DoxyCodeLine{24         \textcolor{keyword}{private}:}
\DoxyCodeLine{25             \textcolor{keywordtype}{double}                  m\_step;}
\DoxyCodeLine{26             \textcolor{keywordtype}{double}                  m\_final;}
\DoxyCodeLine{27             \textcolor{keywordtype}{double}                  m\_curr;}
\DoxyCodeLine{28             Problem*                m\_problem;}
\DoxyCodeLine{29             Type*                   m\_solution;}
\DoxyCodeLine{30             \textcolor{keyword}{static} \textcolor{keyword}{const} std::vector<double> vector\_mult(\textcolor{keyword}{const} std::vector<double>\& lhs, \textcolor{keyword}{const} \textcolor{keywordtype}{double} rhs)}
\DoxyCodeLine{31             \{}
\DoxyCodeLine{32                 std::vector<double> vc(lhs);}
\DoxyCodeLine{33                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : vc)}
\DoxyCodeLine{34                     it *= rhs;}
\DoxyCodeLine{35                 \textcolor{keywordflow}{return} vc;}
\DoxyCodeLine{36             \}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38             \textcolor{keyword}{static} \textcolor{keyword}{const} std::vector<double> vector\_mult(\textcolor{keyword}{const} \textcolor{keywordtype}{double} rhs, \textcolor{keyword}{const} std::vector<double>\& lhs)}
\DoxyCodeLine{39             \{}
\DoxyCodeLine{40                 std::vector<double> vc(lhs);}
\DoxyCodeLine{41                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : vc)}
\DoxyCodeLine{42                     it *= rhs;}
\DoxyCodeLine{43                 \textcolor{keywordflow}{return} vc;}
\DoxyCodeLine{44             \}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46             \textcolor{keyword}{static} \textcolor{keyword}{const} std::vector<double> vector\_divide(\textcolor{keyword}{const} std::vector<double>\& lhs, \textcolor{keyword}{const} \textcolor{keywordtype}{double} rhs)}
\DoxyCodeLine{47             \{}
\DoxyCodeLine{48                 std::vector<double> vc(lhs);}
\DoxyCodeLine{49                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : vc)}
\DoxyCodeLine{50                     it /= rhs;}
\DoxyCodeLine{51                 \textcolor{keywordflow}{return} vc;}
\DoxyCodeLine{52             \}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54             \textcolor{keyword}{static} \textcolor{keyword}{const} std::vector<double> vector\_divide(\textcolor{keyword}{const} \textcolor{keywordtype}{double} rhs, \textcolor{keyword}{const} std::vector<double>\& lhs)}
\DoxyCodeLine{55             \{}
\DoxyCodeLine{56                 std::vector<double> vc(lhs);}
\DoxyCodeLine{57                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&it : vc)}
\DoxyCodeLine{58                     it /= rhs;}
\DoxyCodeLine{59                 \textcolor{keywordflow}{return} vc;}
\DoxyCodeLine{60             \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62             \textcolor{keyword}{static} \textcolor{keyword}{const} std::vector<double> vector\_add(\textcolor{keyword}{const} std::vector<double>\& rhs, \textcolor{keyword}{const} std::vector<double>\& lhs)}
\DoxyCodeLine{63             \{}
\DoxyCodeLine{64                 std::vector<double> vc(lhs);}
\DoxyCodeLine{65                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i\{ 0 \}; i < vc.size(); ++i)}
\DoxyCodeLine{66                     vc[i] += rhs[i];}
\DoxyCodeLine{67                 \textcolor{keywordflow}{return} vc;}
\DoxyCodeLine{68             \}}
\DoxyCodeLine{69         \};}
\DoxyCodeLine{70 }
\DoxyCodeLine{71         }
\DoxyCodeLine{72 }
\DoxyCodeLine{73         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Type>}
\DoxyCodeLine{74         \textcolor{keyword}{const} Type \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_a480accf374b76db67e1f1f5483da01d4}{RungeKutta<Problem, Type>::discretize}}(\textcolor{keyword}{const} Type\& u\_pr, \textcolor{keyword}{const} std::function<\textcolor{keyword}{const} Type(\textcolor{keyword}{const} \textcolor{keywordtype}{double} time, \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_step, \textcolor{keyword}{const} Type\& curr\_sol, Type* result)>\& func)}
\DoxyCodeLine{75         \{}
\DoxyCodeLine{76             Type k[4];}
\DoxyCodeLine{77             \textcolor{keyword}{const} \textcolor{keywordtype}{int} n\{ int(m\_final / m\_step) \};}
\DoxyCodeLine{78             func(m\_curr, m\_step, u\_pr, \&k[0]);}
\DoxyCodeLine{79             \textcolor{comment}{//std::vector<double> tempc(m\_curr.size());}}
\DoxyCodeLine{80             std::vector<double> tempu(u\_pr.size());}
\DoxyCodeLine{81             std::vector<double> tempk(u\_pr.size());}
\DoxyCodeLine{82             tempk = vector\_divide(k[0], 2);}
\DoxyCodeLine{83             tempu = vector\_add(u\_pr, tempk);}
\DoxyCodeLine{84             func(m\_curr + m\_step / 2, m\_step, tempu, \&k[1]);}
\DoxyCodeLine{85             \textcolor{comment}{//func(m\_curr + m\_step / 2, m\_step, u\_pr + k[0] / 2, \&k[1]);}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87             tempk = vector\_divide(k[1], 2);}
\DoxyCodeLine{88             tempu = vector\_add(u\_pr, tempk);}
\DoxyCodeLine{89             func(m\_curr + m\_step / 2, m\_step, tempu, \&k[2]);}
\DoxyCodeLine{90             \textcolor{comment}{//func(m\_curr + m\_step / 2, m\_step, u\_pr + k[1] / 2, \&k[2]);}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92             tempu = vector\_add(u\_pr, k[2]);}
\DoxyCodeLine{93             func(m\_curr + m\_step, m\_step, tempu, \&k[3]);}
\DoxyCodeLine{94             \textcolor{comment}{//func(m\_curr + m\_step, m\_step, u\_pr + k[2], \&k[3]);}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96             tempk = vector\_mult(k[1], 2);}
\DoxyCodeLine{97             tempu = vector\_mult(k[2], 2);}
\DoxyCodeLine{98             k[3] = vector\_add(k[3], tempu);}
\DoxyCodeLine{99             k[3] = vector\_add(k[3], tempk);}
\DoxyCodeLine{100             k[3] = vector\_add(k[3], k[0]);}
\DoxyCodeLine{101             k[3] = vector\_divide(k[3], 6.);}
\DoxyCodeLine{102             \textcolor{comment}{//k[3] = k[0] + 2 * k[1] + 2 * k[2] + k[3];}}
\DoxyCodeLine{103             \textcolor{comment}{//k[3] = 1. / 6 * k[3];}}
\DoxyCodeLine{104             m\_problem-\/>addTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da601d1ecfe8543b457d918d636d84cc9d}{Terms::EUV}});}
\DoxyCodeLine{105             m\_problem-\/>addTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da511236cf0a2ae58312752c309767be64}{Terms::IUV}});}
\DoxyCodeLine{106             m\_curr += m\_step;}
\DoxyCodeLine{107             \textcolor{keywordflow}{return} k[3];}
\DoxyCodeLine{108         \}}
\DoxyCodeLine{109         }
\DoxyCodeLine{110         \textcolor{keyword}{template}<\textcolor{keyword}{class} Problem, \textcolor{keyword}{class} Type>}
\DoxyCodeLine{111         \textcolor{keyword}{const} Type \mbox{\hyperlink{classcorenc_1_1method_1_1RungeKutta_ad89b61048b3820da5485712477a4106c}{RungeKutta<Problem, Type>::explicitEuler}}(\textcolor{keyword}{const} Type\& u\_pr, \textcolor{keyword}{const} std::function<\textcolor{keyword}{const} Type(\textcolor{keyword}{const} \textcolor{keywordtype}{double} time, \textcolor{keyword}{const} \textcolor{keywordtype}{double} time\_step, \textcolor{keyword}{const} Type\& curr\_sol, Type* result)>\& func)}
\DoxyCodeLine{112         \{}
\DoxyCodeLine{113             Type k;}
\DoxyCodeLine{114             func(m\_curr, m\_step, u\_pr, \&k);}
\DoxyCodeLine{115             m\_problem-\/>addTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da601d1ecfe8543b457d918d636d84cc9d}{Terms::EUV}});}
\DoxyCodeLine{116             m\_problem-\/>addTerm(\mbox{\hyperlink{namespacecorenc_a3e54d1f38e1565c871e70b7f4b061a7da511236cf0a2ae58312752c309767be64}{Terms::IUV}});}
\DoxyCodeLine{117             m\_curr += m\_step;}
\DoxyCodeLine{118             \textcolor{keywordflow}{return} k;}
\DoxyCodeLine{119         \}}
\DoxyCodeLine{120     \}}
\DoxyCodeLine{121 \}}
\DoxyCodeLine{122 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !CORENC\_METHODS\_RUNGEKUTTA}}

\end{DoxyCode}
